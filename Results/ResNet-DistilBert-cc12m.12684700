| distributed init (rank 4): env://
| distributed init (rank 6): env://
| distributed init (rank 2): env://
| distributed init (rank 0): env://
| distributed init (rank 7): env://
| distributed init (rank 5): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
here we create the text tokenizer
here we have created the text tokenizer
here we create traindataset
here we have created traindataset
len of coco val/test: 5000 5000
len of flickr val/test: 1014 1000
here we create trainloader
we have created the trainloader for webdataset style data
number of train samples are 9191424
Creating model
distilbert-base-uncased
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Received Image
add: criterion.image_temp_gen.scaler torch.Size([]) to tempnet optimizer
add: criterion.image_temp_gen.prototypes torch.Size([512, 256]) to tempnet optimizer
add: criterion.image_temp_gen.proj.weight torch.Size([256, 256]) to tempnet optimizer
add: criterion.image_temp_gen.proj.bias torch.Size([256]) to tempnet optimizer
add: criterion.image_temp_gen.linear_1.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.image_temp_gen.linear_1.bias torch.Size([1]) to tempnet optimizer
add: criterion.image_temp_gen.linear_2.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.text_temp_gen.scaler torch.Size([]) to tempnet optimizer
add: criterion.text_temp_gen.prototypes torch.Size([512, 256]) to tempnet optimizer
add: criterion.text_temp_gen.proj.weight torch.Size([256, 256]) to tempnet optimizer
add: criterion.text_temp_gen.proj.bias torch.Size([256]) to tempnet optimizer
add: criterion.text_temp_gen.linear_1.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.text_temp_gen.linear_1.bias torch.Size([1]) to tempnet optimizer
add: criterion.text_temp_gen.linear_2.weight torch.Size([1, 512]) to tempnet optimizer
Start training
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [0]  [   0/2244]  eta: 22:49:56  lr: 0.000010  loss_ita: 0.0660  lr_temp_net: 0.00003000  loss_temp: 0.7534  avg_image_tau: 0.0421  avg_text_tau: 0.0407  time: 36.6296  data: 5.3870  max mem: 33750
Train Epoch: [0]  [  50/2244]  eta: 1:41:05  lr: 0.000010  loss_ita: -0.0039  lr_temp_net: 0.00003000  loss_temp: 0.6452  avg_image_tau: 0.0411  avg_text_tau: 0.0398  time: 1.9845  data: 0.0311  max mem: 34806
Train Epoch: [0]  [ 100/2244]  eta: 1:23:55  lr: 0.000010  loss_ita: -0.0015  lr_temp_net: 0.00003000  loss_temp: 0.5681  avg_image_tau: 0.0404  avg_text_tau: 0.0391  time: 1.8943  data: 0.0375  max mem: 34806
Train Epoch: [0]  [ 150/2244]  eta: 1:14:03  lr: 0.000049  loss_ita: -0.0065  lr_temp_net: 0.00003000  loss_temp: 0.4853  avg_image_tau: 0.0399  avg_text_tau: 0.0385  time: 1.7189  data: 0.0283  max mem: 34806
Train Epoch: [0]  [ 200/2244]  eta: 1:09:57  lr: 0.000049  loss_ita: -0.0101  lr_temp_net: 0.00003000  loss_temp: 0.4498  avg_image_tau: 0.0393  avg_text_tau: 0.0379  time: 1.9218  data: 0.0345  max mem: 34806
Train Epoch: [0]  [ 250/2244]  eta: 1:07:41  lr: 0.000089  loss_ita: -0.0046  lr_temp_net: 0.00003000  loss_temp: 0.4182  avg_image_tau: 0.0387  avg_text_tau: 0.0373  time: 2.0445  data: 0.0618  max mem: 34806
Train Epoch: [0]  [ 300/2244]  eta: 1:07:19  lr: 0.000089  loss_ita: -0.0159  lr_temp_net: 0.00003000  loss_temp: 0.3943  avg_image_tau: 0.0382  avg_text_tau: 0.0368  time: 1.8568  data: 0.0350  max mem: 34806
Train Epoch: [0]  [ 350/2244]  eta: 1:05:14  lr: 0.000129  loss_ita: -0.0114  lr_temp_net: 0.00003000  loss_temp: 0.3800  avg_image_tau: 0.0377  avg_text_tau: 0.0362  time: 1.9259  data: 0.0658  max mem: 34806
Train Epoch: [0]  [ 400/2244]  eta: 1:04:01  lr: 0.000129  loss_ita: -0.0174  lr_temp_net: 0.00003000  loss_temp: 0.3601  avg_image_tau: 0.0370  avg_text_tau: 0.0356  time: 2.1607  data: 0.0508  max mem: 34806
Train Epoch: [0]  [ 450/2244]  eta: 1:02:04  lr: 0.000168  loss_ita: -0.0146  lr_temp_net: 0.00003000  loss_temp: 0.3434  avg_image_tau: 0.0364  avg_text_tau: 0.0350  time: 2.0109  data: 0.0317  max mem: 34806
Train Epoch: [0]  [ 500/2244]  eta: 1:00:01  lr: 0.000168  loss_ita: -0.0180  lr_temp_net: 0.00003000  loss_temp: 0.3298  avg_image_tau: 0.0358  avg_text_tau: 0.0345  time: 1.9399  data: 0.0463  max mem: 34806
Train Epoch: [0]  [ 550/2244]  eta: 0:58:55  lr: 0.000207  loss_ita: -0.0164  lr_temp_net: 0.00003000  loss_temp: 0.3228  avg_image_tau: 0.0353  avg_text_tau: 0.0338  time: 2.0191  data: 0.0457  max mem: 34806
Train Epoch: [0]  [ 600/2244]  eta: 0:56:42  lr: 0.000207  loss_ita: -0.0359  lr_temp_net: 0.00003000  loss_temp: 0.3130  avg_image_tau: 0.0348  avg_text_tau: 0.0333  time: 2.0393  data: 0.3323  max mem: 34806
Train Epoch: [0]  [ 650/2244]  eta: 0:54:46  lr: 0.000247  loss_ita: -0.0238  lr_temp_net: 0.00003000  loss_temp: 0.3010  avg_image_tau: 0.0342  avg_text_tau: 0.0327  time: 2.0353  data: 0.0612  max mem: 34806
Train Epoch: [0]  [ 700/2244]  eta: 0:52:53  lr: 0.000247  loss_ita: -0.0264  lr_temp_net: 0.00003000  loss_temp: 0.2911  avg_image_tau: 0.0335  avg_text_tau: 0.0321  time: 2.0046  data: 0.0416  max mem: 34806
Train Epoch: [0]  [ 750/2244]  eta: 0:52:16  lr: 0.000287  loss_ita: -0.0231  lr_temp_net: 0.00003000  loss_temp: 0.2809  avg_image_tau: 0.0330  avg_text_tau: 0.0315  time: 2.5671  data: 0.0448  max mem: 34806
Train Epoch: [0]  [ 800/2244]  eta: 0:50:02  lr: 0.000287  loss_ita: -0.0290  lr_temp_net: 0.00003000  loss_temp: 0.2766  avg_image_tau: 0.0324  avg_text_tau: 0.0309  time: 1.8374  data: 0.0751  max mem: 34806
Train Epoch: [0]  [ 850/2244]  eta: 0:48:08  lr: 0.000326  loss_ita: -0.0261  lr_temp_net: 0.00003000  loss_temp: 0.2598  avg_image_tau: 0.0318  avg_text_tau: 0.0303  time: 1.8029  data: 0.0351  max mem: 34806
Train Epoch: [0]  [ 900/2244]  eta: 0:46:07  lr: 0.000326  loss_ita: -0.0321  lr_temp_net: 0.00003000  loss_temp: 0.2549  avg_image_tau: 0.0312  avg_text_tau: 0.0298  time: 1.7950  data: 0.0310  max mem: 34806
Train Epoch: [0]  [ 950/2244]  eta: 0:44:45  lr: 0.000365  loss_ita: -0.0301  lr_temp_net: 0.00003000  loss_temp: 0.2508  avg_image_tau: 0.0306  avg_text_tau: 0.0290  time: 3.1134  data: 0.0601  max mem: 34806
Train Epoch: [0]  [1000/2244]  eta: 0:42:52  lr: 0.000365  loss_ita: -0.0261  lr_temp_net: 0.00003000  loss_temp: 0.2383  avg_image_tau: 0.0300  avg_text_tau: 0.0286  time: 1.9295  data: 0.0263  max mem: 34806
Train Epoch: [0]  [1050/2244]  eta: 0:41:04  lr: 0.000405  loss_ita: -0.0276  lr_temp_net: 0.00003000  loss_temp: 0.2326  avg_image_tau: 0.0294  avg_text_tau: 0.0280  time: 2.2688  data: 0.0352  max mem: 34806
Train Epoch: [0]  [1100/2244]  eta: 0:39:23  lr: 0.000405  loss_ita: -0.0281  lr_temp_net: 0.00003000  loss_temp: 0.2266  avg_image_tau: 0.0288  avg_text_tau: 0.0272  time: 2.2250  data: 0.0387  max mem: 34806
Train Epoch: [0]  [1150/2244]  eta: 0:37:31  lr: 0.000445  loss_ita: -0.0365  lr_temp_net: 0.00003000  loss_temp: 0.2251  avg_image_tau: 0.0281  avg_text_tau: 0.0266  time: 1.9196  data: 0.0338  max mem: 34806
Train Epoch: [0]  [1200/2244]  eta: 0:35:44  lr: 0.000445  loss_ita: -0.0258  lr_temp_net: 0.00003000  loss_temp: 0.2074  avg_image_tau: 0.0275  avg_text_tau: 0.0260  time: 1.8662  data: 0.0324  max mem: 34806
Train Epoch: [0]  [1250/2244]  eta: 0:33:50  lr: 0.000484  loss_ita: -0.0284  lr_temp_net: 0.00003000  loss_temp: 0.2049  avg_image_tau: 0.0269  avg_text_tau: 0.0254  time: 1.7606  data: 0.0279  max mem: 34806
Train Epoch: [0]  [1300/2244]  eta: 0:32:01  lr: 0.000484  loss_ita: -0.0333  lr_temp_net: 0.00003000  loss_temp: 0.1978  avg_image_tau: 0.0263  avg_text_tau: 0.0249  time: 1.8758  data: 0.0402  max mem: 34806
Train Epoch: [0]  [1350/2244]  eta: 0:30:13  lr: 0.000523  loss_ita: -0.0285  lr_temp_net: 0.00003000  loss_temp: 0.1940  avg_image_tau: 0.0257  avg_text_tau: 0.0240  time: 1.8843  data: 0.0338  max mem: 34806
Train Epoch: [0]  [1400/2244]  eta: 0:28:32  lr: 0.000523  loss_ita: -0.0252  lr_temp_net: 0.00003000  loss_temp: 0.1868  avg_image_tau: 0.0250  avg_text_tau: 0.0236  time: 1.9043  data: 0.0564  max mem: 34806
Train Epoch: [0]  [1450/2244]  eta: 0:26:49  lr: 0.000563  loss_ita: -0.0304  lr_temp_net: 0.00003000  loss_temp: 0.1800  avg_image_tau: 0.0243  avg_text_tau: 0.0228  time: 2.1910  data: 0.0449  max mem: 34806
Train Epoch: [0]  [1500/2244]  eta: 0:25:03  lr: 0.000563  loss_ita: -0.0203  lr_temp_net: 0.00003000  loss_temp: 0.1684  avg_image_tau: 0.0237  avg_text_tau: 0.0222  time: 1.8930  data: 0.0450  max mem: 34806
Train Epoch: [0]  [1550/2244]  eta: 0:23:17  lr: 0.000602  loss_ita: -0.0340  lr_temp_net: 0.00003000  loss_temp: 0.1706  avg_image_tau: 0.0230  avg_text_tau: 0.0216  time: 1.6909  data: 0.3436  max mem: 34806
Train Epoch: [0]  [1600/2244]  eta: 0:21:35  lr: 0.000602  loss_ita: -0.0318  lr_temp_net: 0.00003000  loss_temp: 0.1594  avg_image_tau: 0.0224  avg_text_tau: 0.0210  time: 1.8179  data: 0.4397  max mem: 34806
Train Epoch: [0]  [1650/2244]  eta: 0:19:55  lr: 0.000642  loss_ita: -0.0320  lr_temp_net: 0.00003000  loss_temp: 0.1519  avg_image_tau: 0.0218  avg_text_tau: 0.0203  time: 1.9190  data: 0.0553  max mem: 34806
Train Epoch: [0]  [1700/2244]  eta: 0:18:10  lr: 0.000642  loss_ita: -0.0305  lr_temp_net: 0.00003000  loss_temp: 0.1461  avg_image_tau: 0.0211  avg_text_tau: 0.0198  time: 1.8219  data: 0.0278  max mem: 34806
Train Epoch: [0]  [1750/2244]  eta: 0:16:27  lr: 0.000682  loss_ita: -0.0259  lr_temp_net: 0.00003000  loss_temp: 0.1406  avg_image_tau: 0.0205  avg_text_tau: 0.0190  time: 1.7909  data: 0.0324  max mem: 34806
Train Epoch: [0]  [1800/2244]  eta: 0:14:45  lr: 0.000682  loss_ita: -0.0319  lr_temp_net: 0.00003000  loss_temp: 0.1390  avg_image_tau: 0.0198  avg_text_tau: 0.0185  time: 1.8174  data: 0.0353  max mem: 34806
Train Epoch: [0]  [1850/2244]  eta: 0:13:05  lr: 0.000721  loss_ita: -0.0321  lr_temp_net: 0.00003000  loss_temp: 0.1327  avg_image_tau: 0.0191  avg_text_tau: 0.0178  time: 1.8663  data: 0.0407  max mem: 34806
Train Epoch: [0]  [1900/2244]  eta: 0:11:23  lr: 0.000721  loss_ita: -0.0318  lr_temp_net: 0.00003000  loss_temp: 0.1283  avg_image_tau: 0.0185  avg_text_tau: 0.0173  time: 1.7150  data: 0.0703  max mem: 34806
Train Epoch: [0]  [1950/2244]  eta: 0:09:43  lr: 0.000760  loss_ita: -0.0266  lr_temp_net: 0.00003000  loss_temp: 0.1207  avg_image_tau: 0.0177  avg_text_tau: 0.0166  time: 1.8927  data: 0.0431  max mem: 34806
Train Epoch: [0]  [2000/2244]  eta: 0:08:04  lr: 0.000760  loss_ita: -0.0352  lr_temp_net: 0.00003000  loss_temp: 0.1172  avg_image_tau: 0.0171  avg_text_tau: 0.0161  time: 2.7341  data: 0.0481  max mem: 34806
Train Epoch: [0]  [2050/2244]  eta: 0:06:27  lr: 0.000800  loss_ita: -0.0279  lr_temp_net: 0.00003000  loss_temp: 0.1092  avg_image_tau: 0.0164  avg_text_tau: 0.0154  time: 1.8512  data: 0.1076  max mem: 34806
Train Epoch: [0]  [2100/2244]  eta: 0:04:47  lr: 0.000800  loss_ita: -0.0301  lr_temp_net: 0.00003000  loss_temp: 0.1101  avg_image_tau: 0.0156  avg_text_tau: 0.0147  time: 1.9607  data: 0.0459  max mem: 34806
Train Epoch: [0]  [2150/2244]  eta: 0:03:07  lr: 0.000800  loss_ita: -0.0280  lr_temp_net: 0.00003000  loss_temp: 0.1022  avg_image_tau: 0.0151  avg_text_tau: 0.0142  time: 1.7701  data: 0.0351  max mem: 34806
Train Epoch: [0]  [2200/2244]  eta: 0:01:27  lr: 0.000800  loss_ita: -0.0291  lr_temp_net: 0.00003000  loss_temp: 0.0945  avg_image_tau: 0.0144  avg_text_tau: 0.0136  time: 2.0379  data: 0.0396  max mem: 34806
Train Epoch: [0]  [2243/2244]  eta: 0:00:01  lr: 0.000800  loss_ita: -0.0273  lr_temp_net: 0.00003000  loss_temp: 0.0892  avg_image_tau: 0.0138  avg_text_tau: 0.0131  time: 1.8922  data: 0.0402  max mem: 34806
Train Epoch: [0] Total time: 1:14:26 (1.9906 s / it)
Averaged stats: lr: 0.0004  loss_ita: -0.0243  lr_temp_net: 0.0000  loss_temp: 0.2550  avg_image_tau: 0.0282  avg_text_tau: 0.0269
Computing features for evaluation...
Evaluation time 0:01:23
Computing features for evaluation...
Evaluation time 0:01:05
Computing features for evaluation...
Evaluation time 0:00:26
Computing features for evaluation...
Evaluation time 0:00:25
coco val: {'txt_r1': 24.04, 'txt_r5': 46.42, 'txt_r10': 58.62, 'txt_r_mean': 43.02666666666667, 'img_r1': 13.854458216713315, 'img_r5': 33.72251099560176, 'img_r10': 45.289884046381445, 'img_r_mean': 30.955617752898842, 'r_mean': 36.99114220978276}
coco test: {'txt_r1': 24.1, 'txt_r5': 47.54, 'txt_r10': 59.12, 'txt_r_mean': 43.586666666666666, 'img_r1': 14.194322271091563, 'img_r5': 34.38624550179928, 'img_r10': 45.977608956417434, 'img_r_mean': 31.51939224310276, 'r_mean': 37.553029454884715}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [1]  [   0/2244]  eta: 9:57:30  lr: 0.000798  loss_ita: 0.0358  lr_temp_net: 0.00002700  loss_temp: 0.1908  avg_image_tau: 0.0138  avg_text_tau: 0.0132  time: 15.9761  data: 8.1255  max mem: 34806
Train Epoch: [1]  [  50/2244]  eta: 1:29:34  lr: 0.000798  loss_ita: 0.0024  lr_temp_net: 0.00002700  loss_temp: 0.1486  avg_image_tau: 0.0115  avg_text_tau: 0.0109  time: 1.8385  data: 0.0840  max mem: 34806
Train Epoch: [1]  [ 100/2244]  eta: 1:16:31  lr: 0.000798  loss_ita: 0.0010  lr_temp_net: 0.00002700  loss_temp: 0.1187  avg_image_tau: 0.0104  avg_text_tau: 0.0099  time: 1.7546  data: 0.0349  max mem: 34806
Train Epoch: [1]  [ 150/2244]  eta: 1:12:10  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0954  avg_image_tau: 0.0093  avg_text_tau: 0.0090  time: 1.9442  data: 0.0337  max mem: 34806
Train Epoch: [1]  [ 200/2244]  eta: 1:08:35  lr: 0.000798  loss_ita: 0.0009  lr_temp_net: 0.00002700  loss_temp: 0.0816  avg_image_tau: 0.0085  avg_text_tau: 0.0084  time: 2.0690  data: 0.0263  max mem: 34806
Train Epoch: [1]  [ 250/2244]  eta: 1:05:41  lr: 0.000798  loss_ita: 0.0009  lr_temp_net: 0.00002700  loss_temp: 0.0709  avg_image_tau: 0.0077  avg_text_tau: 0.0077  time: 1.9553  data: 0.0442  max mem: 34806
Train Epoch: [1]  [ 300/2244]  eta: 1:03:32  lr: 0.000798  loss_ita: 0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0617  avg_image_tau: 0.0070  avg_text_tau: 0.0070  time: 1.9803  data: 0.1127  max mem: 34806
Train Epoch: [1]  [ 350/2244]  eta: 1:02:00  lr: 0.000798  loss_ita: -0.0006  lr_temp_net: 0.00002700  loss_temp: 0.0559  avg_image_tau: 0.0064  avg_text_tau: 0.0064  time: 1.9599  data: 0.0441  max mem: 34806
Train Epoch: [1]  [ 400/2244]  eta: 0:59:47  lr: 0.000798  loss_ita: 0.0005  lr_temp_net: 0.00002700  loss_temp: 0.0477  avg_image_tau: 0.0057  avg_text_tau: 0.0058  time: 1.9628  data: 0.0780  max mem: 34806
Train Epoch: [1]  [ 450/2244]  eta: 0:57:41  lr: 0.000798  loss_ita: -0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0428  avg_image_tau: 0.0051  avg_text_tau: 0.0054  time: 1.7445  data: 0.0280  max mem: 34806
Train Epoch: [1]  [ 500/2244]  eta: 0:55:31  lr: 0.000798  loss_ita: 0.0009  lr_temp_net: 0.00002700  loss_temp: 0.0378  avg_image_tau: 0.0046  avg_text_tau: 0.0049  time: 1.6987  data: 0.0283  max mem: 34806
Train Epoch: [1]  [ 550/2244]  eta: 0:53:34  lr: 0.000798  loss_ita: -0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0342  avg_image_tau: 0.0040  avg_text_tau: 0.0044  time: 1.7858  data: 0.0248  max mem: 34806
Train Epoch: [1]  [ 600/2244]  eta: 0:52:32  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0307  avg_image_tau: 0.0036  avg_text_tau: 0.0039  time: 2.5527  data: 0.3562  max mem: 34806
Train Epoch: [1]  [ 650/2244]  eta: 0:51:34  lr: 0.000798  loss_ita: 0.0003  lr_temp_net: 0.00002700  loss_temp: 0.0261  avg_image_tau: 0.0032  avg_text_tau: 0.0035  time: 2.4062  data: 0.0397  max mem: 34806
Train Epoch: [1]  [ 700/2244]  eta: 0:50:01  lr: 0.000798  loss_ita: 0.0008  lr_temp_net: 0.00002700  loss_temp: 0.0238  avg_image_tau: 0.0028  avg_text_tau: 0.0032  time: 1.9642  data: 0.0422  max mem: 34806
Train Epoch: [1]  [ 750/2244]  eta: 0:48:38  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0208  avg_image_tau: 0.0025  avg_text_tau: 0.0029  time: 1.7843  data: 0.0518  max mem: 34806
Train Epoch: [1]  [ 800/2244]  eta: 0:46:56  lr: 0.000798  loss_ita: 0.0006  lr_temp_net: 0.00002700  loss_temp: 0.0179  avg_image_tau: 0.0023  avg_text_tau: 0.0026  time: 1.9782  data: 0.1686  max mem: 34806
Train Epoch: [1]  [ 850/2244]  eta: 0:45:20  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0177  avg_image_tau: 0.0021  avg_text_tau: 0.0024  time: 2.0151  data: 0.0410  max mem: 34806
Train Epoch: [1]  [ 900/2244]  eta: 0:43:37  lr: 0.000798  loss_ita: 0.0007  lr_temp_net: 0.00002700  loss_temp: 0.0154  avg_image_tau: 0.0019  avg_text_tau: 0.0022  time: 1.7937  data: 0.0563  max mem: 34806
Train Epoch: [1]  [ 950/2244]  eta: 0:41:56  lr: 0.000798  loss_ita: 0.0004  lr_temp_net: 0.00002700  loss_temp: 0.0144  avg_image_tau: 0.0018  avg_text_tau: 0.0020  time: 1.9338  data: 0.0440  max mem: 34806
Train Epoch: [1]  [1000/2244]  eta: 0:40:20  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0135  avg_image_tau: 0.0017  avg_text_tau: 0.0019  time: 1.9800  data: 0.0460  max mem: 34806
Train Epoch: [1]  [1050/2244]  eta: 0:38:48  lr: 0.000798  loss_ita: 0.0004  lr_temp_net: 0.00002700  loss_temp: 0.0119  avg_image_tau: 0.0016  avg_text_tau: 0.0018  time: 2.2327  data: 0.0530  max mem: 34806
Train Epoch: [1]  [1100/2244]  eta: 0:39:59  lr: 0.000798  loss_ita: 0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0116  avg_image_tau: 0.0015  avg_text_tau: 0.0017  time: 2.1590  data: 0.0501  max mem: 34806
Train Epoch: [1]  [1150/2244]  eta: 0:38:21  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0112  avg_image_tau: 0.0014  avg_text_tau: 0.0017  time: 2.7469  data: 0.0768  max mem: 34806
Train Epoch: [1]  [1200/2244]  eta: 0:36:38  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0103  avg_image_tau: 0.0014  avg_text_tau: 0.0016  time: 2.1940  data: 0.0652  max mem: 34806
Train Epoch: [1]  [1250/2244]  eta: 0:34:57  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0097  avg_image_tau: 0.0013  avg_text_tau: 0.0015  time: 2.0054  data: 0.0445  max mem: 34806
Train Epoch: [1]  [1300/2244]  eta: 0:33:14  lr: 0.000798  loss_ita: 0.0003  lr_temp_net: 0.00002700  loss_temp: 0.0087  avg_image_tau: 0.0013  avg_text_tau: 0.0014  time: 2.2859  data: 0.0471  max mem: 34806
Train Epoch: [1]  [1350/2244]  eta: 0:31:34  lr: 0.000798  loss_ita: 0.0006  lr_temp_net: 0.00002700  loss_temp: 0.0085  avg_image_tau: 0.0013  avg_text_tau: 0.0013  time: 2.6361  data: 0.0482  max mem: 34806
Train Epoch: [1]  [1400/2244]  eta: 0:30:11  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0083  avg_image_tau: 0.0013  avg_text_tau: 0.0013  time: 2.8583  data: 0.0415  max mem: 34806
Train Epoch: [1]  [1450/2244]  eta: 0:28:44  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0079  avg_image_tau: 0.0012  avg_text_tau: 0.0013  time: 2.6723  data: 0.0376  max mem: 34806
Train Epoch: [1]  [1500/2244]  eta: 0:26:49  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0080  avg_image_tau: 0.0012  avg_text_tau: 0.0013  time: 2.0469  data: 0.0343  max mem: 34806
Train Epoch: [1]  [1550/2244]  eta: 0:25:05  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0077  avg_image_tau: 0.0012  avg_text_tau: 0.0013  time: 2.0122  data: 0.0578  max mem: 34806
Train Epoch: [1]  [1600/2244]  eta: 0:23:17  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0075  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 2.0637  data: 0.0379  max mem: 34806
Train Epoch: [1]  [1650/2244]  eta: 0:21:27  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0070  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 2.2195  data: 0.0405  max mem: 34806
Train Epoch: [1]  [1700/2244]  eta: 0:19:38  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0074  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 1.8532  data: 0.0559  max mem: 34806
Train Epoch: [1]  [1750/2244]  eta: 0:17:50  lr: 0.000798  loss_ita: 0.0003  lr_temp_net: 0.00002700  loss_temp: 0.0065  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 2.1348  data: 0.0560  max mem: 34806
Train Epoch: [1]  [1800/2244]  eta: 0:16:03  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0063  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.9607  data: 0.0487  max mem: 34806
Train Epoch: [1]  [1850/2244]  eta: 0:14:15  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0063  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 2.4560  data: 0.0421  max mem: 34806
Train Epoch: [1]  [1900/2244]  eta: 0:12:25  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0064  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.8259  data: 0.0397  max mem: 34806
Train Epoch: [1]  [1950/2244]  eta: 0:10:38  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0059  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 2.2300  data: 0.0358  max mem: 34806
Train Epoch: [1]  [2000/2244]  eta: 0:08:49  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0059  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 2.1400  data: 0.0488  max mem: 34806
Train Epoch: [1]  [2050/2244]  eta: 0:06:59  lr: 0.000798  loss_ita: 0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0055  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.6317  data: 0.0443  max mem: 34806
Train Epoch: [1]  [2100/2244]  eta: 0:05:10  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0058  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.8996  data: 0.0324  max mem: 34806
Train Epoch: [1]  [2150/2244]  eta: 0:03:21  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0055  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.8076  data: 0.0474  max mem: 34806
Train Epoch: [1]  [2200/2244]  eta: 0:01:34  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0053  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.8134  data: 0.0345  max mem: 34806
Train Epoch: [1]  [2243/2244]  eta: 0:00:02  lr: 0.000798  loss_ita: 0.0015  lr_temp_net: 0.00002700  loss_temp: 0.0069  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.9475  data: 0.0460  max mem: 34806
Train Epoch: [1] Total time: 1:19:58 (2.1382 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0002  lr_temp_net: 0.0000  loss_temp: 0.0278  avg_image_tau: 0.0031  avg_text_tau: 0.0032
Computing features for evaluation...
Evaluation time 0:01:08
Computing features for evaluation...
Evaluation time 0:01:03
Computing features for evaluation...
Evaluation time 0:00:23
Computing features for evaluation...
Evaluation time 0:00:20
coco val: {'txt_r1': 32.74, 'txt_r5': 57.94, 'txt_r10': 68.58, 'txt_r_mean': 53.086666666666666, 'img_r1': 19.53218712514994, 'img_r5': 42.01919232307077, 'img_r10': 54.66613354658137, 'img_r_mean': 38.73917099826736, 'r_mean': 45.912918832467014}
coco test: {'txt_r1': 32.58, 'txt_r5': 58.32, 'txt_r10': 68.74, 'txt_r_mean': 53.21333333333333, 'img_r1': 19.404238304678127, 'img_r5': 42.70691723310676, 'img_r10': 54.506197520991606, 'img_r_mean': 38.87245101959216, 'r_mean': 46.04289217646274}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [2]  [   0/2244]  eta: 15:09:56  lr: 0.000791  loss_ita: 0.0024  lr_temp_net: 0.00002430  loss_temp: 0.0131  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 24.3298  data: 9.0370  max mem: 34806
Train Epoch: [2]  [  50/2244]  eta: 1:27:32  lr: 0.000791  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0118  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.7897  data: 0.0337  max mem: 34806
Train Epoch: [2]  [ 100/2244]  eta: 1:16:06  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0103  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.9528  data: 0.0337  max mem: 34806
Train Epoch: [2]  [ 150/2244]  eta: 1:12:06  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 2.0253  data: 0.0413  max mem: 34806
Train Epoch: [2]  [ 200/2244]  eta: 1:07:33  lr: 0.000791  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0086  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.6886  data: 0.0321  max mem: 34806
Train Epoch: [2]  [ 250/2244]  eta: 1:04:08  lr: 0.000791  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.7075  data: 0.0351  max mem: 34806
Train Epoch: [2]  [ 300/2244]  eta: 1:01:22  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.6838  data: 0.0258  max mem: 34806
Train Epoch: [2]  [ 350/2244]  eta: 0:59:38  lr: 0.000791  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.9425  data: 0.0324  max mem: 34806
Train Epoch: [2]  [ 400/2244]  eta: 0:57:10  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7180  data: 0.0342  max mem: 34806
Train Epoch: [2]  [ 450/2244]  eta: 0:55:33  lr: 0.000791  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.9605  data: 0.0371  max mem: 34806
Train Epoch: [2]  [ 500/2244]  eta: 0:54:10  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8726  data: 0.0395  max mem: 34806
Train Epoch: [2]  [ 550/2244]  eta: 0:52:03  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6368  data: 0.0276  max mem: 34806
Train Epoch: [2]  [ 600/2244]  eta: 0:50:16  lr: 0.000791  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8684  data: 0.0281  max mem: 34806
Train Epoch: [2]  [ 650/2244]  eta: 0:48:53  lr: 0.000791  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7636  data: 0.0385  max mem: 34806
Train Epoch: [2]  [ 700/2244]  eta: 0:47:17  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7791  data: 0.0351  max mem: 34806
Train Epoch: [2]  [ 750/2244]  eta: 0:45:36  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6902  data: 0.0350  max mem: 34806
Train Epoch: [2]  [ 800/2244]  eta: 0:44:01  lr: 0.000791  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8700  data: 0.0376  max mem: 34806
Train Epoch: [2]  [ 850/2244]  eta: 0:42:29  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8997  data: 0.0375  max mem: 34806
Train Epoch: [2]  [ 900/2244]  eta: 0:41:00  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.9297  data: 0.0341  max mem: 34806
Train Epoch: [2]  [ 950/2244]  eta: 0:39:30  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8869  data: 0.0402  max mem: 34806
Train Epoch: [2]  [1000/2244]  eta: 0:37:52  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6779  data: 0.0362  max mem: 34806
Train Epoch: [2]  [1050/2244]  eta: 0:36:12  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6676  data: 0.0432  max mem: 34806
Train Epoch: [2]  [1100/2244]  eta: 0:34:32  lr: 0.000791  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6787  data: 0.0291  max mem: 34806
Train Epoch: [2]  [1150/2244]  eta: 0:32:58  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6567  data: 0.0273  max mem: 34806
Train Epoch: [2]  [1200/2244]  eta: 0:31:23  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5583  data: 0.1959  max mem: 34806
Train Epoch: [2]  [1250/2244]  eta: 0:31:54  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6075  data: 0.0233  max mem: 34806
Train Epoch: [2]  [1300/2244]  eta: 0:30:07  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6138  data: 0.0286  max mem: 34806
Train Epoch: [2]  [1350/2244]  eta: 0:28:22  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6020  data: 0.0389  max mem: 34806
Train Epoch: [2]  [1400/2244]  eta: 0:26:41  lr: 0.000791  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6221  data: 0.0310  max mem: 34806
Train Epoch: [2]  [1450/2244]  eta: 0:25:00  lr: 0.000791  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6455  data: 0.0388  max mem: 34806
Train Epoch: [2]  [1500/2244]  eta: 0:23:29  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.2571  data: 0.0361  max mem: 34806
Train Epoch: [2]  [1550/2244]  eta: 0:21:50  lr: 0.000791  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8576  data: 0.0339  max mem: 34806
Train Epoch: [2]  [1600/2244]  eta: 0:20:11  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7384  data: 0.0294  max mem: 34806
Train Epoch: [2]  [1650/2244]  eta: 0:18:33  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6905  data: 0.0290  max mem: 34806
Train Epoch: [2]  [1700/2244]  eta: 0:16:54  lr: 0.000791  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5113  data: 0.0344  max mem: 34806
Train Epoch: [2]  [1750/2244]  eta: 0:15:17  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5948  data: 0.1121  max mem: 34806
Train Epoch: [2]  [1800/2244]  eta: 0:13:40  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5451  data: 0.0445  max mem: 34806
Train Epoch: [2]  [1850/2244]  eta: 0:12:05  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6463  data: 0.2353  max mem: 34806
Train Epoch: [2]  [1900/2244]  eta: 0:10:31  lr: 0.000791  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6325  data: 0.0233  max mem: 34806
Train Epoch: [2]  [1950/2244]  eta: 0:08:58  lr: 0.000791  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6816  data: 0.0358  max mem: 34806
Train Epoch: [2]  [2000/2244]  eta: 0:07:26  lr: 0.000791  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7389  data: 0.0353  max mem: 34806
Train Epoch: [2]  [2050/2244]  eta: 0:05:54  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7501  data: 0.0331  max mem: 34806
Train Epoch: [2]  [2100/2244]  eta: 0:04:22  lr: 0.000791  loss_ita: 0.0004  lr_temp_net: 0.00002430  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6610  data: 0.0312  max mem: 34806
Train Epoch: [2]  [2150/2244]  eta: 0:02:51  lr: 0.000791  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7315  data: 0.0370  max mem: 34806
Train Epoch: [2]  [2200/2244]  eta: 0:01:20  lr: 0.000791  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7008  data: 0.0416  max mem: 34806
Train Epoch: [2]  [2243/2244]  eta: 0:00:01  lr: 0.000791  loss_ita: 0.0013  lr_temp_net: 0.00002430  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.1839  data: 0.0474  max mem: 34806
Train Epoch: [2] Total time: 1:08:10 (1.8230 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:59
Computing features for evaluation...
Evaluation time 0:00:53
Computing features for evaluation...
Evaluation time 0:00:20
Computing features for evaluation...
Evaluation time 0:00:20
coco val: {'txt_r1': 25.58, 'txt_r5': 49.48, 'txt_r10': 60.82, 'txt_r_mean': 45.29333333333333, 'img_r1': 16.533386645341864, 'img_r5': 37.34906037584966, 'img_r10': 49.40423830467813, 'img_r_mean': 34.428895108623216, 'r_mean': 39.86111422097827}
coco test: {'txt_r1': 26.12, 'txt_r5': 49.16, 'txt_r10': 60.38, 'txt_r_mean': 45.22, 'img_r1': 16.369452219112354, 'img_r5': 37.86485405837665, 'img_r10': 49.62415033986405, 'img_r_mean': 34.61948553911768, 'r_mean': 39.91974276955884}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [3]  [   0/2244]  eta: 9:32:40  lr: 0.000781  loss_ita: 0.0023  lr_temp_net: 0.00002187  loss_temp: 0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 15.3120  data: 6.4550  max mem: 34806
Train Epoch: [3]  [  50/2244]  eta: 1:16:15  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8508  data: 0.0429  max mem: 34806
Train Epoch: [3]  [ 100/2244]  eta: 1:09:22  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7308  data: 0.0408  max mem: 34806
Train Epoch: [3]  [ 150/2244]  eta: 1:05:26  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7871  data: 0.0398  max mem: 34806
Train Epoch: [3]  [ 200/2244]  eta: 1:04:06  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8886  data: 0.0395  max mem: 34806
Train Epoch: [3]  [ 250/2244]  eta: 1:01:16  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8336  data: 0.0813  max mem: 34806
Train Epoch: [3]  [ 300/2244]  eta: 0:58:51  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6754  data: 0.0295  max mem: 34806
Train Epoch: [3]  [ 350/2244]  eta: 0:56:44  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6009  data: 0.0256  max mem: 34806
Train Epoch: [3]  [ 400/2244]  eta: 0:54:21  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6252  data: 0.0512  max mem: 34806
Train Epoch: [3]  [ 450/2244]  eta: 0:52:36  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8127  data: 0.0345  max mem: 34806
Train Epoch: [3]  [ 500/2244]  eta: 0:51:06  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8120  data: 0.0394  max mem: 34806
Train Epoch: [3]  [ 550/2244]  eta: 0:49:30  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6276  data: 0.0285  max mem: 34806
Train Epoch: [3]  [ 600/2244]  eta: 0:48:04  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7955  data: 0.0462  max mem: 34806
Train Epoch: [3]  [ 650/2244]  eta: 0:46:28  lr: 0.000781  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6535  data: 0.0330  max mem: 34806
Train Epoch: [3]  [ 700/2244]  eta: 0:45:00  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6512  data: 0.0274  max mem: 34806
Train Epoch: [3]  [ 750/2244]  eta: 0:43:32  lr: 0.000781  loss_ita: 0.0005  lr_temp_net: 0.00002187  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7646  data: 0.0329  max mem: 34806
Train Epoch: [3]  [ 800/2244]  eta: 0:42:09  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8418  data: 0.0372  max mem: 34806
Train Epoch: [3]  [ 850/2244]  eta: 0:40:44  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7824  data: 0.0399  max mem: 34806
Train Epoch: [3]  [ 900/2244]  eta: 0:39:19  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7524  data: 0.0320  max mem: 34806
Train Epoch: [3]  [ 950/2244]  eta: 0:37:57  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8850  data: 0.0462  max mem: 34806
Train Epoch: [3]  [1000/2244]  eta: 0:36:27  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7750  data: 0.0330  max mem: 34806
Train Epoch: [3]  [1050/2244]  eta: 0:34:50  lr: 0.000781  loss_ita: 0.0004  lr_temp_net: 0.00002187  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5927  data: 0.0245  max mem: 34806
Train Epoch: [3]  [1100/2244]  eta: 0:33:16  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6008  data: 0.0275  max mem: 34806
Train Epoch: [3]  [1150/2244]  eta: 0:31:46  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7518  data: 0.0543  max mem: 34806
Train Epoch: [3]  [1200/2244]  eta: 0:30:19  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7201  data: 0.0328  max mem: 34806
Train Epoch: [3]  [1250/2244]  eta: 0:28:51  lr: 0.000781  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7865  data: 0.0371  max mem: 34806
Train Epoch: [3]  [1300/2244]  eta: 0:27:25  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8225  data: 0.1189  max mem: 34806
Train Epoch: [3]  [1350/2244]  eta: 0:26:03  lr: 0.000781  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.0710  data: 0.0316  max mem: 34806
Train Epoch: [3]  [1400/2244]  eta: 0:24:35  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8216  data: 0.0528  max mem: 34806
Train Epoch: [3]  [1450/2244]  eta: 0:23:08  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6930  data: 0.0310  max mem: 34806
Train Epoch: [3]  [1500/2244]  eta: 0:21:40  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7318  data: 0.0359  max mem: 34806
Train Epoch: [3]  [1550/2244]  eta: 0:20:13  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8100  data: 0.0403  max mem: 34806
Train Epoch: [3]  [1600/2244]  eta: 0:19:53  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7957  data: 0.0398  max mem: 34806
Train Epoch: [3]  [1650/2244]  eta: 0:18:22  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5887  data: 0.0508  max mem: 34806
Train Epoch: [3]  [1700/2244]  eta: 0:16:47  lr: 0.000781  loss_ita: 0.0004  lr_temp_net: 0.00002187  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7300  data: 0.1117  max mem: 34806
Train Epoch: [3]  [1750/2244]  eta: 0:15:12  lr: 0.000781  loss_ita: 0.0005  lr_temp_net: 0.00002187  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6495  data: 0.0443  max mem: 34806
Train Epoch: [3]  [1800/2244]  eta: 0:13:37  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6774  data: 0.0327  max mem: 34806
Train Epoch: [3]  [1850/2244]  eta: 0:12:08  lr: 0.000781  loss_ita: -0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.6899  data: 0.0479  max mem: 34806
Train Epoch: [3]  [1900/2244]  eta: 0:10:35  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7279  data: 0.0548  max mem: 34806
Train Epoch: [3]  [1950/2244]  eta: 0:09:02  lr: 0.000781  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7257  data: 0.0368  max mem: 34806
Train Epoch: [3]  [2000/2244]  eta: 0:07:29  lr: 0.000781  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8051  data: 0.0451  max mem: 34806
Train Epoch: [3]  [2050/2244]  eta: 0:05:57  lr: 0.000781  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5966  data: 0.0487  max mem: 34806
Train Epoch: [3]  [2100/2244]  eta: 0:04:25  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.9395  data: 0.0269  max mem: 34806
Train Epoch: [3]  [2150/2244]  eta: 0:02:53  lr: 0.000781  loss_ita: 0.0005  lr_temp_net: 0.00002187  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8975  data: 0.0397  max mem: 34806
Train Epoch: [3]  [2200/2244]  eta: 0:01:21  lr: 0.000781  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7562  data: 0.0728  max mem: 34806
Train Epoch: [3]  [2243/2244]  eta: 0:00:01  lr: 0.000781  loss_ita: 0.0015  lr_temp_net: 0.00002187  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8356  data: 0.0456  max mem: 34806
Train Epoch: [3] Total time: 1:08:51 (1.8413 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:01:10
Computing features for evaluation...
Evaluation time 0:00:54
Computing features for evaluation...
Evaluation time 0:00:23
Computing features for evaluation...
Evaluation time 0:00:21
coco val: {'txt_r1': 27.32, 'txt_r5': 50.88, 'txt_r10': 61.58, 'txt_r_mean': 46.593333333333334, 'img_r1': 15.593762495001998, 'img_r5': 36.33346661335466, 'img_r10': 48.00879648140744, 'img_r_mean': 33.312008529921364, 'r_mean': 39.95267093162735}
coco test: {'txt_r1': 26.62, 'txt_r5': 50.74, 'txt_r10': 62.1, 'txt_r_mean': 46.48666666666667, 'img_r1': 15.897640943622552, 'img_r5': 36.5453818472611, 'img_r10': 48.2047181127549, 'img_r_mean': 33.54924696787952, 'r_mean': 40.017956817273095}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [4]  [   0/2244]  eta: 11:56:16  lr: 0.000766  loss_ita: 0.0022  lr_temp_net: 0.00001968  loss_temp: 0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 19.1516  data: 9.0440  max mem: 34806
Train Epoch: [4]  [  50/2244]  eta: 1:21:18  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8188  data: 0.0351  max mem: 34806
Train Epoch: [4]  [ 100/2244]  eta: 1:10:47  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6871  data: 0.0381  max mem: 34806
Train Epoch: [4]  [ 150/2244]  eta: 1:06:37  lr: 0.000766  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7946  data: 0.0351  max mem: 34806
Train Epoch: [4]  [ 200/2244]  eta: 1:03:28  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6905  data: 0.0323  max mem: 34806
Train Epoch: [4]  [ 250/2244]  eta: 1:00:49  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6824  data: 0.0268  max mem: 34806
Train Epoch: [4]  [ 300/2244]  eta: 0:58:24  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6821  data: 0.0292  max mem: 34806
Train Epoch: [4]  [ 350/2244]  eta: 0:56:35  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7212  data: 0.0304  max mem: 34806
Train Epoch: [4]  [ 400/2244]  eta: 0:54:36  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7018  data: 0.0322  max mem: 34806
Train Epoch: [4]  [ 450/2244]  eta: 0:52:59  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7056  data: 0.0280  max mem: 34806
Train Epoch: [4]  [ 500/2244]  eta: 0:51:21  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7581  data: 0.0458  max mem: 34806
Train Epoch: [4]  [ 550/2244]  eta: 0:49:39  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7395  data: 0.0407  max mem: 34806
Train Epoch: [4]  [ 600/2244]  eta: 0:48:55  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.3691  data: 0.0500  max mem: 34806
Train Epoch: [4]  [ 650/2244]  eta: 0:47:16  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7067  data: 0.0961  max mem: 34806
Train Epoch: [4]  [ 700/2244]  eta: 0:45:46  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6571  data: 0.0328  max mem: 34806
Train Epoch: [4]  [ 750/2244]  eta: 0:44:26  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6160  data: 0.0306  max mem: 34806
Train Epoch: [4]  [ 800/2244]  eta: 0:42:52  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7081  data: 0.0323  max mem: 34806
Train Epoch: [4]  [ 850/2244]  eta: 0:41:14  lr: 0.000766  loss_ita: -0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6449  data: 0.0333  max mem: 34806
Train Epoch: [4]  [ 900/2244]  eta: 0:40:16  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5493  data: 0.0263  max mem: 34806
Train Epoch: [4]  [ 950/2244]  eta: 0:38:37  lr: 0.000766  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6261  data: 0.0210  max mem: 34806
Train Epoch: [4]  [1000/2244]  eta: 0:37:21  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5942  data: 0.0348  max mem: 34806
Train Epoch: [4]  [1050/2244]  eta: 0:35:43  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7105  data: 0.0325  max mem: 34806
Train Epoch: [4]  [1100/2244]  eta: 0:34:08  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6945  data: 0.0328  max mem: 34806
Train Epoch: [4]  [1150/2244]  eta: 0:32:35  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6199  data: 0.0375  max mem: 34806
Train Epoch: [4]  [1200/2244]  eta: 0:31:32  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.3559  data: 0.0399  max mem: 34806
Train Epoch: [4]  [1250/2244]  eta: 0:29:56  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6583  data: 0.0338  max mem: 34806
Train Epoch: [4]  [1300/2244]  eta: 0:28:21  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6168  data: 0.0282  max mem: 34806
Train Epoch: [4]  [1350/2244]  eta: 0:26:46  lr: 0.000766  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6594  data: 0.0322  max mem: 34806
Train Epoch: [4]  [1400/2244]  eta: 0:25:38  lr: 0.000766  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.3211  data: 0.0490  max mem: 34806
Train Epoch: [4]  [1450/2244]  eta: 0:24:01  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6308  data: 0.0297  max mem: 34806
Train Epoch: [4]  [1500/2244]  eta: 0:22:27  lr: 0.000766  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6921  data: 0.0323  max mem: 34806
Train Epoch: [4]  [1550/2244]  eta: 0:20:52  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6238  data: 0.0330  max mem: 34806
Train Epoch: [4]  [1600/2244]  eta: 0:19:35  lr: 0.000766  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.0506  data: 0.0518  max mem: 34806
Train Epoch: [4]  [1650/2244]  eta: 0:18:00  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6127  data: 0.0311  max mem: 34806
Train Epoch: [4]  [1700/2244]  eta: 0:16:26  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5841  data: 0.0351  max mem: 34806
Train Epoch: [4]  [1750/2244]  eta: 0:14:52  lr: 0.000766  loss_ita: -0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5685  data: 0.0242  max mem: 34806
Train Epoch: [4]  [1800/2244]  eta: 0:13:23  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.1815  data: 0.0414  max mem: 34806
Train Epoch: [4]  [1850/2244]  eta: 0:11:51  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7033  data: 0.0283  max mem: 34806
Train Epoch: [4]  [1900/2244]  eta: 0:10:19  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5772  data: 0.0238  max mem: 34806
Train Epoch: [4]  [1950/2244]  eta: 0:08:48  lr: 0.000766  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7227  data: 0.0329  max mem: 34806
Train Epoch: [4]  [2000/2244]  eta: 0:07:17  lr: 0.000766  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5487  data: 0.0273  max mem: 34806
Train Epoch: [4]  [2050/2244]  eta: 0:05:47  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7871  data: 0.0310  max mem: 34806
Train Epoch: [4]  [2100/2244]  eta: 0:04:16  lr: 0.000766  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5631  data: 0.2869  max mem: 34806
Train Epoch: [4]  [2150/2244]  eta: 0:02:47  lr: 0.000766  loss_ita: -0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5809  data: 0.0299  max mem: 34806
Train Epoch: [4]  [2200/2244]  eta: 0:01:19  lr: 0.000766  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6310  data: 0.0838  max mem: 34806
Train Epoch: [4]  [2243/2244]  eta: 0:00:01  lr: 0.000766  loss_ita: 0.0008  lr_temp_net: 0.00001968  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6899  data: 0.0371  max mem: 34806
Train Epoch: [4] Total time: 1:08:00 (1.8183 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:03:22
Computing features for evaluation...
Evaluation time 0:01:07
Computing features for evaluation...
Evaluation time 0:00:19
Computing features for evaluation...
Evaluation time 0:00:19
coco val: {'txt_r1': 27.48, 'txt_r5': 51.1, 'txt_r10': 62.56, 'txt_r_mean': 47.04666666666666, 'img_r1': 16.385445821671333, 'img_r5': 37.68092762894842, 'img_r10': 49.58416633346661, 'img_r_mean': 34.55017992802879, 'r_mean': 40.798423297347725}
coco test: {'txt_r1': 27.3, 'txt_r5': 51.2, 'txt_r10': 62.16, 'txt_r_mean': 46.88666666666666, 'img_r1': 16.937225109956017, 'img_r5': 37.60895641743303, 'img_r10': 49.456217512994805, 'img_r_mean': 34.66746634679462, 'r_mean': 40.77706650673064}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [5]  [   0/2244]  eta: 9:08:52  lr: 0.000747  loss_ita: 0.0016  lr_temp_net: 0.00001771  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 14.6756  data: 6.8124  max mem: 34806
Train Epoch: [5]  [  50/2244]  eta: 1:08:40  lr: 0.000747  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5861  data: 0.0309  max mem: 34806
Train Epoch: [5]  [ 100/2244]  eta: 1:02:03  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6454  data: 0.0315  max mem: 34806
Train Epoch: [5]  [ 150/2244]  eta: 0:59:37  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6378  data: 0.0361  max mem: 34806
Train Epoch: [5]  [ 200/2244]  eta: 0:58:14  lr: 0.000747  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7423  data: 0.0433  max mem: 34806
Train Epoch: [5]  [ 250/2244]  eta: 0:55:54  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5529  data: 0.0264  max mem: 34806
Train Epoch: [5]  [ 300/2244]  eta: 0:53:56  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6463  data: 0.0400  max mem: 34806
Train Epoch: [5]  [ 350/2244]  eta: 0:52:37  lr: 0.000747  loss_ita: 0.0004  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6868  data: 0.0324  max mem: 34806
Train Epoch: [5]  [ 400/2244]  eta: 0:51:12  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6687  data: 0.0265  max mem: 34806
Train Epoch: [5]  [ 450/2244]  eta: 0:49:41  lr: 0.000747  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5532  data: 0.0310  max mem: 34806
Train Epoch: [5]  [ 500/2244]  eta: 0:48:11  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5728  data: 0.0307  max mem: 34806
Train Epoch: [5]  [ 550/2244]  eta: 0:46:48  lr: 0.000747  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6980  data: 0.0381  max mem: 34806
Train Epoch: [5]  [ 600/2244]  eta: 0:45:22  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6368  data: 0.0332  max mem: 34806
Train Epoch: [5]  [ 650/2244]  eta: 0:44:00  lr: 0.000747  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6546  data: 0.0343  max mem: 34806
Train Epoch: [5]  [ 700/2244]  eta: 0:42:32  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6790  data: 0.0365  max mem: 34806
Train Epoch: [5]  [ 750/2244]  eta: 0:41:13  lr: 0.000747  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7270  data: 0.0340  max mem: 34806
Train Epoch: [5]  [ 800/2244]  eta: 0:39:49  lr: 0.000747  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6461  data: 0.0308  max mem: 34806
Train Epoch: [5]  [ 850/2244]  eta: 0:38:27  lr: 0.000747  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6528  data: 0.0345  max mem: 34806
Train Epoch: [5]  [ 900/2244]  eta: 0:37:04  lr: 0.000747  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6357  data: 0.0375  max mem: 34806
Train Epoch: [5]  [ 950/2244]  eta: 0:35:41  lr: 0.000747  loss_ita: -0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6644  data: 0.0356  max mem: 34806
Train Epoch: [5]  [1000/2244]  eta: 0:34:16  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6231  data: 0.0320  max mem: 34806
Train Epoch: [5]  [1050/2244]  eta: 0:32:56  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7091  data: 0.0322  max mem: 34806
Train Epoch: [5]  [1100/2244]  eta: 0:31:33  lr: 0.000747  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6824  data: 0.0370  max mem: 34806
Train Epoch: [5]  [1150/2244]  eta: 0:30:08  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5999  data: 0.0347  max mem: 34806
Train Epoch: [5]  [1200/2244]  eta: 0:28:56  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5858  data: 0.0303  max mem: 34806
Train Epoch: [5]  [1250/2244]  eta: 0:27:32  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6473  data: 0.0294  max mem: 34806
Train Epoch: [5]  [1300/2244]  eta: 0:26:08  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6106  data: 0.0266  max mem: 34806
Train Epoch: [5]  [1350/2244]  eta: 0:24:44  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5737  data: 0.0349  max mem: 34806
Train Epoch: [5]  [1400/2244]  eta: 0:23:21  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7264  data: 0.0325  max mem: 34806
Train Epoch: [5]  [1450/2244]  eta: 0:21:58  lr: 0.000747  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6421  data: 0.0334  max mem: 34806
Train Epoch: [5]  [1500/2244]  eta: 0:20:38  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.1196  data: 0.0322  max mem: 34806
Train Epoch: [5]  [1550/2244]  eta: 0:19:13  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6248  data: 0.0290  max mem: 34806
Train Epoch: [5]  [1600/2244]  eta: 0:17:51  lr: 0.000747  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7040  data: 0.0334  max mem: 34806
Train Epoch: [5]  [1650/2244]  eta: 0:16:27  lr: 0.000747  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6887  data: 0.0267  max mem: 34806
Train Epoch: [5]  [1700/2244]  eta: 0:15:04  lr: 0.000747  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6375  data: 0.0399  max mem: 34806
Train Epoch: [5]  [1750/2244]  eta: 0:13:40  lr: 0.000747  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6759  data: 0.0315  max mem: 34806
Train Epoch: [5]  [1800/2244]  eta: 0:12:17  lr: 0.000747  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6400  data: 0.1732  max mem: 34806
Train Epoch: [5]  [1850/2244]  eta: 0:10:54  lr: 0.000747  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7793  data: 0.0352  max mem: 34806
Train Epoch: [5]  [1900/2244]  eta: 0:09:31  lr: 0.000747  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5931  data: 0.0261  max mem: 34806
Train Epoch: [5]  [1950/2244]  eta: 0:08:08  lr: 0.000747  loss_ita: -0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6778  data: 0.0330  max mem: 34806
Train Epoch: [5]  [2000/2244]  eta: 0:06:45  lr: 0.000747  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8329  data: 0.0306  max mem: 34806
Train Epoch: [5]  [2050/2244]  eta: 0:05:22  lr: 0.000747  loss_ita: 0.0005  lr_temp_net: 0.00001771  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7083  data: 0.0296  max mem: 34806
Train Epoch: [5]  [2100/2244]  eta: 0:03:59  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5981  data: 0.0365  max mem: 34806
Train Epoch: [5]  [2150/2244]  eta: 0:02:43  lr: 0.000747  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 9.8643  data: 0.0388  max mem: 34806
Train Epoch: [5]  [2200/2244]  eta: 0:01:16  lr: 0.000747  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6878  data: 0.0228  max mem: 34806
Train Epoch: [5]  [2243/2244]  eta: 0:00:01  lr: 0.000747  loss_ita: 0.0005  lr_temp_net: 0.00001771  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7724  data: 0.0365  max mem: 34806
Train Epoch: [5] Total time: 1:04:57 (1.7370 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:01:13
Computing features for evaluation...
Evaluation time 0:01:06
Computing features for evaluation...
Evaluation time 0:00:23
Computing features for evaluation...
Evaluation time 0:00:22
coco val: {'txt_r1': 31.32, 'txt_r5': 55.52, 'txt_r10': 66.6, 'txt_r_mean': 51.14666666666667, 'img_r1': 18.340663734506197, 'img_r5': 40.53178728508597, 'img_r10': 52.50699720111955, 'img_r_mean': 37.126482740237236, 'r_mean': 44.136574703451956}
coco test: {'txt_r1': 29.14, 'txt_r5': 54.86, 'txt_r10': 66.98, 'txt_r_mean': 50.326666666666675, 'img_r1': 18.076769292283085, 'img_r5': 40.73970411835266, 'img_r10': 52.4390243902439, 'img_r_mean': 37.08516593362655, 'r_mean': 43.70591630014661}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [6]  [   0/2244]  eta: 7:31:56  lr: 0.000725  loss_ita: 0.0014  lr_temp_net: 0.00001594  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 12.0839  data: 5.9161  max mem: 34806
Train Epoch: [6]  [  50/2244]  eta: 1:09:21  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6653  data: 0.0352  max mem: 34806
Train Epoch: [6]  [ 100/2244]  eta: 1:02:11  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5300  data: 0.0257  max mem: 34806
Train Epoch: [6]  [ 150/2244]  eta: 0:58:15  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5770  data: 0.0335  max mem: 34806
Train Epoch: [6]  [ 200/2244]  eta: 0:57:00  lr: 0.000725  loss_ita: 0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6381  data: 0.0307  max mem: 34806
Train Epoch: [6]  [ 250/2244]  eta: 0:55:18  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6665  data: 0.0968  max mem: 34806
Train Epoch: [6]  [ 300/2244]  eta: 0:53:47  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5814  data: 0.0257  max mem: 34806
Train Epoch: [6]  [ 350/2244]  eta: 0:52:42  lr: 0.000725  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8442  data: 0.0838  max mem: 34806
Train Epoch: [6]  [ 400/2244]  eta: 0:51:15  lr: 0.000725  loss_ita: 0.0007  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6731  data: 0.0353  max mem: 34806
Train Epoch: [6]  [ 450/2244]  eta: 0:50:02  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6213  data: 0.0301  max mem: 34806
Train Epoch: [6]  [ 500/2244]  eta: 0:48:36  lr: 0.000725  loss_ita: 0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6780  data: 0.0347  max mem: 34806
Train Epoch: [6]  [ 550/2244]  eta: 0:47:04  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6026  data: 0.0330  max mem: 34806
Train Epoch: [6]  [ 600/2244]  eta: 0:45:45  lr: 0.000725  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6876  data: 0.0321  max mem: 34806
Train Epoch: [6]  [ 650/2244]  eta: 0:44:17  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6334  data: 0.0328  max mem: 34806
Train Epoch: [6]  [ 700/2244]  eta: 0:42:53  lr: 0.000725  loss_ita: 0.0004  lr_temp_net: 0.00001594  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5904  data: 0.0292  max mem: 34806
Train Epoch: [6]  [ 750/2244]  eta: 0:41:33  lr: 0.000725  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7208  data: 0.0307  max mem: 34806
Train Epoch: [6]  [ 800/2244]  eta: 0:40:14  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7343  data: 0.0299  max mem: 34806
Train Epoch: [6]  [ 850/2244]  eta: 0:38:54  lr: 0.000725  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6610  data: 0.0360  max mem: 34806
Train Epoch: [6]  [ 900/2244]  eta: 0:37:30  lr: 0.000725  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6636  data: 0.0320  max mem: 34806
Train Epoch: [6]  [ 950/2244]  eta: 0:36:13  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8153  data: 0.0359  max mem: 34806
Train Epoch: [6]  [1000/2244]  eta: 0:34:44  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5795  data: 0.0376  max mem: 34806
Train Epoch: [6]  [1050/2244]  eta: 0:33:10  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4963  data: 0.0883  max mem: 34806
Train Epoch: [6]  [1100/2244]  eta: 0:31:39  lr: 0.000725  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5422  data: 0.2911  max mem: 34806
Train Epoch: [6]  [1150/2244]  eta: 0:30:08  lr: 0.000725  loss_ita: 0.0004  lr_temp_net: 0.00001594  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5501  data: 0.1894  max mem: 34806
Train Epoch: [6]  [1200/2244]  eta: 0:28:39  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4921  data: 0.1454  max mem: 34806
Train Epoch: [6]  [1250/2244]  eta: 0:27:10  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4709  data: 0.0993  max mem: 34806
Train Epoch: [6]  [1300/2244]  eta: 0:25:44  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5707  data: 0.3149  max mem: 34806
Train Epoch: [6]  [1350/2244]  eta: 0:24:22  lr: 0.000725  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5456  data: 0.1871  max mem: 34806
Train Epoch: [6]  [1400/2244]  eta: 0:22:57  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5627  data: 0.1819  max mem: 34806
Train Epoch: [6]  [1450/2244]  eta: 0:21:34  lr: 0.000725  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5857  data: 0.2219  max mem: 34806
Train Epoch: [6]  [1500/2244]  eta: 0:20:09  lr: 0.000725  loss_ita: 0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4523  data: 0.1932  max mem: 34806
Train Epoch: [6]  [1550/2244]  eta: 0:18:44  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4891  data: 0.2243  max mem: 34806
Train Epoch: [6]  [1600/2244]  eta: 0:17:22  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4890  data: 0.2511  max mem: 34806
Train Epoch: [6]  [1650/2244]  eta: 0:15:59  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4551  data: 0.1940  max mem: 34806
Train Epoch: [6]  [1700/2244]  eta: 0:14:36  lr: 0.000725  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4479  data: 0.0606  max mem: 34806
Train Epoch: [6]  [1750/2244]  eta: 0:13:14  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5546  data: 0.0982  max mem: 34806
Train Epoch: [6]  [1800/2244]  eta: 0:11:53  lr: 0.000725  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5429  data: 0.2623  max mem: 34806
Train Epoch: [6]  [1850/2244]  eta: 0:10:32  lr: 0.000725  loss_ita: -0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5944  data: 0.1625  max mem: 34806
Train Epoch: [6]  [1900/2244]  eta: 0:09:12  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6475  data: 0.0307  max mem: 34806
Train Epoch: [6]  [1950/2244]  eta: 0:07:51  lr: 0.000725  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6020  data: 0.0316  max mem: 34806
Train Epoch: [6]  [2000/2244]  eta: 0:06:31  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5778  data: 0.0344  max mem: 34806
Train Epoch: [6]  [2050/2244]  eta: 0:05:11  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5734  data: 0.0324  max mem: 34806
Train Epoch: [6]  [2100/2244]  eta: 0:03:51  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7134  data: 0.2673  max mem: 34806
Train Epoch: [6]  [2150/2244]  eta: 0:02:31  lr: 0.000725  loss_ita: -0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5895  data: 0.1578  max mem: 34806
Train Epoch: [6]  [2200/2244]  eta: 0:01:10  lr: 0.000725  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6587  data: 0.1678  max mem: 34806
Train Epoch: [6]  [2243/2244]  eta: 0:00:01  lr: 0.000725  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7979  data: 0.0305  max mem: 34806
Train Epoch: [6] Total time: 1:00:14 (1.6108 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:52
Computing features for evaluation...
Evaluation time 0:00:46
Computing features for evaluation...
Evaluation time 0:00:18
Computing features for evaluation...
Evaluation time 0:00:17
coco val: {'txt_r1': 33.3, 'txt_r5': 57.9, 'txt_r10': 68.66, 'txt_r_mean': 53.28666666666666, 'img_r1': 19.16033586565374, 'img_r5': 42.139144342263094, 'img_r10': 53.99440223910436, 'img_r_mean': 38.431294149007066, 'r_mean': 45.85898040783687}
coco test: {'txt_r1': 31.3, 'txt_r5': 57.2, 'txt_r10': 68.26, 'txt_r_mean': 52.25333333333333, 'img_r1': 19.31627349060376, 'img_r5': 41.551379448220715, 'img_r10': 53.37864854058377, 'img_r_mean': 38.08210049313608, 'r_mean': 45.167716913234706}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [7]  [   0/2244]  eta: 6:56:11  lr: 0.000699  loss_ita: 0.0010  lr_temp_net: 0.00001435  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 11.1281  data: 5.2928  max mem: 34806
Train Epoch: [7]  [  50/2244]  eta: 1:06:32  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6160  data: 0.0388  max mem: 34806
Train Epoch: [7]  [ 100/2244]  eta: 1:02:03  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7001  data: 0.0316  max mem: 34806
Train Epoch: [7]  [ 150/2244]  eta: 1:00:20  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6791  data: 0.0397  max mem: 34806
Train Epoch: [7]  [ 200/2244]  eta: 0:58:51  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7869  data: 0.0333  max mem: 34806
Train Epoch: [7]  [ 250/2244]  eta: 0:59:12  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.2722  data: 0.0443  max mem: 34806
Train Epoch: [7]  [ 300/2244]  eta: 0:57:18  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7704  data: 0.0327  max mem: 34806
Train Epoch: [7]  [ 350/2244]  eta: 0:55:25  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6050  data: 0.0374  max mem: 34806
Train Epoch: [7]  [ 400/2244]  eta: 0:53:18  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5869  data: 0.0301  max mem: 34806
Train Epoch: [7]  [ 450/2244]  eta: 0:51:35  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6571  data: 0.0350  max mem: 34806
Train Epoch: [7]  [ 500/2244]  eta: 0:49:52  lr: 0.000699  loss_ita: 0.0004  lr_temp_net: 0.00001435  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6255  data: 0.0321  max mem: 34806
Train Epoch: [7]  [ 550/2244]  eta: 0:48:17  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6131  data: 0.0340  max mem: 34806
Train Epoch: [7]  [ 600/2244]  eta: 0:46:50  lr: 0.000699  loss_ita: -0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7370  data: 0.0359  max mem: 34806
Train Epoch: [7]  [ 650/2244]  eta: 0:45:20  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6264  data: 0.0305  max mem: 34806
Train Epoch: [7]  [ 700/2244]  eta: 0:43:55  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7564  data: 0.0357  max mem: 34806
Train Epoch: [7]  [ 750/2244]  eta: 0:42:25  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6949  data: 0.0344  max mem: 34806
Train Epoch: [7]  [ 800/2244]  eta: 0:41:01  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7174  data: 0.0317  max mem: 34806
Train Epoch: [7]  [ 850/2244]  eta: 0:39:36  lr: 0.000699  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6788  data: 0.0294  max mem: 34806
Train Epoch: [7]  [ 900/2244]  eta: 0:38:05  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6109  data: 0.0331  max mem: 34806
Train Epoch: [7]  [ 950/2244]  eta: 0:36:39  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7345  data: 0.0377  max mem: 34806
Train Epoch: [7]  [1000/2244]  eta: 0:35:09  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6255  data: 0.0332  max mem: 34806
Train Epoch: [7]  [1050/2244]  eta: 0:33:47  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8587  data: 0.0824  max mem: 34806
Train Epoch: [7]  [1100/2244]  eta: 0:32:15  lr: 0.000699  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5673  data: 0.0357  max mem: 34806
Train Epoch: [7]  [1150/2244]  eta: 0:30:49  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6536  data: 0.0277  max mem: 34806
Train Epoch: [7]  [1200/2244]  eta: 0:29:21  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6406  data: 0.0216  max mem: 34806
Train Epoch: [7]  [1250/2244]  eta: 0:27:54  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5972  data: 0.0297  max mem: 34806
Train Epoch: [7]  [1300/2244]  eta: 0:26:30  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7013  data: 0.0292  max mem: 34806
Train Epoch: [7]  [1350/2244]  eta: 0:25:07  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7626  data: 0.0316  max mem: 34806
Train Epoch: [7]  [1400/2244]  eta: 0:23:42  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5701  data: 0.0277  max mem: 34806
Train Epoch: [7]  [1450/2244]  eta: 0:22:16  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6210  data: 0.0375  max mem: 34806
Train Epoch: [7]  [1500/2244]  eta: 0:20:51  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6826  data: 0.0333  max mem: 34806
Train Epoch: [7]  [1550/2244]  eta: 0:19:26  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6353  data: 0.0358  max mem: 34806
Train Epoch: [7]  [1600/2244]  eta: 0:18:02  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6919  data: 0.0282  max mem: 34806
Train Epoch: [7]  [1650/2244]  eta: 0:16:38  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7266  data: 0.0303  max mem: 34806
Train Epoch: [7]  [1700/2244]  eta: 0:15:13  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6044  data: 0.0344  max mem: 34806
Train Epoch: [7]  [1750/2244]  eta: 0:13:48  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6436  data: 0.0338  max mem: 34806
Train Epoch: [7]  [1800/2244]  eta: 0:12:24  lr: 0.000699  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6637  data: 0.0267  max mem: 34806
Train Epoch: [7]  [1850/2244]  eta: 0:10:59  lr: 0.000699  loss_ita: 0.0004  lr_temp_net: 0.00001435  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6261  data: 0.0201  max mem: 34806
Train Epoch: [7]  [1900/2244]  eta: 0:09:35  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5726  data: 0.0296  max mem: 34806
Train Epoch: [7]  [1950/2244]  eta: 0:08:11  lr: 0.000699  loss_ita: -0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6882  data: 0.0357  max mem: 34806
Train Epoch: [7]  [2000/2244]  eta: 0:06:48  lr: 0.000699  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6485  data: 0.0355  max mem: 34806
Train Epoch: [7]  [2050/2244]  eta: 0:05:24  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5800  data: 0.0324  max mem: 34806
Train Epoch: [7]  [2100/2244]  eta: 0:04:00  lr: 0.000699  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6779  data: 0.0345  max mem: 34806
Train Epoch: [7]  [2150/2244]  eta: 0:02:36  lr: 0.000699  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5855  data: 0.0303  max mem: 34806
Train Epoch: [7]  [2200/2244]  eta: 0:01:13  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6708  data: 0.0364  max mem: 34806
Train Epoch: [7]  [2243/2244]  eta: 0:00:01  lr: 0.000699  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7399  data: 0.0454  max mem: 34806
Train Epoch: [7] Total time: 1:02:30 (1.6715 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:55
Computing features for evaluation...
Evaluation time 0:00:44
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:15
coco val: {'txt_r1': 33.48, 'txt_r5': 60.26, 'txt_r10': 70.88, 'txt_r_mean': 54.873333333333335, 'img_r1': 20.24390243902439, 'img_r5': 43.81447421031587, 'img_r10': 56.05757696921231, 'img_r_mean': 40.03865120618419, 'r_mean': 47.45599226975877}
coco test: {'txt_r1': 33.62, 'txt_r5': 59.22, 'txt_r10': 69.94, 'txt_r_mean': 54.26, 'img_r1': 20.475809676129547, 'img_r5': 43.65853658536585, 'img_r10': 55.95761695321871, 'img_r_mean': 40.0306544049047, 'r_mean': 47.14532720245235}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [8]  [   0/2244]  eta: 5:35:05  lr: 0.000669  loss_ita: 0.0009  lr_temp_net: 0.00001291  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 8.9598  data: 5.4568  max mem: 34806
Train Epoch: [8]  [  50/2244]  eta: 1:04:35  lr: 0.000669  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6735  data: 0.2097  max mem: 34806
Train Epoch: [8]  [ 100/2244]  eta: 1:01:19  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6464  data: 0.0173  max mem: 34806
Train Epoch: [8]  [ 150/2244]  eta: 0:59:23  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7043  data: 0.2290  max mem: 34806
Train Epoch: [8]  [ 200/2244]  eta: 0:57:27  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5501  data: 0.0566  max mem: 34806
Train Epoch: [8]  [ 250/2244]  eta: 0:56:11  lr: 0.000669  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7279  data: 0.0355  max mem: 34806
Train Epoch: [8]  [ 300/2244]  eta: 0:54:26  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5996  data: 0.0304  max mem: 34806
Train Epoch: [8]  [ 350/2244]  eta: 0:52:45  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6163  data: 0.0390  max mem: 34806
Train Epoch: [8]  [ 400/2244]  eta: 0:51:08  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5996  data: 0.0229  max mem: 34806
Train Epoch: [8]  [ 450/2244]  eta: 0:49:45  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6994  data: 0.0344  max mem: 34806
Train Epoch: [8]  [ 500/2244]  eta: 0:48:21  lr: 0.000669  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6833  data: 0.0315  max mem: 34806
Train Epoch: [8]  [ 550/2244]  eta: 0:46:54  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6341  data: 0.0311  max mem: 34806
Train Epoch: [8]  [ 600/2244]  eta: 0:45:28  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5802  data: 0.0335  max mem: 34806
Train Epoch: [8]  [ 650/2244]  eta: 0:48:32  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5342  data: 0.0541  max mem: 34806
Train Epoch: [8]  [ 700/2244]  eta: 0:46:39  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6082  data: 0.2078  max mem: 34806
Train Epoch: [8]  [ 750/2244]  eta: 0:44:51  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6375  data: 0.1851  max mem: 34806
Train Epoch: [8]  [ 800/2244]  eta: 0:43:05  lr: 0.000669  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6080  data: 0.2027  max mem: 34806
Train Epoch: [8]  [ 850/2244]  eta: 0:41:21  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6284  data: 0.1158  max mem: 34806
Train Epoch: [8]  [ 900/2244]  eta: 0:39:40  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6260  data: 0.2179  max mem: 34806
Train Epoch: [8]  [ 950/2244]  eta: 0:38:00  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5830  data: 0.1939  max mem: 34806
Train Epoch: [8]  [1000/2244]  eta: 0:36:22  lr: 0.000669  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5986  data: 0.1496  max mem: 34806
Train Epoch: [8]  [1050/2244]  eta: 0:34:46  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6322  data: 0.2269  max mem: 34806
Train Epoch: [8]  [1100/2244]  eta: 0:33:14  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6414  data: 0.0358  max mem: 34806
Train Epoch: [8]  [1150/2244]  eta: 0:31:43  lr: 0.000669  loss_ita: -0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6125  data: 0.0403  max mem: 34806
Train Epoch: [8]  [1200/2244]  eta: 0:30:10  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6067  data: 0.0303  max mem: 34806
Train Epoch: [8]  [1250/2244]  eta: 0:28:41  lr: 0.000669  loss_ita: -0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6945  data: 0.0406  max mem: 34806
Train Epoch: [8]  [1300/2244]  eta: 0:27:11  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5963  data: 0.0321  max mem: 34806
Train Epoch: [8]  [1350/2244]  eta: 0:25:42  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6012  data: 0.0333  max mem: 34806
Train Epoch: [8]  [1400/2244]  eta: 0:24:13  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5638  data: 0.0335  max mem: 34806
Train Epoch: [8]  [1450/2244]  eta: 0:22:47  lr: 0.000669  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7362  data: 0.0381  max mem: 34806
Train Epoch: [8]  [1500/2244]  eta: 0:21:17  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6030  data: 0.0340  max mem: 34806
Train Epoch: [8]  [1550/2244]  eta: 0:19:50  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6733  data: 0.0411  max mem: 34806
Train Epoch: [8]  [1600/2244]  eta: 0:18:23  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6362  data: 0.0306  max mem: 34806
Train Epoch: [8]  [1650/2244]  eta: 0:16:56  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5477  data: 0.0333  max mem: 34806
Train Epoch: [8]  [1700/2244]  eta: 0:15:29  lr: 0.000669  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6179  data: 0.0323  max mem: 34806
Train Epoch: [8]  [1750/2244]  eta: 0:14:04  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7610  data: 0.0275  max mem: 34806
Train Epoch: [8]  [1800/2244]  eta: 0:12:38  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6325  data: 0.0519  max mem: 34806
Train Epoch: [8]  [1850/2244]  eta: 0:11:12  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6615  data: 0.0335  max mem: 34806
Train Epoch: [8]  [1900/2244]  eta: 0:09:46  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6913  data: 0.0310  max mem: 34806
Train Epoch: [8]  [1950/2244]  eta: 0:08:20  lr: 0.000669  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6144  data: 0.0349  max mem: 34806
Train Epoch: [8]  [2000/2244]  eta: 0:06:55  lr: 0.000669  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6885  data: 0.0422  max mem: 34806
Train Epoch: [8]  [2050/2244]  eta: 0:05:29  lr: 0.000669  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7019  data: 0.0299  max mem: 34806
Train Epoch: [8]  [2100/2244]  eta: 0:04:05  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6470  data: 0.0284  max mem: 34806
Train Epoch: [8]  [2150/2244]  eta: 0:02:39  lr: 0.000669  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6710  data: 0.0322  max mem: 34806
Train Epoch: [8]  [2200/2244]  eta: 0:01:14  lr: 0.000669  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5997  data: 0.1761  max mem: 34806
Train Epoch: [8]  [2243/2244]  eta: 0:00:01  lr: 0.000669  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7137  data: 0.0342  max mem: 34806
Train Epoch: [8] Total time: 1:03:32 (1.6990 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:55
Computing features for evaluation...
Evaluation time 0:00:49
Computing features for evaluation...
Evaluation time 0:00:19
Computing features for evaluation...
Evaluation time 0:00:16
coco val: {'txt_r1': 33.68, 'txt_r5': 59.18, 'txt_r10': 70.4, 'txt_r_mean': 54.419999999999995, 'img_r1': 20.955617752898842, 'img_r5': 44.234306277489004, 'img_r10': 56.565373850459814, 'img_r_mean': 40.58509929361588, 'r_mean': 47.502549646807935}
coco test: {'txt_r1': 33.5, 'txt_r5': 58.96, 'txt_r10': 69.9, 'txt_r_mean': 54.120000000000005, 'img_r1': 20.715713714514195, 'img_r5': 44.1703318672531, 'img_r10': 56.25349860055977, 'img_r_mean': 40.379848060775686, 'r_mean': 47.249924030387845}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [9]  [   0/2244]  eta: 8:02:27  lr: 0.000637  loss_ita: 0.0006  lr_temp_net: 0.00001162  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 12.8998  data: 6.7363  max mem: 34806
Train Epoch: [9]  [  50/2244]  eta: 2:02:38  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.5697  data: 0.0390  max mem: 34806
Train Epoch: [9]  [ 100/2244]  eta: 1:29:02  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6312  data: 0.0336  max mem: 34806
Train Epoch: [9]  [ 150/2244]  eta: 1:16:48  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5682  data: 0.0346  max mem: 34806
Train Epoch: [9]  [ 200/2244]  eta: 1:10:23  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6831  data: 0.0296  max mem: 34806
Train Epoch: [9]  [ 250/2244]  eta: 1:05:45  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7136  data: 0.0368  max mem: 34806
Train Epoch: [9]  [ 300/2244]  eta: 1:02:22  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6237  data: 0.0313  max mem: 34806
Train Epoch: [9]  [ 350/2244]  eta: 0:59:12  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5728  data: 0.0326  max mem: 34806
Train Epoch: [9]  [ 400/2244]  eta: 0:56:42  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6424  data: 0.0315  max mem: 34806
Train Epoch: [9]  [ 450/2244]  eta: 0:54:19  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5865  data: 0.0266  max mem: 34806
Train Epoch: [9]  [ 500/2244]  eta: 0:52:08  lr: 0.000637  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5862  data: 0.0256  max mem: 34806
Train Epoch: [9]  [ 550/2244]  eta: 0:50:04  lr: 0.000637  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5280  data: 0.0294  max mem: 34806
Train Epoch: [9]  [ 600/2244]  eta: 0:48:10  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5965  data: 0.0279  max mem: 34806
Train Epoch: [9]  [ 650/2244]  eta: 0:46:33  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7249  data: 0.0336  max mem: 34806
Train Epoch: [9]  [ 700/2244]  eta: 0:44:49  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6472  data: 0.0306  max mem: 34806
Train Epoch: [9]  [ 750/2244]  eta: 0:43:09  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6507  data: 0.0315  max mem: 34806
Train Epoch: [9]  [ 800/2244]  eta: 0:41:36  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7147  data: 0.0392  max mem: 34806
Train Epoch: [9]  [ 850/2244]  eta: 0:39:53  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5275  data: 0.0311  max mem: 34806
Train Epoch: [9]  [ 900/2244]  eta: 0:38:20  lr: 0.000637  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6028  data: 0.1852  max mem: 34806
Train Epoch: [9]  [ 950/2244]  eta: 0:36:47  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5699  data: 0.1987  max mem: 34806
Train Epoch: [9]  [1000/2244]  eta: 0:35:14  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5952  data: 0.0262  max mem: 34806
Train Epoch: [9]  [1050/2244]  eta: 0:34:32  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4967  data: 0.0307  max mem: 34806
Train Epoch: [9]  [1100/2244]  eta: 0:32:58  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6141  data: 0.0271  max mem: 34806
Train Epoch: [9]  [1150/2244]  eta: 0:31:28  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6725  data: 0.0328  max mem: 34806
Train Epoch: [9]  [1200/2244]  eta: 0:30:01  lr: 0.000637  loss_ita: -0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.8284  data: 0.0350  max mem: 34806
Train Epoch: [9]  [1250/2244]  eta: 0:28:28  lr: 0.000637  loss_ita: -0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6145  data: 0.0254  max mem: 34806
Train Epoch: [9]  [1300/2244]  eta: 0:26:59  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5589  data: 0.0466  max mem: 34806
Train Epoch: [9]  [1350/2244]  eta: 0:25:28  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5525  data: 0.0232  max mem: 34806
Train Epoch: [9]  [1400/2244]  eta: 0:23:58  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6142  data: 0.0641  max mem: 34806
Train Epoch: [9]  [1450/2244]  eta: 0:22:31  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6245  data: 0.0298  max mem: 34806
Train Epoch: [9]  [1500/2244]  eta: 0:21:04  lr: 0.000637  loss_ita: -0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5685  data: 0.0328  max mem: 34806
Train Epoch: [9]  [1550/2244]  eta: 0:19:38  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6601  data: 0.0315  max mem: 34806
Train Epoch: [9]  [1600/2244]  eta: 0:18:12  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6296  data: 0.0309  max mem: 34806
Train Epoch: [9]  [1650/2244]  eta: 0:16:45  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5348  data: 0.0258  max mem: 34806
Train Epoch: [9]  [1700/2244]  eta: 0:15:19  lr: 0.000637  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5865  data: 0.0234  max mem: 34806
Train Epoch: [9]  [1750/2244]  eta: 0:13:53  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6183  data: 0.0342  max mem: 34806
Train Epoch: [9]  [1800/2244]  eta: 0:12:28  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6054  data: 0.0360  max mem: 34806
Train Epoch: [9]  [1850/2244]  eta: 0:11:02  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5509  data: 0.0269  max mem: 34806
Train Epoch: [9]  [1900/2244]  eta: 0:09:37  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6127  data: 0.0313  max mem: 34806
Train Epoch: [9]  [1950/2244]  eta: 0:08:13  lr: 0.000637  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5887  data: 0.0516  max mem: 34806
Train Epoch: [9]  [2000/2244]  eta: 0:06:51  lr: 0.000637  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.0207  data: 0.0498  max mem: 34806
Train Epoch: [9]  [2050/2244]  eta: 0:05:26  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5588  data: 0.0440  max mem: 34806
Train Epoch: [9]  [2100/2244]  eta: 0:04:02  lr: 0.000637  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6940  data: 0.0312  max mem: 34806
Train Epoch: [9]  [2150/2244]  eta: 0:02:38  lr: 0.000637  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5906  data: 0.0312  max mem: 34806
Train Epoch: [9]  [2200/2244]  eta: 0:01:13  lr: 0.000637  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5722  data: 0.0334  max mem: 34806
Train Epoch: [9]  [2243/2244]  eta: 0:00:01  lr: 0.000637  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7246  data: 0.0285  max mem: 34806
Train Epoch: [9] Total time: 1:02:49 (1.6798 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:51
Computing features for evaluation...
Evaluation time 0:00:46
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:16
coco val: {'txt_r1': 36.8, 'txt_r5': 62.68, 'txt_r10': 73.42, 'txt_r_mean': 57.633333333333326, 'img_r1': 21.639344262295083, 'img_r5': 45.98160735705718, 'img_r10': 58.188724510195925, 'img_r_mean': 41.9365587098494, 'r_mean': 49.78494602159137}
coco test: {'txt_r1': 35.94, 'txt_r5': 61.26, 'txt_r10': 72.02, 'txt_r_mean': 56.40666666666666, 'img_r1': 21.93922431027589, 'img_r5': 45.421831267493005, 'img_r10': 57.90483806477409, 'img_r_mean': 41.75529788084766, 'r_mean': 49.08098227375716}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [10]  [   0/2244]  eta: 5:30:46  lr: 0.000603  loss_ita: 0.0007  lr_temp_net: 0.00001046  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 8.8444  data: 5.4056  max mem: 34806
Train Epoch: [10]  [  50/2244]  eta: 1:03:53  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6490  data: 0.0304  max mem: 34806
Train Epoch: [10]  [ 100/2244]  eta: 1:00:40  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6842  data: 0.0321  max mem: 34806
Train Epoch: [10]  [ 150/2244]  eta: 0:56:51  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4324  data: 0.0210  max mem: 34806
Train Epoch: [10]  [ 200/2244]  eta: 0:54:30  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5065  data: 0.0286  max mem: 34806
Train Epoch: [10]  [ 250/2244]  eta: 0:53:23  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6072  data: 0.0258  max mem: 34806
Train Epoch: [10]  [ 300/2244]  eta: 0:51:36  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5562  data: 0.0297  max mem: 34806
Train Epoch: [10]  [ 350/2244]  eta: 0:50:17  lr: 0.000603  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5920  data: 0.0277  max mem: 34806
Train Epoch: [10]  [ 400/2244]  eta: 0:48:43  lr: 0.000603  loss_ita: -0.0003  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5248  data: 0.0345  max mem: 34806
Train Epoch: [10]  [ 450/2244]  eta: 0:47:27  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6521  data: 0.0304  max mem: 34806
Train Epoch: [10]  [ 500/2244]  eta: 0:46:09  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5186  data: 0.0216  max mem: 34806
Train Epoch: [10]  [ 550/2244]  eta: 0:44:42  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5382  data: 0.1426  max mem: 34806
Train Epoch: [10]  [ 600/2244]  eta: 0:43:10  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5251  data: 0.2232  max mem: 34806
Train Epoch: [10]  [ 650/2244]  eta: 0:41:48  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5623  data: 0.2672  max mem: 34806
Train Epoch: [10]  [ 700/2244]  eta: 0:40:24  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5125  data: 0.2129  max mem: 34806
Train Epoch: [10]  [ 750/2244]  eta: 0:38:58  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5208  data: 0.2279  max mem: 34806
Train Epoch: [10]  [ 800/2244]  eta: 0:37:41  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5412  data: 0.1911  max mem: 34806
Train Epoch: [10]  [ 850/2244]  eta: 0:36:21  lr: 0.000603  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5470  data: 0.1987  max mem: 34806
Train Epoch: [10]  [ 900/2244]  eta: 0:34:59  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5138  data: 0.1973  max mem: 34806
Train Epoch: [10]  [ 950/2244]  eta: 0:33:39  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5156  data: 0.0223  max mem: 34806
Train Epoch: [10]  [1000/2244]  eta: 0:32:19  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5073  data: 0.0286  max mem: 34806
Train Epoch: [10]  [1050/2244]  eta: 0:31:00  lr: 0.000603  loss_ita: 0.0005  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5583  data: 0.0267  max mem: 34806
Train Epoch: [10]  [1100/2244]  eta: 0:29:39  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4661  data: 0.0364  max mem: 34806
Train Epoch: [10]  [1150/2244]  eta: 0:28:20  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5729  data: 0.0155  max mem: 34806
Train Epoch: [10]  [1200/2244]  eta: 0:27:00  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5525  data: 0.0235  max mem: 34806
Train Epoch: [10]  [1250/2244]  eta: 0:25:42  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6067  data: 0.0304  max mem: 34806
Train Epoch: [10]  [1300/2244]  eta: 0:24:25  lr: 0.000603  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5811  data: 0.0249  max mem: 34806
Train Epoch: [10]  [1350/2244]  eta: 0:23:10  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5912  data: 0.0259  max mem: 34806
Train Epoch: [10]  [1400/2244]  eta: 0:21:52  lr: 0.000603  loss_ita: 0.0004  lr_temp_net: 0.00001046  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5729  data: 0.0273  max mem: 34806
Train Epoch: [10]  [1450/2244]  eta: 0:20:35  lr: 0.000603  loss_ita: 0.0004  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4841  data: 0.0241  max mem: 34806
Train Epoch: [10]  [1500/2244]  eta: 0:19:15  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4037  data: 0.0242  max mem: 34806
Train Epoch: [10]  [1550/2244]  eta: 0:17:56  lr: 0.000603  loss_ita: 0.0003  lr_temp_net: 0.00001046  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4827  data: 0.0203  max mem: 34806
Train Epoch: [10]  [1600/2244]  eta: 0:16:38  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5537  data: 0.0229  max mem: 34806
Train Epoch: [10]  [1650/2244]  eta: 0:15:21  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5619  data: 0.1534  max mem: 34806
Train Epoch: [10]  [1700/2244]  eta: 0:14:03  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5357  data: 0.0203  max mem: 34806
Train Epoch: [10]  [1750/2244]  eta: 0:12:45  lr: 0.000603  loss_ita: -0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4909  data: 0.0188  max mem: 34806
Train Epoch: [10]  [1800/2244]  eta: 0:11:27  lr: 0.000603  loss_ita: 0.0003  lr_temp_net: 0.00001046  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5459  data: 0.0227  max mem: 34806
Train Epoch: [10]  [1850/2244]  eta: 0:10:09  lr: 0.000603  loss_ita: -0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5299  data: 0.0268  max mem: 34806
Train Epoch: [10]  [1900/2244]  eta: 0:08:52  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5274  data: 0.0256  max mem: 34806
Train Epoch: [10]  [1950/2244]  eta: 0:07:34  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5202  data: 0.0261  max mem: 34806
Train Epoch: [10]  [2000/2244]  eta: 0:06:16  lr: 0.000603  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5142  data: 0.0181  max mem: 34806
Train Epoch: [10]  [2050/2244]  eta: 0:04:59  lr: 0.000603  loss_ita: -0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5217  data: 0.2356  max mem: 34806
Train Epoch: [10]  [2100/2244]  eta: 0:03:42  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5184  data: 0.2759  max mem: 34806
Train Epoch: [10]  [2150/2244]  eta: 0:02:25  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5536  data: 0.2387  max mem: 34806
Train Epoch: [10]  [2200/2244]  eta: 0:01:07  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6032  data: 0.2446  max mem: 34806
Train Epoch: [10]  [2243/2244]  eta: 0:00:01  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6351  data: 0.0670  max mem: 34806
Train Epoch: [10] Total time: 0:57:49 (1.5462 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:50
Computing features for evaluation...
Evaluation time 0:00:43
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 35.78, 'txt_r5': 61.44, 'txt_r10': 72.28, 'txt_r_mean': 56.5, 'img_r1': 21.823270691723312, 'img_r5': 45.99760095961615, 'img_r10': 58.05277888844462, 'img_r_mean': 41.95788351326136, 'r_mean': 49.228941756630675}
coco test: {'txt_r1': 34.92, 'txt_r5': 61.34, 'txt_r10': 71.9, 'txt_r_mean': 56.05333333333334, 'img_r1': 21.583366653338665, 'img_r5': 45.87764894042383, 'img_r10': 57.9968012794882, 'img_r_mean': 41.819272291083564, 'r_mean': 48.93630281220845}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [11]  [   0/2244]  eta: 3:39:15  lr: 0.000566  loss_ita: 0.0004  lr_temp_net: 0.00000941  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.8625  data: 4.0521  max mem: 34806
Train Epoch: [11]  [  50/2244]  eta: 1:00:44  lr: 0.000566  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5283  data: 0.0231  max mem: 34806
Train Epoch: [11]  [ 100/2244]  eta: 0:56:58  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4769  data: 0.0213  max mem: 34806
Train Epoch: [11]  [ 150/2244]  eta: 0:54:47  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5493  data: 0.0302  max mem: 34806
Train Epoch: [11]  [ 200/2244]  eta: 0:53:09  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5162  data: 0.0290  max mem: 34806
Train Epoch: [11]  [ 250/2244]  eta: 0:51:34  lr: 0.000566  loss_ita: -0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4738  data: 0.0340  max mem: 34806
Train Epoch: [11]  [ 300/2244]  eta: 0:50:14  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5220  data: 0.0288  max mem: 34806
Train Epoch: [11]  [ 350/2244]  eta: 0:48:57  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5397  data: 0.0288  max mem: 34806
Train Epoch: [11]  [ 400/2244]  eta: 0:47:42  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5876  data: 0.0272  max mem: 34806
Train Epoch: [11]  [ 450/2244]  eta: 0:46:24  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5105  data: 0.0296  max mem: 34806
Train Epoch: [11]  [ 500/2244]  eta: 0:45:03  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5316  data: 0.0258  max mem: 34806
Train Epoch: [11]  [ 550/2244]  eta: 0:43:44  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5273  data: 0.0263  max mem: 34806
Train Epoch: [11]  [ 600/2244]  eta: 0:42:29  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5371  data: 0.0276  max mem: 34806
Train Epoch: [11]  [ 650/2244]  eta: 0:41:09  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5270  data: 0.0257  max mem: 34806
Train Epoch: [11]  [ 700/2244]  eta: 0:39:48  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5293  data: 0.0260  max mem: 34806
Train Epoch: [11]  [ 750/2244]  eta: 0:38:27  lr: 0.000566  loss_ita: -0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5002  data: 0.0269  max mem: 34806
Train Epoch: [11]  [ 800/2244]  eta: 0:37:13  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6349  data: 0.0264  max mem: 34806
Train Epoch: [11]  [ 850/2244]  eta: 0:35:54  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5731  data: 0.0235  max mem: 34806
Train Epoch: [11]  [ 900/2244]  eta: 0:34:36  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4948  data: 0.2088  max mem: 34806
Train Epoch: [11]  [ 950/2244]  eta: 0:33:19  lr: 0.000566  loss_ita: -0.0004  lr_temp_net: 0.00000941  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5697  data: 0.0429  max mem: 34806
Train Epoch: [11]  [1000/2244]  eta: 0:32:01  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4970  data: 0.0267  max mem: 34806
Train Epoch: [11]  [1050/2244]  eta: 0:30:41  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5765  data: 0.1728  max mem: 34806
Train Epoch: [11]  [1100/2244]  eta: 0:29:24  lr: 0.000566  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5133  data: 0.1799  max mem: 34806
Train Epoch: [11]  [1150/2244]  eta: 0:28:05  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4838  data: 0.1302  max mem: 34806
Train Epoch: [11]  [1200/2244]  eta: 0:26:48  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5518  data: 0.0853  max mem: 34806
Train Epoch: [11]  [1250/2244]  eta: 0:25:31  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4932  data: 0.0259  max mem: 34806
Train Epoch: [11]  [1300/2244]  eta: 0:24:13  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5019  data: 0.0269  max mem: 34806
Train Epoch: [11]  [1350/2244]  eta: 0:22:55  lr: 0.000566  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5277  data: 0.0283  max mem: 34806
Train Epoch: [11]  [1400/2244]  eta: 0:21:38  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4770  data: 0.0256  max mem: 34806
Train Epoch: [11]  [1450/2244]  eta: 0:20:22  lr: 0.000566  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5610  data: 0.0274  max mem: 34806
Train Epoch: [11]  [1500/2244]  eta: 0:19:06  lr: 0.000566  loss_ita: 0.0004  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5700  data: 0.0275  max mem: 34806
Train Epoch: [11]  [1550/2244]  eta: 0:17:49  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6060  data: 0.0244  max mem: 34806
Train Epoch: [11]  [1600/2244]  eta: 0:16:33  lr: 0.000566  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5642  data: 0.0304  max mem: 34806
Train Epoch: [11]  [1650/2244]  eta: 0:15:16  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5297  data: 0.0251  max mem: 34806
Train Epoch: [11]  [1700/2244]  eta: 0:13:59  lr: 0.000566  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4749  data: 0.0280  max mem: 34806
Train Epoch: [11]  [1750/2244]  eta: 0:12:41  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5140  data: 0.0268  max mem: 34806
Train Epoch: [11]  [1800/2244]  eta: 0:11:24  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6018  data: 0.0241  max mem: 34806
Train Epoch: [11]  [1850/2244]  eta: 0:10:07  lr: 0.000566  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5160  data: 0.0247  max mem: 34806
Train Epoch: [11]  [1900/2244]  eta: 0:08:50  lr: 0.000566  loss_ita: -0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5376  data: 0.0276  max mem: 34806
Train Epoch: [11]  [1950/2244]  eta: 0:07:33  lr: 0.000566  loss_ita: -0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5490  data: 0.0259  max mem: 34806
Train Epoch: [11]  [2000/2244]  eta: 0:06:16  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5229  data: 0.0242  max mem: 34806
Train Epoch: [11]  [2050/2244]  eta: 0:04:58  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5054  data: 0.0314  max mem: 34806
Train Epoch: [11]  [2100/2244]  eta: 0:03:41  lr: 0.000566  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5019  data: 0.0427  max mem: 34806
Train Epoch: [11]  [2150/2244]  eta: 0:02:24  lr: 0.000566  loss_ita: 0.0005  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4687  data: 0.0271  max mem: 34806
Train Epoch: [11]  [2200/2244]  eta: 0:01:07  lr: 0.000566  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5366  data: 0.0251  max mem: 34806
Train Epoch: [11]  [2243/2244]  eta: 0:00:01  lr: 0.000566  loss_ita: -0.0004  lr_temp_net: 0.00000941  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5745  data: 0.0330  max mem: 34806
Train Epoch: [11] Total time: 0:57:36 (1.5402 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:48
Computing features for evaluation...
Evaluation time 0:00:41
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:15
coco val: {'txt_r1': 37.78, 'txt_r5': 63.7, 'txt_r10': 73.62, 'txt_r_mean': 58.366666666666674, 'img_r1': 22.52299080367853, 'img_r5': 47.157137145141945, 'img_r10': 59.20431827269093, 'img_r_mean': 42.961482073837125, 'r_mean': 50.664074370251896}
coco test: {'txt_r1': 37.64, 'txt_r5': 62.82, 'txt_r10': 73.76, 'txt_r_mean': 58.073333333333345, 'img_r1': 22.415033986405437, 'img_r5': 46.609356257497, 'img_r10': 58.892443022790886, 'img_r_mean': 42.638944422231106, 'r_mean': 50.35613887778223}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [12]  [   0/2244]  eta: 4:09:05  lr: 0.000527  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 6.6601  data: 4.3340  max mem: 34806
Train Epoch: [12]  [  50/2244]  eta: 1:00:14  lr: 0.000527  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5265  data: 0.0263  max mem: 34806
Train Epoch: [12]  [ 100/2244]  eta: 0:57:07  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5241  data: 0.0251  max mem: 34806
Train Epoch: [12]  [ 150/2244]  eta: 0:54:59  lr: 0.000527  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5488  data: 0.0259  max mem: 34806
Train Epoch: [12]  [ 200/2244]  eta: 0:53:24  lr: 0.000527  loss_ita: -0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5384  data: 0.0272  max mem: 34806
Train Epoch: [12]  [ 250/2244]  eta: 0:52:03  lr: 0.000527  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5437  data: 0.0282  max mem: 34806
Train Epoch: [12]  [ 300/2244]  eta: 0:50:37  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5214  data: 0.0225  max mem: 34806
Train Epoch: [12]  [ 350/2244]  eta: 0:49:15  lr: 0.000527  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5760  data: 0.0251  max mem: 34806
Train Epoch: [12]  [ 400/2244]  eta: 0:47:37  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4880  data: 0.0214  max mem: 34806
Train Epoch: [12]  [ 450/2244]  eta: 0:46:19  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5660  data: 0.0226  max mem: 34806
Train Epoch: [12]  [ 500/2244]  eta: 0:44:52  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4549  data: 0.0223  max mem: 34806
Train Epoch: [12]  [ 550/2244]  eta: 0:43:27  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4949  data: 0.0209  max mem: 34806
Train Epoch: [12]  [ 600/2244]  eta: 0:42:02  lr: 0.000527  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5128  data: 0.0199  max mem: 34806
Train Epoch: [12]  [ 650/2244]  eta: 0:40:41  lr: 0.000527  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4703  data: 0.0197  max mem: 34806
Train Epoch: [12]  [ 700/2244]  eta: 0:39:23  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5085  data: 0.0242  max mem: 34806
Train Epoch: [12]  [ 750/2244]  eta: 0:38:04  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5255  data: 0.0240  max mem: 34806
Train Epoch: [12]  [ 800/2244]  eta: 0:36:42  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4704  data: 0.0225  max mem: 34806
Train Epoch: [12]  [ 850/2244]  eta: 0:35:20  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4521  data: 0.0210  max mem: 34806
Train Epoch: [12]  [ 900/2244]  eta: 0:33:59  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4484  data: 0.1780  max mem: 34806
Train Epoch: [12]  [ 950/2244]  eta: 0:32:42  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4704  data: 0.0191  max mem: 34806
Train Epoch: [12]  [1000/2244]  eta: 0:31:25  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4843  data: 0.0255  max mem: 34806
Train Epoch: [12]  [1050/2244]  eta: 0:30:08  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4955  data: 0.0195  max mem: 34806
Train Epoch: [12]  [1100/2244]  eta: 0:28:50  lr: 0.000527  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4758  data: 0.0233  max mem: 34806
Train Epoch: [12]  [1150/2244]  eta: 0:27:35  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5998  data: 0.0232  max mem: 34806
Train Epoch: [12]  [1200/2244]  eta: 0:26:20  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5645  data: 0.0212  max mem: 34806
Train Epoch: [12]  [1250/2244]  eta: 0:25:05  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6060  data: 0.0378  max mem: 34806
Train Epoch: [12]  [1300/2244]  eta: 0:23:51  lr: 0.000527  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5090  data: 0.0220  max mem: 34806
Train Epoch: [12]  [1350/2244]  eta: 0:22:34  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5024  data: 0.0183  max mem: 34806
Train Epoch: [12]  [1400/2244]  eta: 0:21:17  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4979  data: 0.0233  max mem: 34806
Train Epoch: [12]  [1450/2244]  eta: 0:20:01  lr: 0.000527  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4962  data: 0.0179  max mem: 34806
Train Epoch: [12]  [1500/2244]  eta: 0:18:46  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4906  data: 0.0201  max mem: 34806
Train Epoch: [12]  [1550/2244]  eta: 0:17:30  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5594  data: 0.0221  max mem: 34806
Train Epoch: [12]  [1600/2244]  eta: 0:16:15  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5580  data: 0.0251  max mem: 34806
Train Epoch: [12]  [1650/2244]  eta: 0:15:00  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5757  data: 0.0233  max mem: 34806
Train Epoch: [12]  [1700/2244]  eta: 0:13:44  lr: 0.000527  loss_ita: -0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5310  data: 0.0216  max mem: 34806
Train Epoch: [12]  [1750/2244]  eta: 0:12:28  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4998  data: 0.0277  max mem: 34806
Train Epoch: [12]  [1800/2244]  eta: 0:11:12  lr: 0.000527  loss_ita: -0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5438  data: 0.0576  max mem: 34806
Train Epoch: [12]  [1850/2244]  eta: 0:09:56  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5198  data: 0.2276  max mem: 34806
Train Epoch: [12]  [1900/2244]  eta: 0:08:40  lr: 0.000527  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5295  data: 0.2404  max mem: 34806
Train Epoch: [12]  [1950/2244]  eta: 0:07:25  lr: 0.000527  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4692  data: 0.2055  max mem: 34806
Train Epoch: [12]  [2000/2244]  eta: 0:06:09  lr: 0.000527  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4815  data: 0.2048  max mem: 34806
Train Epoch: [12]  [2050/2244]  eta: 0:04:53  lr: 0.000527  loss_ita: -0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4911  data: 0.0210  max mem: 34806
Train Epoch: [12]  [2100/2244]  eta: 0:03:37  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5347  data: 0.0195  max mem: 34806
Train Epoch: [12]  [2150/2244]  eta: 0:02:21  lr: 0.000527  loss_ita: 0.0005  lr_temp_net: 0.00000847  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4596  data: 0.0196  max mem: 34806
Train Epoch: [12]  [2200/2244]  eta: 0:01:06  lr: 0.000527  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5796  data: 0.0235  max mem: 34806
Train Epoch: [12]  [2243/2244]  eta: 0:00:01  lr: 0.000527  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4818  data: 0.0241  max mem: 34806
Train Epoch: [12] Total time: 0:56:30 (1.5109 s / it)
Averaged stats: lr: 0.0005  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:45
Computing features for evaluation...
Evaluation time 0:00:40
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:13
coco val: {'txt_r1': 39.66, 'txt_r5': 65.08, 'txt_r10': 74.98, 'txt_r_mean': 59.906666666666666, 'img_r1': 23.078768492602958, 'img_r5': 47.72890843662535, 'img_r10': 59.98400639744102, 'img_r_mean': 43.59722777555644, 'r_mean': 51.75194722111155}
coco test: {'txt_r1': 37.76, 'txt_r5': 64.06, 'txt_r10': 74.26, 'txt_r_mean': 58.69333333333333, 'img_r1': 23.00279888044782, 'img_r5': 47.64094362255098, 'img_r10': 59.488204718112755, 'img_r_mean': 43.37731574037051, 'r_mean': 51.03532453685192}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [13]  [   0/2244]  eta: 3:35:39  lr: 0.000487  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.7661  data: 4.0743  max mem: 34806
Train Epoch: [13]  [  50/2244]  eta: 1:00:00  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5959  data: 0.0187  max mem: 34806
Train Epoch: [13]  [ 100/2244]  eta: 0:56:02  lr: 0.000487  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5602  data: 0.0222  max mem: 34806
Train Epoch: [13]  [ 150/2244]  eta: 0:53:43  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4987  data: 0.0248  max mem: 34806
Train Epoch: [13]  [ 200/2244]  eta: 0:52:12  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5107  data: 0.0211  max mem: 34806
Train Epoch: [13]  [ 250/2244]  eta: 0:50:56  lr: 0.000487  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5064  data: 0.0240  max mem: 34806
Train Epoch: [13]  [ 300/2244]  eta: 0:50:18  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4765  data: 0.0222  max mem: 34806
Train Epoch: [13]  [ 350/2244]  eta: 0:48:49  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4688  data: 0.0227  max mem: 34806
Train Epoch: [13]  [ 400/2244]  eta: 0:47:19  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5181  data: 0.0197  max mem: 34806
Train Epoch: [13]  [ 450/2244]  eta: 0:45:50  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4432  data: 0.0203  max mem: 34806
Train Epoch: [13]  [ 500/2244]  eta: 0:44:20  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4478  data: 0.0199  max mem: 34806
Train Epoch: [13]  [ 550/2244]  eta: 0:42:58  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4722  data: 0.0272  max mem: 34806
Train Epoch: [13]  [ 600/2244]  eta: 0:41:34  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4434  data: 0.2249  max mem: 34806
Train Epoch: [13]  [ 650/2244]  eta: 0:40:19  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5907  data: 0.2854  max mem: 34806
Train Epoch: [13]  [ 700/2244]  eta: 0:39:08  lr: 0.000487  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5218  data: 0.2928  max mem: 34806
Train Epoch: [13]  [ 750/2244]  eta: 0:37:52  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4882  data: 0.2628  max mem: 34806
Train Epoch: [13]  [ 800/2244]  eta: 0:36:34  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4994  data: 0.2274  max mem: 34806
Train Epoch: [13]  [ 850/2244]  eta: 0:35:16  lr: 0.000487  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4815  data: 0.2188  max mem: 34806
Train Epoch: [13]  [ 900/2244]  eta: 0:34:02  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5701  data: 0.2339  max mem: 34806
Train Epoch: [13]  [ 950/2244]  eta: 0:32:43  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5056  data: 0.0393  max mem: 34806
Train Epoch: [13]  [1000/2244]  eta: 0:31:33  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7837  data: 0.3509  max mem: 34806
Train Epoch: [13]  [1050/2244]  eta: 0:30:20  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6229  data: 0.0264  max mem: 34806
Train Epoch: [13]  [1100/2244]  eta: 0:29:04  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5684  data: 0.0241  max mem: 34806
Train Epoch: [13]  [1150/2244]  eta: 0:27:46  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4744  data: 0.0230  max mem: 34806
Train Epoch: [13]  [1200/2244]  eta: 0:26:28  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4905  data: 0.0360  max mem: 34806
Train Epoch: [13]  [1250/2244]  eta: 0:25:11  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5529  data: 0.2808  max mem: 34806
Train Epoch: [13]  [1300/2244]  eta: 0:23:55  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5232  data: 0.2384  max mem: 34806
Train Epoch: [13]  [1350/2244]  eta: 0:22:40  lr: 0.000487  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5959  data: 0.2814  max mem: 34806
Train Epoch: [13]  [1400/2244]  eta: 0:21:23  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4614  data: 0.2466  max mem: 34806
Train Epoch: [13]  [1450/2244]  eta: 0:20:07  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4654  data: 0.0898  max mem: 34806
Train Epoch: [13]  [1500/2244]  eta: 0:18:50  lr: 0.000487  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4366  data: 0.0227  max mem: 34806
Train Epoch: [13]  [1550/2244]  eta: 0:17:34  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5602  data: 0.3218  max mem: 34806
Train Epoch: [13]  [1600/2244]  eta: 0:16:17  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5181  data: 0.2694  max mem: 34806
Train Epoch: [13]  [1650/2244]  eta: 0:15:01  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5445  data: 0.2365  max mem: 34806
Train Epoch: [13]  [1700/2244]  eta: 0:13:45  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4813  data: 0.2562  max mem: 34806
Train Epoch: [13]  [1750/2244]  eta: 0:12:28  lr: 0.000487  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4535  data: 0.2557  max mem: 34806
Train Epoch: [13]  [1800/2244]  eta: 0:11:12  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5209  data: 0.3302  max mem: 34806
Train Epoch: [13]  [1850/2244]  eta: 0:09:56  lr: 0.000487  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4909  data: 0.2760  max mem: 34806
Train Epoch: [13]  [1900/2244]  eta: 0:08:40  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4929  data: 0.0196  max mem: 34806
Train Epoch: [13]  [1950/2244]  eta: 0:07:24  lr: 0.000487  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4649  data: 0.0208  max mem: 34806
Train Epoch: [13]  [2000/2244]  eta: 0:06:08  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5394  data: 0.0195  max mem: 34806
Train Epoch: [13]  [2050/2244]  eta: 0:04:53  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5359  data: 0.0259  max mem: 34806
Train Epoch: [13]  [2100/2244]  eta: 0:03:37  lr: 0.000487  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4944  data: 0.0249  max mem: 34806
Train Epoch: [13]  [2150/2244]  eta: 0:02:21  lr: 0.000487  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4524  data: 0.0210  max mem: 34806
Train Epoch: [13]  [2200/2244]  eta: 0:01:06  lr: 0.000487  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4300  data: 0.0192  max mem: 34806
Train Epoch: [13]  [2243/2244]  eta: 0:00:01  lr: 0.000487  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5253  data: 0.0181  max mem: 34806
Train Epoch: [13] Total time: 0:56:28 (1.5102 s / it)
Averaged stats: lr: 0.0005  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:46
Computing features for evaluation...
Evaluation time 0:00:38
Computing features for evaluation...
Evaluation time 0:00:18
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 39.16, 'txt_r5': 65.32, 'txt_r10': 75.12, 'txt_r_mean': 59.86666666666667, 'img_r1': 22.79888044782087, 'img_r5': 47.86485405837665, 'img_r10': 59.94402239104358, 'img_r_mean': 43.53591896574704, 'r_mean': 51.70129281620685}
coco test: {'txt_r1': 37.72, 'txt_r5': 63.26, 'txt_r10': 73.54, 'txt_r_mean': 58.173333333333325, 'img_r1': 22.586965213914436, 'img_r5': 47.073170731707314, 'img_r10': 59.30827668932427, 'img_r_mean': 42.98947087831534, 'r_mean': 50.58140210582433}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [14]  [   0/2244]  eta: 3:44:02  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.9904  data: 4.0288  max mem: 34806
Train Epoch: [14]  [  50/2244]  eta: 0:59:16  lr: 0.000446  loss_ita: 0.0003  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5061  data: 0.0212  max mem: 34806
Train Epoch: [14]  [ 100/2244]  eta: 0:55:29  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4699  data: 0.0240  max mem: 34806
Train Epoch: [14]  [ 150/2244]  eta: 0:53:35  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5047  data: 0.2493  max mem: 34806
Train Epoch: [14]  [ 200/2244]  eta: 0:52:17  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5613  data: 0.1480  max mem: 34806
Train Epoch: [14]  [ 250/2244]  eta: 0:50:41  lr: 0.000446  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4756  data: 0.0311  max mem: 34806
Train Epoch: [14]  [ 300/2244]  eta: 0:49:20  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5319  data: 0.0237  max mem: 34806
Train Epoch: [14]  [ 350/2244]  eta: 0:47:53  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5281  data: 0.0258  max mem: 34806
Train Epoch: [14]  [ 400/2244]  eta: 0:46:29  lr: 0.000446  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4719  data: 0.0262  max mem: 34806
Train Epoch: [14]  [ 450/2244]  eta: 0:45:06  lr: 0.000446  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4429  data: 0.0211  max mem: 34806
Train Epoch: [14]  [ 500/2244]  eta: 0:43:45  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4240  data: 0.0238  max mem: 34806
Train Epoch: [14]  [ 550/2244]  eta: 0:42:22  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4442  data: 0.0151  max mem: 34806
Train Epoch: [14]  [ 600/2244]  eta: 0:41:03  lr: 0.000446  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4749  data: 0.0271  max mem: 34806
Train Epoch: [14]  [ 650/2244]  eta: 0:39:48  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5013  data: 0.0250  max mem: 34806
Train Epoch: [14]  [ 700/2244]  eta: 0:38:32  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5043  data: 0.0262  max mem: 34806
Train Epoch: [14]  [ 750/2244]  eta: 0:37:16  lr: 0.000446  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5188  data: 0.0227  max mem: 34806
Train Epoch: [14]  [ 800/2244]  eta: 0:35:56  lr: 0.000446  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4598  data: 0.0226  max mem: 34806
Train Epoch: [14]  [ 850/2244]  eta: 0:34:39  lr: 0.000446  loss_ita: 0.0003  lr_temp_net: 0.00000686  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4821  data: 0.0212  max mem: 34806
Train Epoch: [14]  [ 900/2244]  eta: 0:33:25  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4986  data: 0.0223  max mem: 34806
Train Epoch: [14]  [ 950/2244]  eta: 0:32:07  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4354  data: 0.0270  max mem: 34806
Train Epoch: [14]  [1000/2244]  eta: 0:30:49  lr: 0.000446  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4305  data: 0.0237  max mem: 34806
Train Epoch: [14]  [1050/2244]  eta: 0:29:36  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4197  data: 0.0212  max mem: 34806
Train Epoch: [14]  [1100/2244]  eta: 0:28:22  lr: 0.000446  loss_ita: 0.0003  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4775  data: 0.0227  max mem: 34806
Train Epoch: [14]  [1150/2244]  eta: 0:27:05  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4481  data: 0.0190  max mem: 34806
Train Epoch: [14]  [1200/2244]  eta: 0:25:49  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4147  data: 0.0159  max mem: 34806
Train Epoch: [14]  [1250/2244]  eta: 0:24:34  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4746  data: 0.0150  max mem: 34806
Train Epoch: [14]  [1300/2244]  eta: 0:23:20  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4769  data: 0.0236  max mem: 34806
Train Epoch: [14]  [1350/2244]  eta: 0:22:06  lr: 0.000446  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5293  data: 0.0237  max mem: 34806
Train Epoch: [14]  [1400/2244]  eta: 0:20:52  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4633  data: 0.0209  max mem: 34806
Train Epoch: [14]  [1450/2244]  eta: 0:19:38  lr: 0.000446  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4542  data: 0.0215  max mem: 34806
Train Epoch: [14]  [1500/2244]  eta: 0:18:23  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4905  data: 0.0281  max mem: 34806
Train Epoch: [14]  [1550/2244]  eta: 0:17:09  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4502  data: 0.0205  max mem: 34806
Train Epoch: [14]  [1600/2244]  eta: 0:15:55  lr: 0.000446  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5191  data: 0.0208  max mem: 34806
Train Epoch: [14]  [1650/2244]  eta: 0:14:41  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4583  data: 0.0268  max mem: 34806
Train Epoch: [14]  [1700/2244]  eta: 0:13:27  lr: 0.000446  loss_ita: -0.0004  lr_temp_net: 0.00000686  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4977  data: 0.0230  max mem: 34806
Train Epoch: [14]  [1750/2244]  eta: 0:12:13  lr: 0.000446  loss_ita: 0.0003  lr_temp_net: 0.00000686  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5243  data: 0.0226  max mem: 34806
Train Epoch: [14]  [1800/2244]  eta: 0:10:58  lr: 0.000446  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4035  data: 0.0177  max mem: 34806
Train Epoch: [14]  [1850/2244]  eta: 0:09:43  lr: 0.000446  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.3945  data: 0.0192  max mem: 34806
Train Epoch: [14]  [1900/2244]  eta: 0:08:29  lr: 0.000446  loss_ita: 0.0003  lr_temp_net: 0.00000686  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4378  data: 0.0199  max mem: 34806
Train Epoch: [14]  [1950/2244]  eta: 0:07:15  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4661  data: 0.0238  max mem: 34806
Train Epoch: [14]  [2000/2244]  eta: 0:06:01  lr: 0.000446  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5044  data: 0.0233  max mem: 34806
Train Epoch: [14]  [2050/2244]  eta: 0:04:47  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4644  data: 0.0202  max mem: 34806
Train Epoch: [14]  [2100/2244]  eta: 0:03:32  lr: 0.000446  loss_ita: 0.0004  lr_temp_net: 0.00000686  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4442  data: 0.0174  max mem: 34806
Train Epoch: [14]  [2150/2244]  eta: 0:02:19  lr: 0.000446  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4979  data: 0.0209  max mem: 34806
Train Epoch: [14]  [2200/2244]  eta: 0:01:05  lr: 0.000446  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4816  data: 0.0221  max mem: 34806
Train Epoch: [14]  [2243/2244]  eta: 0:00:01  lr: 0.000446  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5307  data: 0.0271  max mem: 34806
Train Epoch: [14] Total time: 0:55:22 (1.4805 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:47
Computing features for evaluation...
Evaluation time 0:00:39
Computing features for evaluation...
Evaluation time 0:00:15
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 39.84, 'txt_r5': 65.76, 'txt_r10': 75.7, 'txt_r_mean': 60.43333333333334, 'img_r1': 23.658536585365855, 'img_r5': 48.620551779288284, 'img_r10': 60.69572171131547, 'img_r_mean': 44.324936691989876, 'r_mean': 52.37913501266161}
coco test: {'txt_r1': 38.18, 'txt_r5': 65.4, 'txt_r10': 75.46, 'txt_r_mean': 59.68000000000001, 'img_r1': 23.47860855657737, 'img_r5': 48.20871651339464, 'img_r10': 60.41583366653339, 'img_r_mean': 44.0343862455018, 'r_mean': 51.8571931227509}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [15]  [   0/2244]  eta: 3:42:51  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.9587  data: 4.1182  max mem: 34806
Train Epoch: [15]  [  50/2244]  eta: 0:57:48  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4729  data: 0.0184  max mem: 34806
Train Epoch: [15]  [ 100/2244]  eta: 0:54:11  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4216  data: 0.0240  max mem: 34806
Train Epoch: [15]  [ 150/2244]  eta: 0:52:19  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4597  data: 0.0205  max mem: 34806
Train Epoch: [15]  [ 200/2244]  eta: 0:50:44  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4600  data: 0.0211  max mem: 34806
Train Epoch: [15]  [ 250/2244]  eta: 0:48:56  lr: 0.000405  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4063  data: 0.0150  max mem: 34806
Train Epoch: [15]  [ 300/2244]  eta: 0:47:41  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5224  data: 0.0156  max mem: 34806
Train Epoch: [15]  [ 350/2244]  eta: 0:46:26  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4853  data: 0.0213  max mem: 34806
Train Epoch: [15]  [ 400/2244]  eta: 0:45:12  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4936  data: 0.0217  max mem: 34806
Train Epoch: [15]  [ 450/2244]  eta: 0:43:55  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4507  data: 0.0195  max mem: 34806
Train Epoch: [15]  [ 500/2244]  eta: 0:42:40  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4346  data: 0.0214  max mem: 34806
Train Epoch: [15]  [ 550/2244]  eta: 0:41:25  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4307  data: 0.0224  max mem: 34806
Train Epoch: [15]  [ 600/2244]  eta: 0:40:09  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4219  data: 0.0211  max mem: 34806
Train Epoch: [15]  [ 650/2244]  eta: 0:38:54  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4558  data: 0.0207  max mem: 34806
Train Epoch: [15]  [ 700/2244]  eta: 0:37:47  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5589  data: 0.0208  max mem: 34806
Train Epoch: [15]  [ 750/2244]  eta: 0:36:36  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5181  data: 0.0221  max mem: 34806
Train Epoch: [15]  [ 800/2244]  eta: 0:35:24  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4874  data: 0.0184  max mem: 34806
Train Epoch: [15]  [ 850/2244]  eta: 0:34:11  lr: 0.000405  loss_ita: 0.0003  lr_temp_net: 0.00000618  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4852  data: 0.0188  max mem: 34806
Train Epoch: [15]  [ 900/2244]  eta: 0:32:59  lr: 0.000405  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5284  data: 0.0232  max mem: 34806
Train Epoch: [15]  [ 950/2244]  eta: 0:31:43  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4437  data: 0.0205  max mem: 34806
Train Epoch: [15]  [1000/2244]  eta: 0:30:31  lr: 0.000405  loss_ita: 0.0004  lr_temp_net: 0.00000618  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5442  data: 0.0226  max mem: 34806
Train Epoch: [15]  [1050/2244]  eta: 0:29:16  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4309  data: 0.0214  max mem: 34806
Train Epoch: [15]  [1100/2244]  eta: 0:28:01  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4410  data: 0.0231  max mem: 34806
Train Epoch: [15]  [1150/2244]  eta: 0:26:46  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4270  data: 0.0220  max mem: 34806
Train Epoch: [15]  [1200/2244]  eta: 0:25:32  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4626  data: 0.0223  max mem: 34806
Train Epoch: [15]  [1250/2244]  eta: 0:24:19  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4961  data: 0.0252  max mem: 34806
Train Epoch: [15]  [1300/2244]  eta: 0:23:05  lr: 0.000405  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4640  data: 0.0189  max mem: 34806
Train Epoch: [15]  [1350/2244]  eta: 0:21:51  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4472  data: 0.0190  max mem: 34806
Train Epoch: [15]  [1400/2244]  eta: 0:20:37  lr: 0.000405  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4305  data: 0.0212  max mem: 34806
Train Epoch: [15]  [1450/2244]  eta: 0:19:24  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4541  data: 0.0223  max mem: 34806
Train Epoch: [15]  [1500/2244]  eta: 0:18:11  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4569  data: 0.0210  max mem: 34806
Train Epoch: [15]  [1550/2244]  eta: 0:16:57  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4445  data: 0.0173  max mem: 34806
Train Epoch: [15]  [1600/2244]  eta: 0:15:43  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4493  data: 0.0233  max mem: 34806
Train Epoch: [15]  [1650/2244]  eta: 0:14:30  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4780  data: 0.0188  max mem: 34806
Train Epoch: [15]  [1700/2244]  eta: 0:13:17  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4845  data: 0.0209  max mem: 34806
Train Epoch: [15]  [1750/2244]  eta: 0:12:04  lr: 0.000405  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5033  data: 0.0232  max mem: 34806
Train Epoch: [15]  [1800/2244]  eta: 0:10:51  lr: 0.000405  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5035  data: 0.0187  max mem: 34806
Train Epoch: [15]  [1850/2244]  eta: 0:09:38  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5069  data: 0.0218  max mem: 34806
Train Epoch: [15]  [1900/2244]  eta: 0:08:25  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4619  data: 0.0209  max mem: 34806
Train Epoch: [15]  [1950/2244]  eta: 0:07:12  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5207  data: 0.0213  max mem: 34806
Train Epoch: [15]  [2000/2244]  eta: 0:05:58  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4503  data: 0.0225  max mem: 34806
Train Epoch: [15]  [2050/2244]  eta: 0:04:45  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5263  data: 0.0201  max mem: 34806
Train Epoch: [15]  [2100/2244]  eta: 0:03:31  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5010  data: 0.0217  max mem: 34806
Train Epoch: [15]  [2150/2244]  eta: 0:02:18  lr: 0.000405  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4770  data: 0.0202  max mem: 34806
Train Epoch: [15]  [2200/2244]  eta: 0:01:04  lr: 0.000405  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5266  data: 0.0199  max mem: 34806
Train Epoch: [15]  [2243/2244]  eta: 0:00:01  lr: 0.000405  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4887  data: 0.0254  max mem: 34806
Train Epoch: [15] Total time: 0:55:05 (1.4729 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:44
Computing features for evaluation...
Evaluation time 0:00:39
Computing features for evaluation...
Evaluation time 0:00:14
Computing features for evaluation...
Evaluation time 0:00:13
coco val: {'txt_r1': 41.46, 'txt_r5': 67.44, 'txt_r10': 76.72, 'txt_r_mean': 61.873333333333335, 'img_r1': 24.442223110755698, 'img_r5': 49.94802079168333, 'img_r10': 62.0031987205118, 'img_r_mean': 45.46448087431694, 'r_mean': 53.668907103825134}
coco test: {'txt_r1': 39.24, 'txt_r5': 65.74, 'txt_r10': 76.16, 'txt_r_mean': 60.379999999999995, 'img_r1': 24.442223110755698, 'img_r5': 48.82047181127549, 'img_r10': 60.723710515793684, 'img_r_mean': 44.662135145941626, 'r_mean': 52.52106757297081}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [16]  [   0/2244]  eta: 3:33:09  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.6996  data: 3.8548  max mem: 34806
Train Epoch: [16]  [  50/2244]  eta: 0:59:20  lr: 0.000364  loss_ita: 0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4630  data: 0.0149  max mem: 34806
Train Epoch: [16]  [ 100/2244]  eta: 0:55:13  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4675  data: 0.0255  max mem: 34806
Train Epoch: [16]  [ 150/2244]  eta: 0:52:59  lr: 0.000364  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4647  data: 0.2483  max mem: 34806
Train Epoch: [16]  [ 200/2244]  eta: 0:51:23  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4895  data: 0.2395  max mem: 34806
Train Epoch: [16]  [ 250/2244]  eta: 0:50:01  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4954  data: 0.2512  max mem: 34806
Train Epoch: [16]  [ 300/2244]  eta: 0:48:34  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4489  data: 0.2404  max mem: 34806
Train Epoch: [16]  [ 350/2244]  eta: 0:47:14  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4894  data: 0.0505  max mem: 34806
Train Epoch: [16]  [ 400/2244]  eta: 0:45:54  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4679  data: 0.0208  max mem: 34806
Train Epoch: [16]  [ 450/2244]  eta: 0:44:21  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.3846  data: 0.0900  max mem: 34806
Train Epoch: [16]  [ 500/2244]  eta: 0:43:01  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4761  data: 0.0202  max mem: 34806
Train Epoch: [16]  [ 550/2244]  eta: 0:41:52  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5437  data: 0.0206  max mem: 34806
Train Epoch: [16]  [ 600/2244]  eta: 0:40:37  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4603  data: 0.0217  max mem: 34806
Train Epoch: [16]  [ 650/2244]  eta: 0:39:20  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5052  data: 0.0177  max mem: 34806
Train Epoch: [16]  [ 700/2244]  eta: 0:38:03  lr: 0.000364  loss_ita: -0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4983  data: 0.1602  max mem: 34806
Train Epoch: [16]  [ 750/2244]  eta: 0:36:52  lr: 0.000364  loss_ita: 0.0004  lr_temp_net: 0.00000556  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5131  data: 0.1837  max mem: 34806
Train Epoch: [16]  [ 800/2244]  eta: 0:35:39  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4971  data: 0.0210  max mem: 34806
Train Epoch: [16]  [ 850/2244]  eta: 0:34:25  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4924  data: 0.0235  max mem: 34806
Train Epoch: [16]  [ 900/2244]  eta: 0:33:10  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4840  data: 0.0252  max mem: 34806
Train Epoch: [16]  [ 950/2244]  eta: 0:31:56  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5416  data: 0.0163  max mem: 34806
Train Epoch: [16]  [1000/2244]  eta: 0:30:44  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5293  data: 0.0254  max mem: 34806
Train Epoch: [16]  [1050/2244]  eta: 0:29:30  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4795  data: 0.0238  max mem: 34806
Train Epoch: [16]  [1100/2244]  eta: 0:28:16  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4797  data: 0.0249  max mem: 34806
Train Epoch: [16]  [1150/2244]  eta: 0:27:02  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4998  data: 0.0210  max mem: 34806
Train Epoch: [16]  [1200/2244]  eta: 0:25:49  lr: 0.000364  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5010  data: 0.0211  max mem: 34806
Train Epoch: [16]  [1250/2244]  eta: 0:24:34  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4459  data: 0.0215  max mem: 34806
Train Epoch: [16]  [1300/2244]  eta: 0:23:20  lr: 0.000364  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4776  data: 0.0221  max mem: 34806
Train Epoch: [16]  [1350/2244]  eta: 0:22:04  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4603  data: 0.0198  max mem: 34806
Train Epoch: [16]  [1400/2244]  eta: 0:20:49  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4353  data: 0.0228  max mem: 34806
Train Epoch: [16]  [1450/2244]  eta: 0:19:35  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4630  data: 0.0250  max mem: 34806
Train Epoch: [16]  [1500/2244]  eta: 0:18:21  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4343  data: 0.0238  max mem: 34806
Train Epoch: [16]  [1550/2244]  eta: 0:17:07  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4616  data: 0.1622  max mem: 34806
Train Epoch: [16]  [1600/2244]  eta: 0:15:53  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5083  data: 0.0205  max mem: 34806
Train Epoch: [16]  [1650/2244]  eta: 0:14:39  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5014  data: 0.2492  max mem: 34806
Train Epoch: [16]  [1700/2244]  eta: 0:13:25  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4585  data: 0.2460  max mem: 34806
Train Epoch: [16]  [1750/2244]  eta: 0:12:11  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4942  data: 0.0713  max mem: 34806
Train Epoch: [16]  [1800/2244]  eta: 0:10:57  lr: 0.000364  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4697  data: 0.0173  max mem: 34806
Train Epoch: [16]  [1850/2244]  eta: 0:09:43  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5032  data: 0.0257  max mem: 34806
Train Epoch: [16]  [1900/2244]  eta: 0:08:29  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4469  data: 0.0250  max mem: 34806
Train Epoch: [16]  [1950/2244]  eta: 0:07:15  lr: 0.000364  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5393  data: 0.0224  max mem: 34806
Train Epoch: [16]  [2000/2244]  eta: 0:06:01  lr: 0.000364  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4526  data: 0.0297  max mem: 34806
Train Epoch: [16]  [2050/2244]  eta: 0:04:47  lr: 0.000364  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4996  data: 0.2364  max mem: 34806
Train Epoch: [16]  [2100/2244]  eta: 0:03:33  lr: 0.000364  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5437  data: 0.2904  max mem: 34806
Train Epoch: [16]  [2150/2244]  eta: 0:02:19  lr: 0.000364  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5373  data: 0.2428  max mem: 34806
Train Epoch: [16]  [2200/2244]  eta: 0:01:05  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4701  data: 0.2530  max mem: 34806
Train Epoch: [16]  [2243/2244]  eta: 0:00:01  lr: 0.000364  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4811  data: 0.0902  max mem: 34806
Train Epoch: [16] Total time: 0:55:28 (1.4835 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:45
Computing features for evaluation...
Evaluation time 0:00:39
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:13
coco val: {'txt_r1': 40.4, 'txt_r5': 66.64, 'txt_r10': 76.66, 'txt_r_mean': 61.23333333333333, 'img_r1': 24.38624550179928, 'img_r5': 49.324270291883245, 'img_r10': 61.4954018392643, 'img_r_mean': 45.068639210982276, 'r_mean': 53.1509862721578}
coco test: {'txt_r1': 39.24, 'txt_r5': 66.18, 'txt_r10': 75.72, 'txt_r_mean': 60.38, 'img_r1': 24.34626149540184, 'img_r5': 49.60015993602559, 'img_r10': 61.19952019192323, 'img_r_mean': 45.04864720778355, 'r_mean': 52.71432360389178}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [17]  [   0/2244]  eta: 3:34:19  lr: 0.000323  loss_ita: 0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.7304  data: 4.0833  max mem: 34806
Train Epoch: [17]  [  50/2244]  eta: 0:58:45  lr: 0.000323  loss_ita: 0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4822  data: 0.0229  max mem: 34806
Train Epoch: [17]  [ 100/2244]  eta: 0:55:11  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4657  data: 0.0211  max mem: 34806
Train Epoch: [17]  [ 150/2244]  eta: 0:53:26  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5291  data: 0.0224  max mem: 34806
Train Epoch: [17]  [ 200/2244]  eta: 0:51:45  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4804  data: 0.0220  max mem: 34806
Train Epoch: [17]  [ 250/2244]  eta: 0:50:19  lr: 0.000323  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4600  data: 0.0212  max mem: 34806
Train Epoch: [17]  [ 300/2244]  eta: 0:48:48  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4515  data: 0.0225  max mem: 34806
Train Epoch: [17]  [ 350/2244]  eta: 0:47:28  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4944  data: 0.0202  max mem: 34806
Train Epoch: [17]  [ 400/2244]  eta: 0:46:05  lr: 0.000323  loss_ita: -0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4899  data: 0.0251  max mem: 34806
Train Epoch: [17]  [ 450/2244]  eta: 0:44:43  lr: 0.000323  loss_ita: -0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4499  data: 0.0218  max mem: 34806
Train Epoch: [17]  [ 500/2244]  eta: 0:43:26  lr: 0.000323  loss_ita: -0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4893  data: 0.0219  max mem: 34806
Train Epoch: [17]  [ 550/2244]  eta: 0:42:11  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4698  data: 0.0206  max mem: 34806
Train Epoch: [17]  [ 600/2244]  eta: 0:40:49  lr: 0.000323  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4215  data: 0.0209  max mem: 34806
Train Epoch: [17]  [ 650/2244]  eta: 0:39:33  lr: 0.000323  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4910  data: 0.0246  max mem: 34806
Train Epoch: [17]  [ 700/2244]  eta: 0:38:13  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4588  data: 0.0198  max mem: 34806
Train Epoch: [17]  [ 750/2244]  eta: 0:36:52  lr: 0.000323  loss_ita: 0.0005  lr_temp_net: 0.00000500  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.3915  data: 0.0243  max mem: 34806
Train Epoch: [17]  [ 800/2244]  eta: 0:35:38  lr: 0.000323  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4748  data: 0.0220  max mem: 34806
Train Epoch: [17]  [ 850/2244]  eta: 0:34:25  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4989  data: 0.0248  max mem: 34806
Train Epoch: [17]  [ 900/2244]  eta: 0:33:08  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4533  data: 0.0206  max mem: 34806
Train Epoch: [17]  [ 950/2244]  eta: 0:31:50  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4123  data: 0.0200  max mem: 34806
Train Epoch: [17]  [1000/2244]  eta: 0:30:35  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4547  data: 0.0227  max mem: 34806
Train Epoch: [17]  [1050/2244]  eta: 0:29:18  lr: 0.000323  loss_ita: -0.0005  lr_temp_net: 0.00000500  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4151  data: 0.0195  max mem: 34806
Train Epoch: [17]  [1100/2244]  eta: 0:28:03  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4342  data: 0.0219  max mem: 34806
Train Epoch: [17]  [1150/2244]  eta: 0:26:49  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5172  data: 0.0217  max mem: 34806
Train Epoch: [17]  [1200/2244]  eta: 0:25:36  lr: 0.000323  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4895  data: 0.0201  max mem: 34806
Train Epoch: [17]  [1250/2244]  eta: 0:24:23  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4521  data: 0.0225  max mem: 34806
Train Epoch: [17]  [1300/2244]  eta: 0:23:10  lr: 0.000323  loss_ita: -0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4373  data: 0.0212  max mem: 34806
Train Epoch: [17]  [1350/2244]  eta: 0:21:57  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4294  data: 0.0208  max mem: 34806
Train Epoch: [17]  [1400/2244]  eta: 0:20:42  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4252  data: 0.0209  max mem: 34806
Train Epoch: [17]  [1450/2244]  eta: 0:19:27  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4125  data: 0.0195  max mem: 34806
Train Epoch: [17]  [1500/2244]  eta: 0:18:13  lr: 0.000323  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4816  data: 0.0200  max mem: 34806
Train Epoch: [17]  [1550/2244]  eta: 0:16:59  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4348  data: 0.0234  max mem: 34806
Train Epoch: [17]  [1600/2244]  eta: 0:15:46  lr: 0.000323  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4588  data: 0.0230  max mem: 34806
Train Epoch: [17]  [1650/2244]  eta: 0:14:32  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4780  data: 0.0224  max mem: 34806
Train Epoch: [17]  [1700/2244]  eta: 0:13:19  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4390  data: 0.0244  max mem: 34806
Train Epoch: [17]  [1750/2244]  eta: 0:12:05  lr: 0.000323  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4645  data: 0.0190  max mem: 34806
Train Epoch: [17]  [1800/2244]  eta: 0:10:52  lr: 0.000323  loss_ita: -0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5231  data: 0.0209  max mem: 34806
Train Epoch: [17]  [1850/2244]  eta: 0:09:39  lr: 0.000323  loss_ita: -0.0004  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4334  data: 0.0220  max mem: 34806
Train Epoch: [17]  [1900/2244]  eta: 0:08:25  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4828  data: 0.0216  max mem: 34806
Train Epoch: [17]  [1950/2244]  eta: 0:07:11  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4480  data: 0.0308  max mem: 34806
Train Epoch: [17]  [2000/2244]  eta: 0:05:58  lr: 0.000323  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4625  data: 0.0193  max mem: 34806
Train Epoch: [17]  [2050/2244]  eta: 0:04:44  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4459  data: 0.0181  max mem: 34806
Train Epoch: [17]  [2100/2244]  eta: 0:03:31  lr: 0.000323  loss_ita: -0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4662  data: 0.0225  max mem: 34806
Train Epoch: [17]  [2150/2244]  eta: 0:02:17  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4315  data: 0.0167  max mem: 34806
Train Epoch: [17]  [2200/2244]  eta: 0:01:04  lr: 0.000323  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4631  data: 0.0218  max mem: 34806
Train Epoch: [17]  [2243/2244]  eta: 0:00:01  lr: 0.000323  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4599  data: 0.0212  max mem: 34806
Train Epoch: [17] Total time: 0:54:51 (1.4670 s / it)
Averaged stats: lr: 0.0003  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:44
Computing features for evaluation...
Evaluation time 0:00:39
Computing features for evaluation...
Evaluation time 0:00:15
Computing features for evaluation...
Evaluation time 0:00:13
coco val: {'txt_r1': 40.9, 'txt_r5': 66.48, 'txt_r10': 76.44, 'txt_r_mean': 61.27333333333333, 'img_r1': 24.53418632546981, 'img_r5': 49.66813274690124, 'img_r10': 61.99120351859256, 'img_r_mean': 45.397840863654544, 'r_mean': 53.33558709849394}
coco test: {'txt_r1': 39.78, 'txt_r5': 66.02, 'txt_r10': 76.0, 'txt_r_mean': 60.6, 'img_r1': 24.206317473010795, 'img_r5': 49.628148740503796, 'img_r10': 61.575369852059175, 'img_r_mean': 45.13661202185792, 'r_mean': 52.86830601092896}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [18]  [   0/2244]  eta: 3:37:26  lr: 0.000283  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.8138  data: 3.8750  max mem: 34806
Train Epoch: [18]  [  50/2244]  eta: 0:57:26  lr: 0.000283  loss_ita: 0.0004  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4501  data: 0.1466  max mem: 34806
Train Epoch: [18]  [ 100/2244]  eta: 0:53:42  lr: 0.000283  loss_ita: -0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4276  data: 0.0300  max mem: 34806
Train Epoch: [18]  [ 150/2244]  eta: 0:52:06  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4936  data: 0.0209  max mem: 34806
Train Epoch: [18]  [ 200/2244]  eta: 0:50:45  lr: 0.000283  loss_ita: 0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4399  data: 0.0207  max mem: 34806
Train Epoch: [18]  [ 250/2244]  eta: 0:49:09  lr: 0.000283  loss_ita: 0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4392  data: 0.0205  max mem: 34806
Train Epoch: [18]  [ 300/2244]  eta: 0:48:07  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4783  data: 0.0218  max mem: 34806
Train Epoch: [18]  [ 350/2244]  eta: 0:46:58  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5187  data: 0.0265  max mem: 34806
Train Epoch: [18]  [ 400/2244]  eta: 0:45:58  lr: 0.000283  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5491  data: 0.0203  max mem: 34806
Train Epoch: [18]  [ 450/2244]  eta: 0:44:38  lr: 0.000283  loss_ita: 0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4020  data: 0.0231  max mem: 34806
Train Epoch: [18]  [ 500/2244]  eta: 0:43:36  lr: 0.000283  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4562  data: 0.0211  max mem: 34806
Train Epoch: [18]  [ 550/2244]  eta: 0:42:46  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.0047  data: 0.0244  max mem: 34806
Train Epoch: [18]  [ 600/2244]  eta: 0:42:18  lr: 0.000283  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4539  data: 0.0658  max mem: 34806
Train Epoch: [18]  [ 650/2244]  eta: 0:42:04  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.1589  data: 0.0429  max mem: 34806
Train Epoch: [18]  [ 700/2244]  eta: 0:40:53  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 2.0025  data: 0.0793  max mem: 34806
Train Epoch: [18]  [ 750/2244]  eta: 0:39:26  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5736  data: 0.0180  max mem: 34806
Train Epoch: [18]  [ 800/2244]  eta: 0:38:02  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5101  data: 0.0218  max mem: 34806
Train Epoch: [18]  [ 850/2244]  eta: 0:36:42  lr: 0.000283  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5543  data: 0.0283  max mem: 34806
Train Epoch: [18]  [ 900/2244]  eta: 0:35:23  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6692  data: 0.0301  max mem: 34806
Train Epoch: [18]  [ 950/2244]  eta: 0:33:58  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4762  data: 0.0194  max mem: 34806
Train Epoch: [18]  [1000/2244]  eta: 0:32:41  lr: 0.000283  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5233  data: 0.0270  max mem: 34806
Train Epoch: [18]  [1050/2244]  eta: 0:31:16  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4415  data: 0.0213  max mem: 34806
Train Epoch: [18]  [1100/2244]  eta: 0:29:55  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5144  data: 0.1100  max mem: 34806
Train Epoch: [18]  [1150/2244]  eta: 0:28:35  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5520  data: 0.2780  max mem: 34806
Train Epoch: [18]  [1200/2244]  eta: 0:27:17  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5812  data: 0.2718  max mem: 34806
Train Epoch: [18]  [1250/2244]  eta: 0:25:58  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5784  data: 0.2846  max mem: 34806
Train Epoch: [18]  [1300/2244]  eta: 0:24:39  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5078  data: 0.2340  max mem: 34806
Train Epoch: [18]  [1350/2244]  eta: 0:23:18  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4545  data: 0.2044  max mem: 34806
Train Epoch: [18]  [1400/2244]  eta: 0:21:59  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5649  data: 0.0195  max mem: 34806
Train Epoch: [18]  [1450/2244]  eta: 0:20:40  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5219  data: 0.0202  max mem: 34806
Train Epoch: [18]  [1500/2244]  eta: 0:19:21  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5653  data: 0.0238  max mem: 34806
Train Epoch: [18]  [1550/2244]  eta: 0:18:06  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5774  data: 0.0246  max mem: 34806
Train Epoch: [18]  [1600/2244]  eta: 0:16:48  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5204  data: 0.0220  max mem: 34806
Train Epoch: [18]  [1650/2244]  eta: 0:15:29  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4111  data: 0.0230  max mem: 34806
Train Epoch: [18]  [1700/2244]  eta: 0:14:10  lr: 0.000283  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5317  data: 0.2376  max mem: 34806
Train Epoch: [18]  [1750/2244]  eta: 0:12:52  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5664  data: 0.2222  max mem: 34806
Train Epoch: [18]  [1800/2244]  eta: 0:11:33  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5137  data: 0.2631  max mem: 34806
Train Epoch: [18]  [1850/2244]  eta: 0:10:15  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5291  data: 0.1882  max mem: 34806
Train Epoch: [18]  [1900/2244]  eta: 0:08:56  lr: 0.000283  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5179  data: 0.0260  max mem: 34806
Train Epoch: [18]  [1950/2244]  eta: 0:07:38  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6290  data: 0.0262  max mem: 34806
Train Epoch: [18]  [2000/2244]  eta: 0:06:20  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5276  data: 0.0262  max mem: 34806
Train Epoch: [18]  [2050/2244]  eta: 0:05:02  lr: 0.000283  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5118  data: 0.0243  max mem: 34806
Train Epoch: [18]  [2100/2244]  eta: 0:03:44  lr: 0.000283  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5552  data: 0.0356  max mem: 34806
Train Epoch: [18]  [2150/2244]  eta: 0:02:26  lr: 0.000283  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4998  data: 0.0248  max mem: 34806
Train Epoch: [18]  [2200/2244]  eta: 0:01:08  lr: 0.000283  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4811  data: 0.0229  max mem: 34806
Train Epoch: [18]  [2243/2244]  eta: 0:00:01  lr: 0.000283  loss_ita: -0.0004  lr_temp_net: 0.00000450  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6189  data: 0.0283  max mem: 34806
Train Epoch: [18] Total time: 0:58:18 (1.5590 s / it)
Averaged stats: lr: 0.0003  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:47
Computing features for evaluation...
Evaluation time 0:00:44
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 42.0, 'txt_r5': 67.72, 'txt_r10': 77.54, 'txt_r_mean': 62.419999999999995, 'img_r1': 25.285885645741704, 'img_r5': 50.35985605757697, 'img_r10': 62.59096361455418, 'img_r_mean': 46.078901772624285, 'r_mean': 54.24945088631214}
coco test: {'txt_r1': 40.12, 'txt_r5': 66.38, 'txt_r10': 76.58, 'txt_r_mean': 61.026666666666664, 'img_r1': 24.934026389444224, 'img_r5': 50.11595361855258, 'img_r10': 62.27109156337465, 'img_r_mean': 45.773690523790485, 'r_mean': 53.400178595228574}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [19]  [   0/2244]  eta: 4:49:30  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.7410  data: 4.4401  max mem: 34806
Train Epoch: [19]  [  50/2244]  eta: 1:00:47  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5643  data: 0.0198  max mem: 34806
Train Epoch: [19]  [ 100/2244]  eta: 0:57:32  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5626  data: 0.0251  max mem: 34806
Train Epoch: [19]  [ 150/2244]  eta: 0:55:28  lr: 0.000244  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5352  data: 0.0352  max mem: 34806
Train Epoch: [19]  [ 200/2244]  eta: 0:53:21  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4768  data: 0.0252  max mem: 34806
Train Epoch: [19]  [ 250/2244]  eta: 0:51:48  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5248  data: 0.0232  max mem: 34806
Train Epoch: [19]  [ 300/2244]  eta: 0:50:29  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5850  data: 0.0252  max mem: 34806
Train Epoch: [19]  [ 350/2244]  eta: 0:48:56  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4938  data: 0.0291  max mem: 34806
Train Epoch: [19]  [ 400/2244]  eta: 0:47:40  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5701  data: 0.0255  max mem: 34806
Train Epoch: [19]  [ 450/2244]  eta: 0:46:18  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4909  data: 0.0240  max mem: 34806
Train Epoch: [19]  [ 500/2244]  eta: 0:44:53  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4789  data: 0.0267  max mem: 34806
Train Epoch: [19]  [ 550/2244]  eta: 0:43:31  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4749  data: 0.0175  max mem: 34806
Train Epoch: [19]  [ 600/2244]  eta: 0:42:18  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6555  data: 0.3494  max mem: 34806
Train Epoch: [19]  [ 650/2244]  eta: 0:41:01  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5397  data: 0.1606  max mem: 34806
Train Epoch: [19]  [ 700/2244]  eta: 0:39:42  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5101  data: 0.1676  max mem: 34806
Train Epoch: [19]  [ 750/2244]  eta: 0:38:28  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5789  data: 0.0297  max mem: 34806
Train Epoch: [19]  [ 800/2244]  eta: 0:37:07  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4925  data: 0.0268  max mem: 34806
Train Epoch: [19]  [ 850/2244]  eta: 0:35:48  lr: 0.000244  loss_ita: -0.0003  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5324  data: 0.0249  max mem: 34806
Train Epoch: [19]  [ 900/2244]  eta: 0:34:28  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5286  data: 0.1948  max mem: 34806
Train Epoch: [19]  [ 950/2244]  eta: 0:33:09  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4853  data: 0.0207  max mem: 34806
Train Epoch: [19]  [1000/2244]  eta: 0:31:55  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5839  data: 0.0280  max mem: 34806
Train Epoch: [19]  [1050/2244]  eta: 0:30:34  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4948  data: 0.0268  max mem: 34806
Train Epoch: [19]  [1100/2244]  eta: 0:29:17  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5453  data: 0.0281  max mem: 34806
Train Epoch: [19]  [1150/2244]  eta: 0:28:00  lr: 0.000244  loss_ita: 0.0003  lr_temp_net: 0.00000405  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5081  data: 0.0256  max mem: 34806
Train Epoch: [19]  [1200/2244]  eta: 0:26:45  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5927  data: 0.0280  max mem: 34806
Train Epoch: [19]  [1250/2244]  eta: 0:25:28  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5214  data: 0.0235  max mem: 34806
Train Epoch: [19]  [1300/2244]  eta: 0:24:11  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5542  data: 0.0240  max mem: 34806
Train Epoch: [19]  [1350/2244]  eta: 0:22:56  lr: 0.000244  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5851  data: 0.0229  max mem: 34806
Train Epoch: [19]  [1400/2244]  eta: 0:21:41  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6043  data: 0.0235  max mem: 34806
Train Epoch: [19]  [1450/2244]  eta: 0:20:23  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4823  data: 0.0265  max mem: 34806
Train Epoch: [19]  [1500/2244]  eta: 0:19:05  lr: 0.000244  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5261  data: 0.0227  max mem: 34806
Train Epoch: [19]  [1550/2244]  eta: 0:17:49  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5487  data: 0.0259  max mem: 34806
Train Epoch: [19]  [1600/2244]  eta: 0:16:31  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5119  data: 0.0246  max mem: 34806
Train Epoch: [19]  [1650/2244]  eta: 0:15:14  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5300  data: 0.0240  max mem: 34806
Train Epoch: [19]  [1700/2244]  eta: 0:13:57  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4859  data: 0.0440  max mem: 34806
Train Epoch: [19]  [1750/2244]  eta: 0:12:40  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5493  data: 0.0174  max mem: 34806
Train Epoch: [19]  [1800/2244]  eta: 0:11:24  lr: 0.000244  loss_ita: -0.0003  lr_temp_net: 0.00000405  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5913  data: 0.2003  max mem: 34806
Train Epoch: [19]  [1850/2244]  eta: 0:10:07  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5611  data: 0.0197  max mem: 34806
Train Epoch: [19]  [1900/2244]  eta: 0:08:50  lr: 0.000244  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5057  data: 0.0849  max mem: 34806
Train Epoch: [19]  [1950/2244]  eta: 0:07:33  lr: 0.000244  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5599  data: 0.0221  max mem: 34806
Train Epoch: [19]  [2000/2244]  eta: 0:06:16  lr: 0.000244  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5669  data: 0.0253  max mem: 34806
Train Epoch: [19]  [2050/2244]  eta: 0:04:59  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6219  data: 0.0439  max mem: 34806
Train Epoch: [19]  [2100/2244]  eta: 0:03:42  lr: 0.000244  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5710  data: 0.0279  max mem: 34806
Train Epoch: [19]  [2150/2244]  eta: 0:02:24  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5338  data: 0.0284  max mem: 34806
Train Epoch: [19]  [2200/2244]  eta: 0:01:07  lr: 0.000244  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5413  data: 0.0260  max mem: 34806
Train Epoch: [19]  [2243/2244]  eta: 0:00:01  lr: 0.000244  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6423  data: 0.0791  max mem: 34806
Train Epoch: [19] Total time: 0:57:43 (1.5433 s / it)
Averaged stats: lr: 0.0002  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:50
Computing features for evaluation...
Evaluation time 0:00:46
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 41.88, 'txt_r5': 67.84, 'txt_r10': 77.16, 'txt_r_mean': 62.29333333333333, 'img_r1': 25.793682526989205, 'img_r5': 51.08356657337065, 'img_r10': 63.310675729708116, 'img_r_mean': 46.72930827668932, 'r_mean': 54.51132080501132}
coco test: {'txt_r1': 41.0, 'txt_r5': 67.44, 'txt_r10': 77.38, 'txt_r_mean': 61.94, 'img_r1': 25.28988404638145, 'img_r5': 50.58376649340264, 'img_r10': 62.66693322670932, 'img_r_mean': 46.180194588831135, 'r_mean': 54.06009729441557}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Train Epoch: [20]  [   0/2244]  eta: 5:45:58  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 9.2507  data: 5.2199  max mem: 34806
Train Epoch: [20]  [  50/2244]  eta: 1:01:50  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5296  data: 0.0199  max mem: 34806
Train Epoch: [20]  [ 100/2244]  eta: 0:58:04  lr: 0.000208  loss_ita: -0.0003  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5330  data: 0.0687  max mem: 34806
Train Epoch: [20]  [ 150/2244]  eta: 0:55:38  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5323  data: 0.0245  max mem: 34806
Train Epoch: [20]  [ 200/2244]  eta: 0:54:22  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6399  data: 0.0837  max mem: 34806
Train Epoch: [20]  [ 250/2244]  eta: 0:53:00  lr: 0.000208  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6113  data: 0.0274  max mem: 34806
Train Epoch: [20]  [ 300/2244]  eta: 0:51:53  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6374  data: 0.0263  max mem: 34806
Train Epoch: [20]  [ 350/2244]  eta: 0:50:36  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6216  data: 0.0269  max mem: 34806
Train Epoch: [20]  [ 400/2244]  eta: 0:49:12  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5052  data: 0.0262  max mem: 34806
Train Epoch: [20]  [ 450/2244]  eta: 0:47:35  lr: 0.000208  loss_ita: 0.0003  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4952  data: 0.0265  max mem: 34806
Train Epoch: [20]  [ 500/2244]  eta: 0:46:08  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5627  data: 0.0264  max mem: 34806
Train Epoch: [20]  [ 550/2244]  eta: 0:44:44  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5406  data: 0.0249  max mem: 34806
Train Epoch: [20]  [ 600/2244]  eta: 0:43:24  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5892  data: 0.0287  max mem: 34806
Train Epoch: [20]  [ 650/2244]  eta: 0:41:58  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4957  data: 0.0268  max mem: 34806
Train Epoch: [20]  [ 700/2244]  eta: 0:40:37  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5259  data: 0.2010  max mem: 34806
Train Epoch: [20]  [ 750/2244]  eta: 0:39:16  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5333  data: 0.0274  max mem: 34806
Train Epoch: [20]  [ 800/2244]  eta: 0:37:56  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5821  data: 0.0244  max mem: 34806
Train Epoch: [20]  [ 850/2244]  eta: 0:36:32  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5229  data: 0.0294  max mem: 34806
Train Epoch: [20]  [ 900/2244]  eta: 0:35:09  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5424  data: 0.0299  max mem: 34806
Train Epoch: [20]  [ 950/2244]  eta: 0:33:50  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5820  data: 0.0283  max mem: 34806
Train Epoch: [20]  [1000/2244]  eta: 0:32:29  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5286  data: 0.0216  max mem: 34806
Train Epoch: [20]  [1050/2244]  eta: 0:31:06  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5037  data: 0.0202  max mem: 34806
Train Epoch: [20]  [1100/2244]  eta: 0:29:50  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5558  data: 0.0234  max mem: 34806
Train Epoch: [20]  [1150/2244]  eta: 0:28:32  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5478  data: 0.0245  max mem: 34806
Train Epoch: [20]  [1200/2244]  eta: 0:27:14  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5540  data: 0.0263  max mem: 34806
Train Epoch: [20]  [1250/2244]  eta: 0:25:56  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5619  data: 0.0227  max mem: 34806
Train Epoch: [20]  [1300/2244]  eta: 0:24:37  lr: 0.000208  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5132  data: 0.0243  max mem: 34806
Train Epoch: [20]  [1350/2244]  eta: 0:23:18  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6103  data: 0.0234  max mem: 34806
Train Epoch: [20]  [1400/2244]  eta: 0:22:00  lr: 0.000208  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5852  data: 0.0244  max mem: 34806
Train Epoch: [20]  [1450/2244]  eta: 0:20:42  lr: 0.000208  loss_ita: 0.0004  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5690  data: 0.0228  max mem: 34806
Train Epoch: [20]  [1500/2244]  eta: 0:19:24  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5936  data: 0.0260  max mem: 34806
Train Epoch: [20]  [1550/2244]  eta: 0:18:06  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5759  data: 0.0251  max mem: 34806
Train Epoch: [20]  [1600/2244]  eta: 0:16:47  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4829  data: 0.0361  max mem: 34806
Train Epoch: [20]  [1650/2244]  eta: 0:15:29  lr: 0.000208  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4785  data: 0.2039  max mem: 34806
Train Epoch: [20]  [1700/2244]  eta: 0:14:10  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5076  data: 0.1998  max mem: 34806
Train Epoch: [20]  [1750/2244]  eta: 0:12:52  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6071  data: 0.2707  max mem: 34806
Train Epoch: [20]  [1800/2244]  eta: 0:11:34  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5701  data: 0.1668  max mem: 34806
Train Epoch: [20]  [1850/2244]  eta: 0:10:16  lr: 0.000208  loss_ita: -0.0004  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5775  data: 0.2354  max mem: 34806
Train Epoch: [20]  [1900/2244]  eta: 0:08:57  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5513  data: 0.2766  max mem: 34806
Train Epoch: [20]  [1950/2244]  eta: 0:07:39  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5466  data: 0.2523  max mem: 34806
Train Epoch: [20]  [2000/2244]  eta: 0:06:21  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5335  data: 0.2580  max mem: 34806
Train Epoch: [20]  [2050/2244]  eta: 0:05:02  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5239  data: 0.2187  max mem: 34806
Train Epoch: [20]  [2100/2244]  eta: 0:03:44  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5242  data: 0.1799  max mem: 34806
Train Epoch: [20]  [2150/2244]  eta: 0:02:26  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.4983  data: 0.2493  max mem: 34806
Train Epoch: [20]  [2200/2244]  eta: 0:01:08  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.6136  data: 0.0227  max mem: 34806
Train Epoch: [20]  [2243/2244]  eta: 0:00:01  lr: 0.000208  loss_ita: -0.0005  lr_temp_net: 0.00000365  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.7397  data: 0.0612  max mem: 34806
Train Epoch: [20] Total time: 0:58:25 (1.5621 s / it)
Averaged stats: lr: 0.0002  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:50
Computing features for evaluation...
Evaluation time 0:00:44
Computing features for evaluation...
Evaluation time 0:00:16
Computing features for evaluation...
Evaluation time 0:00:15
coco val: {'txt_r1': 41.4, 'txt_r5': 67.58, 'txt_r10': 77.42, 'txt_r_mean': 62.133333333333326, 'img_r1': 25.669732107157138, 'img_r5': 51.33146741303479, 'img_r10': 63.37065173930428, 'img_r_mean': 46.79061708649874, 'r_mean': 54.461975209916034}
coco test: {'txt_r1': 41.0, 'txt_r5': 67.36, 'txt_r10': 76.98, 'txt_r_mean': 61.78, 'img_r1': 25.709716113554578, 'img_r5': 50.88764494202319, 'img_r10': 62.92283086765294, 'img_r_mean': 46.506730641076906, 'r_mean': 54.14336532053845}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [21]  [   0/2244]  eta: 4:14:38  lr: 0.000173  loss_ita: -0.0005  lr_temp_net: 0.00000328  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 6.8088  data: 4.4624  max mem: 34806
Train Epoch: [21]  [  50/2244]  eta: 1:23:48  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.5221  data: 0.0325  max mem: 34806
Train Epoch: [21]  [ 100/2244]  eta: 1:30:20  lr: 0.000173  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 4.5734  data: 0.0391  max mem: 34806
Train Epoch: [21]  [ 150/2244]  eta: 1:21:39  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.6715  data: 0.1491  max mem: 34806
Train Epoch: [21]  [ 200/2244]  eta: 1:13:15  lr: 0.000173  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5011  data: 0.0335  max mem: 34806
Train Epoch: [21]  [ 250/2244]  eta: 1:07:33  lr: 0.000173  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5479  data: 0.1047  max mem: 34806
Train Epoch: [21]  [ 300/2244]  eta: 1:03:21  lr: 0.000173  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5372  data: 0.1992  max mem: 34806
Train Epoch: [21]  [ 350/2244]  eta: 0:59:53  lr: 0.000173  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.6042  data: 0.3014  max mem: 34806
Train Epoch: [21]  [ 400/2244]  eta: 0:56:58  lr: 0.000173  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5745  data: 0.0329  max mem: 34806
Train Epoch: [21]  [ 450/2244]  eta: 0:54:29  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5761  data: 0.0292  max mem: 34806
Train Epoch: [21]  [ 500/2244]  eta: 0:52:17  lr: 0.000173  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5882  data: 0.0243  max mem: 34806
Train Epoch: [21]  [ 550/2244]  eta: 0:50:08  lr: 0.000173  loss_ita: -0.0003  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5412  data: 0.0238  max mem: 34806
Train Epoch: [21]  [ 600/2244]  eta: 0:48:09  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.5342  data: 0.0251  max mem: 34806
Train Epoch: [21]  [ 650/2244]  eta: 0:46:24  lr: 0.000173  loss_ita: 0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.6245  data: 0.0307  max mem: 34806
Train Epoch: [21]  [ 700/2244]  eta: 0:44:41  lr: 0.000173  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5801  data: 0.0282  max mem: 34806
Train Epoch: [21]  [ 750/2244]  eta: 0:43:00  lr: 0.000173  loss_ita: -0.0003  lr_temp_net: 0.00000328  loss_temp: -0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5455  data: 0.0281  max mem: 34806
Train Epoch: [21]  [ 800/2244]  eta: 0:41:16  lr: 0.000173  loss_ita: -0.0003  lr_temp_net: 0.00000328  loss_temp: -0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5596  data: 0.0281  max mem: 34806
Train Epoch: [21]  [ 850/2244]  eta: 0:39:38  lr: 0.000173  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5652  data: 0.0212  max mem: 34806
Train Epoch: [21]  [ 900/2244]  eta: 0:38:03  lr: 0.000173  loss_ita: -0.0007  lr_temp_net: 0.00000328  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5858  data: 0.0256  max mem: 34806
Train Epoch: [21]  [ 950/2244]  eta: 0:36:25  lr: 0.000173  loss_ita: -0.0005  lr_temp_net: 0.00000328  loss_temp: -0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.5143  data: 0.0260  max mem: 34806
Train Epoch: [21]  [1000/2244]  eta: 0:34:55  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.5716  data: 0.0268  max mem: 34806
Train Epoch: [21]  [1050/2244]  eta: 0:33:25  lr: 0.000173  loss_ita: -0.0005  lr_temp_net: 0.00000328  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.5451  data: 0.0249  max mem: 34806
Train Epoch: [21]  [1100/2244]  eta: 0:31:57  lr: 0.000173  loss_ita: -0.0004  lr_temp_net: 0.00000328  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.5779  data: 0.0386  max mem: 34806
Train Epoch: [21]  [1150/2244]  eta: 0:30:27  lr: 0.000173  loss_ita: -0.0004  lr_temp_net: 0.00000328  loss_temp: -0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0014  time: 1.5705  data: 0.0306  max mem: 34806
Train Epoch: [21]  [1200/2244]  eta: 0:29:00  lr: 0.000173  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0014  time: 1.6037  data: 0.2861  max mem: 34806
Train Epoch: [21]  [1250/2244]  eta: 0:27:33  lr: 0.000173  loss_ita: -0.0005  lr_temp_net: 0.00000328  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0014  time: 1.5255  data: 0.2229  max mem: 34806
Train Epoch: [21]  [1300/2244]  eta: 0:26:05  lr: 0.000173  loss_ita: -0.0007  lr_temp_net: 0.00000328  loss_temp: -0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0015  time: 1.5000  data: 0.2281  max mem: 34806
Train Epoch: [21]  [1350/2244]  eta: 0:24:39  lr: 0.000173  loss_ita: -0.0006  lr_temp_net: 0.00000328  loss_temp: -0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0015  time: 1.5801  data: 0.0426  max mem: 34806
Train Epoch: [21]  [1400/2244]  eta: 0:23:13  lr: 0.000173  loss_ita: -0.0008  lr_temp_net: 0.00000328  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0015  time: 1.5990  data: 0.0183  max mem: 34806
Train Epoch: [21]  [1450/2244]  eta: 0:21:49  lr: 0.000173  loss_ita: -0.0012  lr_temp_net: 0.00000328  loss_temp: -0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0016  time: 1.4817  data: 0.0258  max mem: 34806
Train Epoch: [21]  [1500/2244]  eta: 0:20:23  lr: 0.000173  loss_ita: -0.0012  lr_temp_net: 0.00000328  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0016  time: 1.6052  data: 0.0395  max mem: 34806
Train Epoch: [21]  [1550/2244]  eta: 0:18:59  lr: 0.000173  loss_ita: -0.0010  lr_temp_net: 0.00000328  loss_temp: -0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0017  time: 1.6004  data: 0.0274  max mem: 34806
Train Epoch: [21]  [1600/2244]  eta: 0:17:36  lr: 0.000173  loss_ita: -0.0010  lr_temp_net: 0.00000328  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0017  time: 1.5453  data: 0.0284  max mem: 34806
Train Epoch: [21]  [1650/2244]  eta: 0:17:29  lr: 0.000173  loss_ita: -0.0004  lr_temp_net: 0.00000328  loss_temp: -0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0018  time: 1.9603  data: 0.0313  max mem: 34806
Train Epoch: [21]  [1700/2244]  eta: 0:15:57  lr: 0.000173  loss_ita: -0.0018  lr_temp_net: 0.00000328  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0019  time: 1.5924  data: 0.0252  max mem: 34806
Train Epoch: [21]  [1750/2244]  eta: 0:14:26  lr: 0.000173  loss_ita: -0.0014  lr_temp_net: 0.00000328  loss_temp: -0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0019  time: 1.5749  data: 0.0268  max mem: 34806
Train Epoch: [21]  [1800/2244]  eta: 0:12:57  lr: 0.000173  loss_ita: -0.0012  lr_temp_net: 0.00000328  loss_temp: -0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0019  time: 1.6067  data: 0.0247  max mem: 34806
Train Epoch: [21]  [1850/2244]  eta: 0:11:27  lr: 0.000173  loss_ita: -0.0015  lr_temp_net: 0.00000328  loss_temp: -0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0020  time: 1.6430  data: 0.1556  max mem: 34806
Train Epoch: [21]  [1900/2244]  eta: 0:09:58  lr: 0.000173  loss_ita: -0.0014  lr_temp_net: 0.00000328  loss_temp: -0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0021  time: 1.5238  data: 0.0244  max mem: 34806
Train Epoch: [21]  [1950/2244]  eta: 0:08:30  lr: 0.000173  loss_ita: -0.0012  lr_temp_net: 0.00000328  loss_temp: -0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0020  time: 1.4887  data: 0.0204  max mem: 34806
Train Epoch: [21]  [2000/2244]  eta: 0:07:02  lr: 0.000173  loss_ita: -0.0023  lr_temp_net: 0.00000328  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0021  time: 1.5024  data: 0.2602  max mem: 34806
Train Epoch: [21]  [2050/2244]  eta: 0:05:34  lr: 0.000173  loss_ita: -0.0011  lr_temp_net: 0.00000328  loss_temp: -0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0022  time: 1.5403  data: 0.2584  max mem: 34806
Train Epoch: [21]  [2100/2244]  eta: 0:04:08  lr: 0.000173  loss_ita: -0.0014  lr_temp_net: 0.00000328  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0023  time: 1.5110  data: 0.1474  max mem: 34806
Train Epoch: [21]  [2150/2244]  eta: 0:02:41  lr: 0.000173  loss_ita: -0.0019  lr_temp_net: 0.00000328  loss_temp: -0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0023  time: 1.6134  data: 0.0252  max mem: 34806
Train Epoch: [21]  [2200/2244]  eta: 0:01:15  lr: 0.000173  loss_ita: -0.0017  lr_temp_net: 0.00000328  loss_temp: -0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0024  time: 1.5304  data: 0.0225  max mem: 34806
Train Epoch: [21]  [2243/2244]  eta: 0:00:01  lr: 0.000173  loss_ita: -0.0023  lr_temp_net: 0.00000328  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0024  time: 1.6555  data: 0.0247  max mem: 34806
Train Epoch: [21] Total time: 1:04:07 (1.7147 s / it)
Averaged stats: lr: 0.0002  loss_ita: -0.0006  lr_temp_net: 0.0000  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0015
Computing features for evaluation...
Evaluation time 0:00:50
Computing features for evaluation...
Evaluation time 0:00:41
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:14
coco val: {'txt_r1': 41.0, 'txt_r5': 67.2, 'txt_r10': 77.06, 'txt_r_mean': 61.75333333333333, 'img_r1': 25.60575769692123, 'img_r5': 51.107556977209114, 'img_r10': 63.18672530987605, 'img_r_mean': 46.63334666133547, 'r_mean': 54.193339997334405}
coco test: {'txt_r1': 40.08, 'txt_r5': 66.62, 'txt_r10': 76.94, 'txt_r_mean': 61.21333333333333, 'img_r1': 25.4578168732507, 'img_r5': 50.80767692922831, 'img_r10': 62.77489004398241, 'img_r_mean': 46.346794615487134, 'r_mean': 53.78006397441023}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [22]  [   0/2244]  eta: 4:07:11  lr: 0.000141  loss_ita: -0.0019  lr_temp_net: 0.00000295  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0024  time: 6.6093  data: 4.5421  max mem: 34806
Train Epoch: [22]  [  50/2244]  eta: 1:04:37  lr: 0.000141  loss_ita: -0.0016  lr_temp_net: 0.00000295  loss_temp: -0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0025  time: 1.6144  data: 0.0204  max mem: 34806
Train Epoch: [22]  [ 100/2244]  eta: 0:58:27  lr: 0.000141  loss_ita: -0.0023  lr_temp_net: 0.00000295  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0025  time: 1.4981  data: 0.0252  max mem: 34806
Train Epoch: [22]  [ 150/2244]  eta: 0:55:26  lr: 0.000141  loss_ita: -0.0021  lr_temp_net: 0.00000295  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0025  time: 1.5305  data: 0.0215  max mem: 34806
Train Epoch: [22]  [ 200/2244]  eta: 0:53:29  lr: 0.000141  loss_ita: -0.0026  lr_temp_net: 0.00000295  loss_temp: -0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0027  time: 1.5733  data: 0.0210  max mem: 34806
Train Epoch: [22]  [ 250/2244]  eta: 0:51:52  lr: 0.000141  loss_ita: -0.0021  lr_temp_net: 0.00000295  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0027  time: 1.4236  data: 0.0236  max mem: 34806
Train Epoch: [22]  [ 300/2244]  eta: 0:50:28  lr: 0.000141  loss_ita: -0.0029  lr_temp_net: 0.00000295  loss_temp: -0.0098  avg_image_tau: 0.0010  avg_text_tau: 0.0027  time: 1.5662  data: 0.0233  max mem: 34806
Train Epoch: [22]  [ 350/2244]  eta: 0:49:14  lr: 0.000141  loss_ita: -0.0034  lr_temp_net: 0.00000295  loss_temp: -0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0029  time: 1.5864  data: 0.0286  max mem: 34806
Train Epoch: [22]  [ 400/2244]  eta: 0:48:15  lr: 0.000141  loss_ita: -0.0034  lr_temp_net: 0.00000295  loss_temp: -0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0029  time: 1.5952  data: 0.0282  max mem: 34806
Train Epoch: [22]  [ 450/2244]  eta: 0:46:47  lr: 0.000141  loss_ita: -0.0030  lr_temp_net: 0.00000295  loss_temp: -0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0029  time: 1.4782  data: 0.0267  max mem: 34806
Train Epoch: [22]  [ 500/2244]  eta: 0:45:19  lr: 0.000141  loss_ita: -0.0042  lr_temp_net: 0.00000295  loss_temp: -0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0030  time: 1.4824  data: 0.0209  max mem: 34806
Train Epoch: [22]  [ 550/2244]  eta: 0:43:58  lr: 0.000141  loss_ita: -0.0028  lr_temp_net: 0.00000295  loss_temp: -0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0031  time: 1.4807  data: 0.0272  max mem: 34806
Train Epoch: [22]  [ 600/2244]  eta: 0:42:45  lr: 0.000141  loss_ita: -0.0038  lr_temp_net: 0.00000295  loss_temp: -0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0031  time: 1.6229  data: 0.0256  max mem: 34806
Train Epoch: [22]  [ 650/2244]  eta: 0:41:32  lr: 0.000141  loss_ita: -0.0049  lr_temp_net: 0.00000295  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0031  time: 1.5796  data: 0.0278  max mem: 34806
Train Epoch: [22]  [ 700/2244]  eta: 0:40:16  lr: 0.000141  loss_ita: -0.0031  lr_temp_net: 0.00000295  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0031  time: 1.6034  data: 0.0249  max mem: 34806
Train Epoch: [22]  [ 750/2244]  eta: 0:39:02  lr: 0.000141  loss_ita: -0.0041  lr_temp_net: 0.00000295  loss_temp: -0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0032  time: 1.6407  data: 0.0277  max mem: 34806
Train Epoch: [22]  [ 800/2244]  eta: 0:37:43  lr: 0.000141  loss_ita: -0.0045  lr_temp_net: 0.00000295  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0033  time: 1.5971  data: 0.0275  max mem: 34806
Train Epoch: [22]  [ 850/2244]  eta: 0:36:23  lr: 0.000141  loss_ita: -0.0039  lr_temp_net: 0.00000295  loss_temp: -0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0033  time: 1.5571  data: 0.0259  max mem: 34806
Train Epoch: [22]  [ 900/2244]  eta: 0:35:03  lr: 0.000141  loss_ita: -0.0039  lr_temp_net: 0.00000295  loss_temp: -0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0034  time: 1.4654  data: 0.0234  max mem: 34806
Train Epoch: [22]  [ 950/2244]  eta: 0:33:43  lr: 0.000141  loss_ita: -0.0047  lr_temp_net: 0.00000295  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0035  time: 1.5052  data: 0.0251  max mem: 34806
Train Epoch: [22]  [1000/2244]  eta: 0:32:22  lr: 0.000141  loss_ita: -0.0050  lr_temp_net: 0.00000295  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0036  time: 1.4878  data: 0.0257  max mem: 34806
Train Epoch: [22]  [1050/2244]  eta: 0:31:01  lr: 0.000141  loss_ita: -0.0054  lr_temp_net: 0.00000295  loss_temp: -0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0036  time: 1.5641  data: 0.1871  max mem: 34806
Train Epoch: [22]  [1100/2244]  eta: 0:29:42  lr: 0.000141  loss_ita: -0.0051  lr_temp_net: 0.00000295  loss_temp: -0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0036  time: 1.5525  data: 0.2612  max mem: 34806
Train Epoch: [22]  [1150/2244]  eta: 0:28:23  lr: 0.000141  loss_ita: -0.0059  lr_temp_net: 0.00000295  loss_temp: -0.0096  avg_image_tau: 0.0011  avg_text_tau: 0.0037  time: 1.5275  data: 0.0404  max mem: 34806
Train Epoch: [22]  [1200/2244]  eta: 0:27:07  lr: 0.000141  loss_ita: -0.0044  lr_temp_net: 0.00000295  loss_temp: -0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0037  time: 1.5793  data: 0.0233  max mem: 34806
Train Epoch: [22]  [1250/2244]  eta: 0:25:47  lr: 0.000141  loss_ita: -0.0057  lr_temp_net: 0.00000295  loss_temp: -0.0110  avg_image_tau: 0.0011  avg_text_tau: 0.0038  time: 1.5262  data: 0.0226  max mem: 34806
Train Epoch: [22]  [1300/2244]  eta: 0:24:29  lr: 0.000141  loss_ita: -0.0050  lr_temp_net: 0.00000295  loss_temp: -0.0110  avg_image_tau: 0.0011  avg_text_tau: 0.0038  time: 1.5206  data: 0.0247  max mem: 34806
Train Epoch: [22]  [1350/2244]  eta: 0:23:11  lr: 0.000141  loss_ita: -0.0058  lr_temp_net: 0.00000295  loss_temp: -0.0112  avg_image_tau: 0.0011  avg_text_tau: 0.0038  time: 1.5496  data: 0.0302  max mem: 34806
Train Epoch: [22]  [1400/2244]  eta: 0:21:54  lr: 0.000141  loss_ita: -0.0061  lr_temp_net: 0.00000295  loss_temp: -0.0118  avg_image_tau: 0.0011  avg_text_tau: 0.0039  time: 1.5512  data: 0.0240  max mem: 34806
Train Epoch: [22]  [1450/2244]  eta: 0:20:36  lr: 0.000141  loss_ita: -0.0050  lr_temp_net: 0.00000295  loss_temp: -0.0106  avg_image_tau: 0.0011  avg_text_tau: 0.0040  time: 1.5519  data: 0.0268  max mem: 34806
Train Epoch: [22]  [1500/2244]  eta: 0:19:16  lr: 0.000141  loss_ita: -0.0050  lr_temp_net: 0.00000295  loss_temp: -0.0100  avg_image_tau: 0.0011  avg_text_tau: 0.0040  time: 1.4483  data: 0.0227  max mem: 34806
Train Epoch: [22]  [1550/2244]  eta: 0:17:58  lr: 0.000141  loss_ita: -0.0058  lr_temp_net: 0.00000295  loss_temp: -0.0090  avg_image_tau: 0.0011  avg_text_tau: 0.0040  time: 1.5731  data: 0.0296  max mem: 34806
Train Epoch: [22]  [1600/2244]  eta: 0:16:40  lr: 0.000141  loss_ita: -0.0065  lr_temp_net: 0.00000295  loss_temp: -0.0093  avg_image_tau: 0.0011  avg_text_tau: 0.0040  time: 1.5535  data: 0.0265  max mem: 34806
Train Epoch: [22]  [1650/2244]  eta: 0:15:22  lr: 0.000141  loss_ita: -0.0054  lr_temp_net: 0.00000295  loss_temp: -0.0107  avg_image_tau: 0.0011  avg_text_tau: 0.0041  time: 1.5784  data: 0.1208  max mem: 34806
Train Epoch: [22]  [1700/2244]  eta: 0:14:22  lr: 0.000141  loss_ita: -0.0056  lr_temp_net: 0.00000295  loss_temp: -0.0112  avg_image_tau: 0.0011  avg_text_tau: 0.0043  time: 4.2103  data: 0.0253  max mem: 34806
Train Epoch: [22]  [1750/2244]  eta: 0:13:14  lr: 0.000141  loss_ita: -0.0064  lr_temp_net: 0.00000295  loss_temp: -0.0123  avg_image_tau: 0.0011  avg_text_tau: 0.0042  time: 3.0915  data: 0.0344  max mem: 34806
Train Epoch: [22]  [1800/2244]  eta: 0:11:54  lr: 0.000141  loss_ita: -0.0069  lr_temp_net: 0.00000295  loss_temp: -0.0112  avg_image_tau: 0.0012  avg_text_tau: 0.0043  time: 1.6833  data: 0.0307  max mem: 34806
Train Epoch: [22]  [1850/2244]  eta: 0:10:33  lr: 0.000141  loss_ita: -0.0066  lr_temp_net: 0.00000295  loss_temp: -0.0088  avg_image_tau: 0.0012  avg_text_tau: 0.0043  time: 1.5642  data: 0.0255  max mem: 34806
Train Epoch: [22]  [1900/2244]  eta: 0:09:13  lr: 0.000141  loss_ita: -0.0057  lr_temp_net: 0.00000295  loss_temp: -0.0126  avg_image_tau: 0.0012  avg_text_tau: 0.0044  time: 1.5289  data: 0.0488  max mem: 34806
Train Epoch: [22]  [1950/2244]  eta: 0:07:52  lr: 0.000141  loss_ita: -0.0057  lr_temp_net: 0.00000295  loss_temp: -0.0112  avg_image_tau: 0.0012  avg_text_tau: 0.0044  time: 1.5973  data: 0.0264  max mem: 34806
Train Epoch: [22]  [2000/2244]  eta: 0:06:31  lr: 0.000141  loss_ita: -0.0066  lr_temp_net: 0.00000295  loss_temp: -0.0114  avg_image_tau: 0.0012  avg_text_tau: 0.0044  time: 1.5396  data: 0.0255  max mem: 34806
Train Epoch: [22]  [2050/2244]  eta: 0:05:11  lr: 0.000141  loss_ita: -0.0079  lr_temp_net: 0.00000295  loss_temp: -0.0105  avg_image_tau: 0.0012  avg_text_tau: 0.0045  time: 1.5515  data: 0.0298  max mem: 34806
Train Epoch: [22]  [2100/2244]  eta: 0:03:51  lr: 0.000141  loss_ita: -0.0071  lr_temp_net: 0.00000295  loss_temp: -0.0118  avg_image_tau: 0.0012  avg_text_tau: 0.0045  time: 1.5663  data: 0.0286  max mem: 34806
Train Epoch: [22]  [2150/2244]  eta: 0:02:30  lr: 0.000141  loss_ita: -0.0057  lr_temp_net: 0.00000295  loss_temp: -0.0089  avg_image_tau: 0.0013  avg_text_tau: 0.0046  time: 1.6343  data: 0.0267  max mem: 34806
Train Epoch: [22]  [2200/2244]  eta: 0:01:10  lr: 0.000141  loss_ita: -0.0067  lr_temp_net: 0.00000295  loss_temp: -0.0101  avg_image_tau: 0.0013  avg_text_tau: 0.0046  time: 1.5515  data: 0.0421  max mem: 34806
Train Epoch: [22]  [2243/2244]  eta: 0:00:01  lr: 0.000141  loss_ita: -0.0086  lr_temp_net: 0.00000295  loss_temp: -0.0135  avg_image_tau: 0.0013  avg_text_tau: 0.0046  time: 1.7682  data: 0.0341  max mem: 34806
Train Epoch: [22] Total time: 1:00:04 (1.6063 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0048  lr_temp_net: 0.0000  loss_temp: -0.0102  avg_image_tau: 0.0011  avg_text_tau: 0.0036
Computing features for evaluation...
Evaluation time 0:00:59
Computing features for evaluation...
Evaluation time 0:00:48
Computing features for evaluation...
Evaluation time 0:00:18
Computing features for evaluation...
Evaluation time 0:00:15
coco val: {'txt_r1': 43.0, 'txt_r5': 67.44, 'txt_r10': 77.38, 'txt_r_mean': 62.60666666666666, 'img_r1': 26.017592962814874, 'img_r5': 51.24750099960016, 'img_r10': 63.43062774890044, 'img_r_mean': 46.898573903771826, 'r_mean': 54.752620285219244}
coco test: {'txt_r1': 40.66, 'txt_r5': 66.74, 'txt_r10': 76.64, 'txt_r_mean': 61.346666666666664, 'img_r1': 25.705717712914833, 'img_r5': 50.80367852858856, 'img_r10': 62.499000399840064, 'img_r_mean': 46.336132213781156, 'r_mean': 53.84139944022391}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [23]  [   0/2244]  eta: 7:46:40  lr: 0.000111  loss_ita: -0.0067  lr_temp_net: 0.00000266  loss_temp: -0.0100  avg_image_tau: 0.0013  avg_text_tau: 0.0045  time: 12.4780  data: 5.4213  max mem: 34806
Train Epoch: [23]  [  50/2244]  eta: 1:09:02  lr: 0.000111  loss_ita: -0.0062  lr_temp_net: 0.00000266  loss_temp: -0.0105  avg_image_tau: 0.0013  avg_text_tau: 0.0047  time: 1.5383  data: 0.0831  max mem: 34806
Train Epoch: [23]  [ 100/2244]  eta: 1:03:06  lr: 0.000111  loss_ita: -0.0062  lr_temp_net: 0.00000266  loss_temp: -0.0100  avg_image_tau: 0.0014  avg_text_tau: 0.0047  time: 1.6538  data: 0.2254  max mem: 34806
Train Epoch: [23]  [ 150/2244]  eta: 1:06:26  lr: 0.000111  loss_ita: -0.0061  lr_temp_net: 0.00000266  loss_temp: -0.0124  avg_image_tau: 0.0014  avg_text_tau: 0.0047  time: 2.9703  data: 0.0548  max mem: 34806
Train Epoch: [23]  [ 200/2244]  eta: 1:02:21  lr: 0.000111  loss_ita: -0.0088  lr_temp_net: 0.00000266  loss_temp: -0.0123  avg_image_tau: 0.0014  avg_text_tau: 0.0048  time: 1.5431  data: 0.1830  max mem: 34806
Train Epoch: [23]  [ 250/2244]  eta: 0:59:08  lr: 0.000111  loss_ita: -0.0068  lr_temp_net: 0.00000266  loss_temp: -0.0103  avg_image_tau: 0.0014  avg_text_tau: 0.0049  time: 1.6140  data: 0.0476  max mem: 34806
Train Epoch: [23]  [ 300/2244]  eta: 0:56:34  lr: 0.000111  loss_ita: -0.0085  lr_temp_net: 0.00000266  loss_temp: -0.0117  avg_image_tau: 0.0014  avg_text_tau: 0.0049  time: 1.6273  data: 0.0322  max mem: 34806
Train Epoch: [23]  [ 350/2244]  eta: 0:54:21  lr: 0.000111  loss_ita: -0.0090  lr_temp_net: 0.00000266  loss_temp: -0.0146  avg_image_tau: 0.0015  avg_text_tau: 0.0049  time: 1.6312  data: 0.0290  max mem: 34806
Train Epoch: [23]  [ 400/2244]  eta: 0:52:44  lr: 0.000111  loss_ita: -0.0067  lr_temp_net: 0.00000266  loss_temp: -0.0114  avg_image_tau: 0.0015  avg_text_tau: 0.0049  time: 1.7977  data: 0.0279  max mem: 34806
Train Epoch: [23]  [ 450/2244]  eta: 0:51:03  lr: 0.000111  loss_ita: -0.0091  lr_temp_net: 0.00000266  loss_temp: -0.0118  avg_image_tau: 0.0015  avg_text_tau: 0.0050  time: 1.6960  data: 0.0314  max mem: 34806
Train Epoch: [23]  [ 500/2244]  eta: 0:49:17  lr: 0.000111  loss_ita: -0.0088  lr_temp_net: 0.00000266  loss_temp: -0.0125  avg_image_tau: 0.0015  avg_text_tau: 0.0051  time: 1.5810  data: 0.0325  max mem: 34806
Train Epoch: [23]  [ 550/2244]  eta: 0:47:39  lr: 0.000111  loss_ita: -0.0091  lr_temp_net: 0.00000266  loss_temp: -0.0125  avg_image_tau: 0.0016  avg_text_tau: 0.0051  time: 1.6379  data: 0.0312  max mem: 34806
Train Epoch: [23]  [ 600/2244]  eta: 0:46:11  lr: 0.000111  loss_ita: -0.0085  lr_temp_net: 0.00000266  loss_temp: -0.0142  avg_image_tau: 0.0016  avg_text_tau: 0.0051  time: 1.7190  data: 0.0425  max mem: 34806
Train Epoch: [23]  [ 650/2244]  eta: 0:44:57  lr: 0.000111  loss_ita: -0.0098  lr_temp_net: 0.00000266  loss_temp: -0.0116  avg_image_tau: 0.0016  avg_text_tau: 0.0051  time: 1.7061  data: 0.0270  max mem: 34806
Train Epoch: [23]  [ 700/2244]  eta: 0:43:26  lr: 0.000111  loss_ita: -0.0106  lr_temp_net: 0.00000266  loss_temp: -0.0119  avg_image_tau: 0.0017  avg_text_tau: 0.0051  time: 1.5295  data: 0.0338  max mem: 34806
Train Epoch: [23]  [ 750/2244]  eta: 0:41:49  lr: 0.000111  loss_ita: -0.0111  lr_temp_net: 0.00000266  loss_temp: -0.0115  avg_image_tau: 0.0017  avg_text_tau: 0.0052  time: 1.4975  data: 0.0254  max mem: 34806
Train Epoch: [23]  [ 800/2244]  eta: 0:40:17  lr: 0.000111  loss_ita: -0.0093  lr_temp_net: 0.00000266  loss_temp: -0.0134  avg_image_tau: 0.0017  avg_text_tau: 0.0053  time: 1.6366  data: 0.0330  max mem: 34806
Train Epoch: [23]  [ 850/2244]  eta: 0:38:45  lr: 0.000111  loss_ita: -0.0110  lr_temp_net: 0.00000266  loss_temp: -0.0134  avg_image_tau: 0.0018  avg_text_tau: 0.0053  time: 1.5695  data: 0.0276  max mem: 34806
Train Epoch: [23]  [ 900/2244]  eta: 0:37:13  lr: 0.000111  loss_ita: -0.0116  lr_temp_net: 0.00000266  loss_temp: -0.0139  avg_image_tau: 0.0018  avg_text_tau: 0.0054  time: 1.5525  data: 0.0237  max mem: 34806
Train Epoch: [23]  [ 950/2244]  eta: 0:35:44  lr: 0.000111  loss_ita: -0.0106  lr_temp_net: 0.00000266  loss_temp: -0.0154  avg_image_tau: 0.0018  avg_text_tau: 0.0055  time: 1.5693  data: 0.0826  max mem: 34806
Train Epoch: [23]  [1000/2244]  eta: 0:34:25  lr: 0.000111  loss_ita: -0.0120  lr_temp_net: 0.00000266  loss_temp: -0.0116  avg_image_tau: 0.0019  avg_text_tau: 0.0055  time: 1.6921  data: 0.1093  max mem: 34806
Train Epoch: [23]  [1050/2244]  eta: 0:33:03  lr: 0.000111  loss_ita: -0.0090  lr_temp_net: 0.00000266  loss_temp: -0.0118  avg_image_tau: 0.0019  avg_text_tau: 0.0055  time: 1.6622  data: 0.2114  max mem: 34806
Train Epoch: [23]  [1100/2244]  eta: 0:31:40  lr: 0.000111  loss_ita: -0.0105  lr_temp_net: 0.00000266  loss_temp: -0.0140  avg_image_tau: 0.0020  avg_text_tau: 0.0055  time: 1.5702  data: 0.1942  max mem: 34806
Train Epoch: [23]  [1150/2244]  eta: 0:30:10  lr: 0.000111  loss_ita: -0.0104  lr_temp_net: 0.00000266  loss_temp: -0.0137  avg_image_tau: 0.0020  avg_text_tau: 0.0056  time: 1.5336  data: 0.2022  max mem: 34806
Train Epoch: [23]  [1200/2244]  eta: 0:28:43  lr: 0.000111  loss_ita: -0.0094  lr_temp_net: 0.00000266  loss_temp: -0.0132  avg_image_tau: 0.0020  avg_text_tau: 0.0056  time: 1.5170  data: 0.2010  max mem: 34806
Train Epoch: [23]  [1250/2244]  eta: 0:27:19  lr: 0.000111  loss_ita: -0.0113  lr_temp_net: 0.00000266  loss_temp: -0.0144  avg_image_tau: 0.0020  avg_text_tau: 0.0056  time: 1.5962  data: 0.0265  max mem: 34806
Train Epoch: [23]  [1300/2244]  eta: 0:25:54  lr: 0.000111  loss_ita: -0.0116  lr_temp_net: 0.00000266  loss_temp: -0.0112  avg_image_tau: 0.0021  avg_text_tau: 0.0057  time: 1.6254  data: 0.0242  max mem: 34806
Train Epoch: [23]  [1350/2244]  eta: 0:24:28  lr: 0.000111  loss_ita: -0.0113  lr_temp_net: 0.00000266  loss_temp: -0.0116  avg_image_tau: 0.0021  avg_text_tau: 0.0057  time: 1.5397  data: 0.0270  max mem: 34806
Train Epoch: [23]  [1400/2244]  eta: 0:23:06  lr: 0.000111  loss_ita: -0.0126  lr_temp_net: 0.00000266  loss_temp: -0.0120  avg_image_tau: 0.0022  avg_text_tau: 0.0057  time: 1.6410  data: 0.2085  max mem: 34806
Train Epoch: [23]  [1450/2244]  eta: 0:21:44  lr: 0.000111  loss_ita: -0.0112  lr_temp_net: 0.00000266  loss_temp: -0.0130  avg_image_tau: 0.0022  avg_text_tau: 0.0057  time: 1.6726  data: 0.2442  max mem: 34806
Train Epoch: [23]  [1500/2244]  eta: 0:20:21  lr: 0.000111  loss_ita: -0.0093  lr_temp_net: 0.00000266  loss_temp: -0.0129  avg_image_tau: 0.0022  avg_text_tau: 0.0057  time: 1.5302  data: 0.1978  max mem: 34806
Train Epoch: [23]  [1550/2244]  eta: 0:18:59  lr: 0.000111  loss_ita: -0.0116  lr_temp_net: 0.00000266  loss_temp: -0.0129  avg_image_tau: 0.0022  avg_text_tau: 0.0058  time: 1.6359  data: 0.0568  max mem: 34806
Train Epoch: [23]  [1600/2244]  eta: 0:17:37  lr: 0.000111  loss_ita: -0.0124  lr_temp_net: 0.00000266  loss_temp: -0.0155  avg_image_tau: 0.0023  avg_text_tau: 0.0060  time: 1.6693  data: 0.1133  max mem: 34806
Train Epoch: [23]  [1650/2244]  eta: 0:16:15  lr: 0.000111  loss_ita: -0.0123  lr_temp_net: 0.00000266  loss_temp: -0.0112  avg_image_tau: 0.0024  avg_text_tau: 0.0061  time: 1.5503  data: 0.2254  max mem: 34806
Train Epoch: [23]  [1700/2244]  eta: 0:14:52  lr: 0.000111  loss_ita: -0.0139  lr_temp_net: 0.00000266  loss_temp: -0.0122  avg_image_tau: 0.0024  avg_text_tau: 0.0061  time: 1.5712  data: 0.0648  max mem: 34806
Train Epoch: [23]  [1750/2244]  eta: 0:13:29  lr: 0.000111  loss_ita: -0.0093  lr_temp_net: 0.00000266  loss_temp: -0.0107  avg_image_tau: 0.0025  avg_text_tau: 0.0060  time: 1.5904  data: 0.0288  max mem: 34806
Train Epoch: [23]  [1800/2244]  eta: 0:12:07  lr: 0.000111  loss_ita: -0.0118  lr_temp_net: 0.00000266  loss_temp: -0.0118  avg_image_tau: 0.0024  avg_text_tau: 0.0061  time: 1.6122  data: 0.0264  max mem: 34806
Train Epoch: [23]  [1850/2244]  eta: 0:10:44  lr: 0.000111  loss_ita: -0.0148  lr_temp_net: 0.00000266  loss_temp: -0.0136  avg_image_tau: 0.0025  avg_text_tau: 0.0062  time: 1.5609  data: 0.0289  max mem: 34806
Train Epoch: [23]  [1900/2244]  eta: 0:09:23  lr: 0.000111  loss_ita: -0.0124  lr_temp_net: 0.00000266  loss_temp: -0.0118  avg_image_tau: 0.0025  avg_text_tau: 0.0062  time: 1.5548  data: 0.0300  max mem: 34806
Train Epoch: [23]  [1950/2244]  eta: 0:08:03  lr: 0.000111  loss_ita: -0.0130  lr_temp_net: 0.00000266  loss_temp: -0.0103  avg_image_tau: 0.0025  avg_text_tau: 0.0062  time: 1.8129  data: 0.0288  max mem: 34806
Train Epoch: [23]  [2000/2244]  eta: 0:06:41  lr: 0.000111  loss_ita: -0.0114  lr_temp_net: 0.00000266  loss_temp: -0.0121  avg_image_tau: 0.0026  avg_text_tau: 0.0062  time: 1.6856  data: 0.0340  max mem: 34806
Train Epoch: [23]  [2050/2244]  eta: 0:05:19  lr: 0.000111  loss_ita: -0.0124  lr_temp_net: 0.00000266  loss_temp: -0.0141  avg_image_tau: 0.0027  avg_text_tau: 0.0062  time: 1.6048  data: 0.0327  max mem: 34806
Train Epoch: [23]  [2100/2244]  eta: 0:03:57  lr: 0.000111  loss_ita: -0.0126  lr_temp_net: 0.00000266  loss_temp: -0.0112  avg_image_tau: 0.0027  avg_text_tau: 0.0062  time: 1.6536  data: 0.0331  max mem: 34806
Train Epoch: [23]  [2150/2244]  eta: 0:02:34  lr: 0.000111  loss_ita: -0.0114  lr_temp_net: 0.00000266  loss_temp: -0.0142  avg_image_tau: 0.0027  avg_text_tau: 0.0063  time: 1.5916  data: 0.0277  max mem: 34806
Train Epoch: [23]  [2200/2244]  eta: 0:01:12  lr: 0.000111  loss_ita: -0.0138  lr_temp_net: 0.00000266  loss_temp: -0.0129  avg_image_tau: 0.0027  avg_text_tau: 0.0064  time: 1.6925  data: 0.0378  max mem: 34806
Train Epoch: [23]  [2243/2244]  eta: 0:00:01  lr: 0.000111  loss_ita: -0.0167  lr_temp_net: 0.00000266  loss_temp: -0.0093  avg_image_tau: 0.0027  avg_text_tau: 0.0063  time: 1.6682  data: 0.0283  max mem: 34806
Train Epoch: [23] Total time: 1:01:43 (1.6504 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0106  lr_temp_net: 0.0000  loss_temp: -0.0122  avg_image_tau: 0.0020  avg_text_tau: 0.0055
Computing features for evaluation...
Evaluation time 0:01:04
Computing features for evaluation...
Evaluation time 0:01:04
Computing features for evaluation...
Evaluation time 0:00:21
Computing features for evaluation...
Evaluation time 0:00:21
coco val: {'txt_r1': 43.06, 'txt_r5': 68.72, 'txt_r10': 77.94, 'txt_r_mean': 63.24, 'img_r1': 26.673330667732905, 'img_r5': 51.8312674930028, 'img_r10': 63.758496601359454, 'img_r_mean': 47.42103158736504, 'r_mean': 55.33051579368252}
coco test: {'txt_r1': 41.62, 'txt_r5': 68.16, 'txt_r10': 77.98, 'txt_r_mean': 62.586666666666666, 'img_r1': 26.34546181527389, 'img_r5': 51.33546581367453, 'img_r10': 62.85485805677729, 'img_r_mean': 46.84526189524191, 'r_mean': 54.71596428095429}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [24]  [   0/2244]  eta: 9:44:20  lr: 0.000085  loss_ita: -0.0124  lr_temp_net: 0.00000239  loss_temp: -0.0109  avg_image_tau: 0.0027  avg_text_tau: 0.0063  time: 15.6239  data: 7.5313  max mem: 34806
Train Epoch: [24]  [  50/2244]  eta: 1:19:52  lr: 0.000085  loss_ita: -0.0139  lr_temp_net: 0.00000239  loss_temp: -0.0097  avg_image_tau: 0.0028  avg_text_tau: 0.0065  time: 1.6961  data: 0.1819  max mem: 34806
Train Epoch: [24]  [ 100/2244]  eta: 1:08:08  lr: 0.000085  loss_ita: -0.0118  lr_temp_net: 0.00000239  loss_temp: -0.0123  avg_image_tau: 0.0029  avg_text_tau: 0.0064  time: 1.6559  data: 0.2648  max mem: 34806
Train Epoch: [24]  [ 150/2244]  eta: 1:03:16  lr: 0.000085  loss_ita: -0.0132  lr_temp_net: 0.00000239  loss_temp: -0.0104  avg_image_tau: 0.0029  avg_text_tau: 0.0065  time: 1.6198  data: 0.0758  max mem: 34806
Train Epoch: [24]  [ 200/2244]  eta: 1:00:33  lr: 0.000085  loss_ita: -0.0149  lr_temp_net: 0.00000239  loss_temp: -0.0115  avg_image_tau: 0.0029  avg_text_tau: 0.0065  time: 1.7986  data: 0.1681  max mem: 34806
Train Epoch: [24]  [ 250/2244]  eta: 0:59:38  lr: 0.000085  loss_ita: -0.0119  lr_temp_net: 0.00000239  loss_temp: -0.0106  avg_image_tau: 0.0030  avg_text_tau: 0.0065  time: 1.5219  data: 0.0679  max mem: 34806
Train Epoch: [24]  [ 300/2244]  eta: 0:56:54  lr: 0.000085  loss_ita: -0.0143  lr_temp_net: 0.00000239  loss_temp: -0.0146  avg_image_tau: 0.0030  avg_text_tau: 0.0065  time: 1.5748  data: 0.0191  max mem: 34806
Train Epoch: [24]  [ 350/2244]  eta: 0:54:36  lr: 0.000085  loss_ita: -0.0159  lr_temp_net: 0.00000239  loss_temp: -0.0088  avg_image_tau: 0.0030  avg_text_tau: 0.0066  time: 1.5584  data: 0.0269  max mem: 34806
Train Epoch: [24]  [ 400/2244]  eta: 0:52:35  lr: 0.000085  loss_ita: -0.0143  lr_temp_net: 0.00000239  loss_temp: -0.0105  avg_image_tau: 0.0030  avg_text_tau: 0.0066  time: 1.5488  data: 0.0281  max mem: 34806
Train Epoch: [24]  [ 450/2244]  eta: 0:50:40  lr: 0.000085  loss_ita: -0.0177  lr_temp_net: 0.00000239  loss_temp: -0.0117  avg_image_tau: 0.0030  avg_text_tau: 0.0067  time: 1.5519  data: 0.1100  max mem: 34806
Train Epoch: [24]  [ 500/2244]  eta: 0:49:34  lr: 0.000085  loss_ita: -0.0174  lr_temp_net: 0.00000239  loss_temp: -0.0105  avg_image_tau: 0.0031  avg_text_tau: 0.0067  time: 1.8814  data: 0.3173  max mem: 34806
Train Epoch: [24]  [ 550/2244]  eta: 0:47:54  lr: 0.000085  loss_ita: -0.0160  lr_temp_net: 0.00000239  loss_temp: -0.0121  avg_image_tau: 0.0031  avg_text_tau: 0.0067  time: 1.5472  data: 0.1919  max mem: 34806
Train Epoch: [24]  [ 600/2244]  eta: 0:46:24  lr: 0.000085  loss_ita: -0.0171  lr_temp_net: 0.00000239  loss_temp: -0.0136  avg_image_tau: 0.0031  avg_text_tau: 0.0068  time: 1.6901  data: 0.2366  max mem: 34806
Train Epoch: [24]  [ 650/2244]  eta: 0:44:49  lr: 0.000085  loss_ita: -0.0163  lr_temp_net: 0.00000239  loss_temp: -0.0103  avg_image_tau: 0.0032  avg_text_tau: 0.0068  time: 1.6204  data: 0.2725  max mem: 34806
Train Epoch: [24]  [ 700/2244]  eta: 0:43:21  lr: 0.000085  loss_ita: -0.0183  lr_temp_net: 0.00000239  loss_temp: -0.0094  avg_image_tau: 0.0033  avg_text_tau: 0.0069  time: 1.6460  data: 0.0595  max mem: 34806
Train Epoch: [24]  [ 750/2244]  eta: 0:41:54  lr: 0.000085  loss_ita: -0.0182  lr_temp_net: 0.00000239  loss_temp: -0.0062  avg_image_tau: 0.0032  avg_text_tau: 0.0068  time: 1.6488  data: 0.0324  max mem: 34806
Train Epoch: [24]  [ 800/2244]  eta: 0:40:23  lr: 0.000085  loss_ita: -0.0164  lr_temp_net: 0.00000239  loss_temp: -0.0113  avg_image_tau: 0.0033  avg_text_tau: 0.0069  time: 1.6098  data: 0.0271  max mem: 34806
Train Epoch: [24]  [ 850/2244]  eta: 0:38:52  lr: 0.000085  loss_ita: -0.0180  lr_temp_net: 0.00000239  loss_temp: -0.0111  avg_image_tau: 0.0033  avg_text_tau: 0.0069  time: 1.5852  data: 0.0334  max mem: 34806
Train Epoch: [24]  [ 900/2244]  eta: 0:37:17  lr: 0.000085  loss_ita: -0.0167  lr_temp_net: 0.00000239  loss_temp: -0.0088  avg_image_tau: 0.0034  avg_text_tau: 0.0071  time: 1.5556  data: 0.2313  max mem: 34806
Train Epoch: [24]  [ 950/2244]  eta: 0:35:51  lr: 0.000085  loss_ita: -0.0159  lr_temp_net: 0.00000239  loss_temp: -0.0082  avg_image_tau: 0.0033  avg_text_tau: 0.0070  time: 1.6324  data: 0.2270  max mem: 34806
Train Epoch: [24]  [1000/2244]  eta: 0:34:26  lr: 0.000085  loss_ita: -0.0186  lr_temp_net: 0.00000239  loss_temp: -0.0079  avg_image_tau: 0.0034  avg_text_tau: 0.0070  time: 1.5944  data: 0.2207  max mem: 34806
Train Epoch: [24]  [1050/2244]  eta: 0:33:00  lr: 0.000085  loss_ita: -0.0164  lr_temp_net: 0.00000239  loss_temp: -0.0112  avg_image_tau: 0.0035  avg_text_tau: 0.0071  time: 1.5984  data: 0.2835  max mem: 34806
Train Epoch: [24]  [1100/2244]  eta: 0:31:32  lr: 0.000085  loss_ita: -0.0174  lr_temp_net: 0.00000239  loss_temp: -0.0094  avg_image_tau: 0.0035  avg_text_tau: 0.0071  time: 1.5267  data: 0.1813  max mem: 34806
Train Epoch: [24]  [1150/2244]  eta: 0:30:05  lr: 0.000085  loss_ita: -0.0203  lr_temp_net: 0.00000239  loss_temp: -0.0105  avg_image_tau: 0.0036  avg_text_tau: 0.0072  time: 1.5821  data: 0.0948  max mem: 34806
Train Epoch: [24]  [1200/2244]  eta: 0:28:42  lr: 0.000085  loss_ita: -0.0189  lr_temp_net: 0.00000239  loss_temp: -0.0051  avg_image_tau: 0.0035  avg_text_tau: 0.0071  time: 1.6183  data: 0.0251  max mem: 34806
Train Epoch: [24]  [1250/2244]  eta: 0:27:16  lr: 0.000085  loss_ita: -0.0188  lr_temp_net: 0.00000239  loss_temp: -0.0129  avg_image_tau: 0.0036  avg_text_tau: 0.0072  time: 1.5142  data: 0.0274  max mem: 34806
Train Epoch: [24]  [1300/2244]  eta: 0:25:53  lr: 0.000085  loss_ita: -0.0180  lr_temp_net: 0.00000239  loss_temp: -0.0089  avg_image_tau: 0.0036  avg_text_tau: 0.0072  time: 1.6118  data: 0.0260  max mem: 34806
Train Epoch: [24]  [1350/2244]  eta: 0:24:30  lr: 0.000085  loss_ita: -0.0187  lr_temp_net: 0.00000239  loss_temp: -0.0102  avg_image_tau: 0.0036  avg_text_tau: 0.0073  time: 1.6376  data: 0.0342  max mem: 34806
Train Epoch: [24]  [1400/2244]  eta: 0:23:06  lr: 0.000085  loss_ita: -0.0185  lr_temp_net: 0.00000239  loss_temp: -0.0118  avg_image_tau: 0.0036  avg_text_tau: 0.0073  time: 1.6007  data: 0.2443  max mem: 34806
Train Epoch: [24]  [1450/2244]  eta: 0:21:42  lr: 0.000085  loss_ita: -0.0185  lr_temp_net: 0.00000239  loss_temp: -0.0102  avg_image_tau: 0.0038  avg_text_tau: 0.0073  time: 1.5988  data: 0.2399  max mem: 34806
Train Epoch: [24]  [1500/2244]  eta: 0:20:17  lr: 0.000085  loss_ita: -0.0191  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0037  avg_text_tau: 0.0073  time: 1.5194  data: 0.0582  max mem: 34806
Train Epoch: [24]  [1550/2244]  eta: 0:18:53  lr: 0.000085  loss_ita: -0.0172  lr_temp_net: 0.00000239  loss_temp: -0.0075  avg_image_tau: 0.0037  avg_text_tau: 0.0073  time: 1.5409  data: 0.2151  max mem: 34806
Train Epoch: [24]  [1600/2244]  eta: 0:17:30  lr: 0.000085  loss_ita: -0.0209  lr_temp_net: 0.00000239  loss_temp: -0.0078  avg_image_tau: 0.0038  avg_text_tau: 0.0074  time: 1.5440  data: 0.1997  max mem: 34806
Train Epoch: [24]  [1650/2244]  eta: 0:16:07  lr: 0.000085  loss_ita: -0.0214  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0038  avg_text_tau: 0.0074  time: 1.5705  data: 0.2272  max mem: 34806
Train Epoch: [24]  [1700/2244]  eta: 0:14:45  lr: 0.000085  loss_ita: -0.0196  lr_temp_net: 0.00000239  loss_temp: -0.0066  avg_image_tau: 0.0039  avg_text_tau: 0.0075  time: 1.5966  data: 0.1678  max mem: 34806
Train Epoch: [24]  [1750/2244]  eta: 0:13:25  lr: 0.000085  loss_ita: -0.0190  lr_temp_net: 0.00000239  loss_temp: -0.0094  avg_image_tau: 0.0038  avg_text_tau: 0.0075  time: 1.8075  data: 0.0303  max mem: 34806
Train Epoch: [24]  [1800/2244]  eta: 0:12:04  lr: 0.000085  loss_ita: -0.0190  lr_temp_net: 0.00000239  loss_temp: -0.0097  avg_image_tau: 0.0039  avg_text_tau: 0.0076  time: 1.6574  data: 0.2228  max mem: 34806
Train Epoch: [24]  [1850/2244]  eta: 0:10:42  lr: 0.000085  loss_ita: -0.0227  lr_temp_net: 0.00000239  loss_temp: -0.0073  avg_image_tau: 0.0040  avg_text_tau: 0.0076  time: 1.6539  data: 0.2128  max mem: 34806
Train Epoch: [24]  [1900/2244]  eta: 0:09:19  lr: 0.000085  loss_ita: -0.0203  lr_temp_net: 0.00000239  loss_temp: -0.0080  avg_image_tau: 0.0040  avg_text_tau: 0.0076  time: 1.6036  data: 0.0261  max mem: 34806
Train Epoch: [24]  [1950/2244]  eta: 0:07:58  lr: 0.000085  loss_ita: -0.0205  lr_temp_net: 0.00000239  loss_temp: -0.0066  avg_image_tau: 0.0039  avg_text_tau: 0.0077  time: 1.6631  data: 0.2243  max mem: 34806
Train Epoch: [24]  [2000/2244]  eta: 0:06:36  lr: 0.000085  loss_ita: -0.0194  lr_temp_net: 0.00000239  loss_temp: -0.0085  avg_image_tau: 0.0039  avg_text_tau: 0.0076  time: 1.6471  data: 0.2559  max mem: 34806
Train Epoch: [24]  [2050/2244]  eta: 0:05:15  lr: 0.000085  loss_ita: -0.0213  lr_temp_net: 0.00000239  loss_temp: -0.0060  avg_image_tau: 0.0040  avg_text_tau: 0.0076  time: 1.5459  data: 0.2261  max mem: 34806
Train Epoch: [24]  [2100/2244]  eta: 0:03:54  lr: 0.000085  loss_ita: -0.0208  lr_temp_net: 0.00000239  loss_temp: -0.0104  avg_image_tau: 0.0040  avg_text_tau: 0.0077  time: 1.6483  data: 0.0460  max mem: 34806
Train Epoch: [24]  [2150/2244]  eta: 0:02:32  lr: 0.000085  loss_ita: -0.0183  lr_temp_net: 0.00000239  loss_temp: -0.0059  avg_image_tau: 0.0040  avg_text_tau: 0.0078  time: 1.4895  data: 0.0226  max mem: 34806
Train Epoch: [24]  [2200/2244]  eta: 0:01:11  lr: 0.000085  loss_ita: -0.0187  lr_temp_net: 0.00000239  loss_temp: -0.0098  avg_image_tau: 0.0040  avg_text_tau: 0.0077  time: 1.6890  data: 0.1436  max mem: 34806
Train Epoch: [24]  [2243/2244]  eta: 0:00:01  lr: 0.000085  loss_ita: -0.0224  lr_temp_net: 0.00000239  loss_temp: -0.0058  avg_image_tau: 0.0041  avg_text_tau: 0.0077  time: 1.7426  data: 0.0293  max mem: 34806
Train Epoch: [24] Total time: 1:00:50 (1.6269 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0177  lr_temp_net: 0.0000  loss_temp: -0.0096  avg_image_tau: 0.0035  avg_text_tau: 0.0071
Computing features for evaluation...
Evaluation time 0:01:01
Computing features for evaluation...
Evaluation time 0:00:52
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:18
coco val: {'txt_r1': 43.52, 'txt_r5': 68.48, 'txt_r10': 78.04, 'txt_r_mean': 63.34666666666667, 'img_r1': 26.61735305877649, 'img_r5': 51.82726909236305, 'img_r10': 64.05437824870052, 'img_r_mean': 47.49966679994668, 'r_mean': 55.42316673330667}
coco test: {'txt_r1': 41.78, 'txt_r5': 68.34, 'txt_r10': 77.92, 'txt_r_mean': 62.68000000000001, 'img_r1': 26.545381847261094, 'img_r5': 51.87125149940024, 'img_r10': 63.40263894442223, 'img_r_mean': 47.27309076369452, 'r_mean': 54.97654538184726}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [25]  [   0/2244]  eta: 9:03:29  lr: 0.000063  loss_ita: -0.0224  lr_temp_net: 0.00000215  loss_temp: -0.0057  avg_image_tau: 0.0041  avg_text_tau: 0.0077  time: 14.5320  data: 7.3726  max mem: 34806
Train Epoch: [25]  [  50/2244]  eta: 1:07:27  lr: 0.000063  loss_ita: -0.0187  lr_temp_net: 0.00000215  loss_temp: -0.0078  avg_image_tau: 0.0041  avg_text_tau: 0.0078  time: 1.5869  data: 0.2319  max mem: 34806
Train Epoch: [25]  [ 100/2244]  eta: 1:02:11  lr: 0.000063  loss_ita: -0.0183  lr_temp_net: 0.00000215  loss_temp: -0.0064  avg_image_tau: 0.0041  avg_text_tau: 0.0078  time: 1.6144  data: 0.2514  max mem: 34806
Train Epoch: [25]  [ 150/2244]  eta: 1:00:08  lr: 0.000063  loss_ita: -0.0198  lr_temp_net: 0.00000215  loss_temp: -0.0125  avg_image_tau: 0.0040  avg_text_tau: 0.0078  time: 1.6207  data: 0.2452  max mem: 34806
Train Epoch: [25]  [ 200/2244]  eta: 0:57:57  lr: 0.000063  loss_ita: -0.0195  lr_temp_net: 0.00000215  loss_temp: -0.0046  avg_image_tau: 0.0041  avg_text_tau: 0.0078  time: 1.6314  data: 0.2102  max mem: 34806
Train Epoch: [25]  [ 250/2244]  eta: 0:55:51  lr: 0.000063  loss_ita: -0.0211  lr_temp_net: 0.00000215  loss_temp: -0.0006  avg_image_tau: 0.0041  avg_text_tau: 0.0078  time: 1.7011  data: 0.2299  max mem: 34806
Train Epoch: [25]  [ 300/2244]  eta: 0:54:02  lr: 0.000063  loss_ita: -0.0192  lr_temp_net: 0.00000215  loss_temp: -0.0048  avg_image_tau: 0.0041  avg_text_tau: 0.0078  time: 1.6041  data: 0.0255  max mem: 34806
Train Epoch: [25]  [ 350/2244]  eta: 0:52:34  lr: 0.000063  loss_ita: -0.0235  lr_temp_net: 0.00000215  loss_temp: -0.0052  avg_image_tau: 0.0041  avg_text_tau: 0.0079  time: 1.6704  data: 0.3227  max mem: 34806
Train Epoch: [25]  [ 400/2244]  eta: 0:51:20  lr: 0.000063  loss_ita: -0.0176  lr_temp_net: 0.00000215  loss_temp: -0.0055  avg_image_tau: 0.0041  avg_text_tau: 0.0079  time: 1.6502  data: 0.2117  max mem: 34806
Train Epoch: [25]  [ 450/2244]  eta: 0:49:38  lr: 0.000063  loss_ita: -0.0225  lr_temp_net: 0.00000215  loss_temp: -0.0098  avg_image_tau: 0.0042  avg_text_tau: 0.0080  time: 1.6167  data: 0.0246  max mem: 34806
Train Epoch: [25]  [ 500/2244]  eta: 0:48:09  lr: 0.000063  loss_ita: -0.0218  lr_temp_net: 0.00000215  loss_temp: -0.0025  avg_image_tau: 0.0042  avg_text_tau: 0.0080  time: 1.6398  data: 0.0253  max mem: 34806
Train Epoch: [25]  [ 550/2244]  eta: 0:46:41  lr: 0.000063  loss_ita: -0.0232  lr_temp_net: 0.00000215  loss_temp: -0.0064  avg_image_tau: 0.0042  avg_text_tau: 0.0080  time: 1.6384  data: 0.0286  max mem: 34806
Train Epoch: [25]  [ 600/2244]  eta: 0:45:11  lr: 0.000063  loss_ita: -0.0237  lr_temp_net: 0.00000215  loss_temp: -0.0071  avg_image_tau: 0.0042  avg_text_tau: 0.0080  time: 1.6416  data: 0.0286  max mem: 34806
Train Epoch: [25]  [ 650/2244]  eta: 0:43:57  lr: 0.000063  loss_ita: -0.0205  lr_temp_net: 0.00000215  loss_temp: -0.0080  avg_image_tau: 0.0042  avg_text_tau: 0.0080  time: 2.0002  data: 0.2864  max mem: 34806
Train Epoch: [25]  [ 700/2244]  eta: 0:42:33  lr: 0.000063  loss_ita: -0.0212  lr_temp_net: 0.00000215  loss_temp: -0.0053  avg_image_tau: 0.0042  avg_text_tau: 0.0081  time: 1.6103  data: 0.2556  max mem: 34806
Train Epoch: [25]  [ 750/2244]  eta: 0:41:00  lr: 0.000063  loss_ita: -0.0248  lr_temp_net: 0.00000215  loss_temp: -0.0045  avg_image_tau: 0.0043  avg_text_tau: 0.0082  time: 1.5103  data: 0.2430  max mem: 34806
Train Epoch: [25]  [ 800/2244]  eta: 0:39:31  lr: 0.000063  loss_ita: -0.0229  lr_temp_net: 0.00000215  loss_temp: -0.0109  avg_image_tau: 0.0043  avg_text_tau: 0.0082  time: 1.6087  data: 0.2004  max mem: 34806
Train Epoch: [25]  [ 850/2244]  eta: 0:38:01  lr: 0.000063  loss_ita: -0.0229  lr_temp_net: 0.00000215  loss_temp: -0.0061  avg_image_tau: 0.0043  avg_text_tau: 0.0081  time: 1.5364  data: 0.2977  max mem: 34806
Train Epoch: [25]  [ 900/2244]  eta: 0:36:30  lr: 0.000063  loss_ita: -0.0222  lr_temp_net: 0.00000215  loss_temp: -0.0070  avg_image_tau: 0.0042  avg_text_tau: 0.0083  time: 1.5407  data: 0.2664  max mem: 34806
Train Epoch: [25]  [ 950/2244]  eta: 0:35:03  lr: 0.000063  loss_ita: -0.0246  lr_temp_net: 0.00000215  loss_temp: -0.0066  avg_image_tau: 0.0043  avg_text_tau: 0.0083  time: 1.5469  data: 0.3310  max mem: 34806
Train Epoch: [25]  [1000/2244]  eta: 0:33:37  lr: 0.000063  loss_ita: -0.0238  lr_temp_net: 0.00000215  loss_temp: -0.0013  avg_image_tau: 0.0043  avg_text_tau: 0.0082  time: 1.5432  data: 0.2554  max mem: 34806
Train Epoch: [25]  [1050/2244]  eta: 0:32:11  lr: 0.000063  loss_ita: -0.0232  lr_temp_net: 0.00000215  loss_temp: -0.0069  avg_image_tau: 0.0044  avg_text_tau: 0.0082  time: 1.5450  data: 0.2832  max mem: 34806
Train Epoch: [25]  [1100/2244]  eta: 0:30:45  lr: 0.000063  loss_ita: -0.0240  lr_temp_net: 0.00000215  loss_temp: -0.0075  avg_image_tau: 0.0044  avg_text_tau: 0.0083  time: 1.4923  data: 0.2662  max mem: 34806
Train Epoch: [25]  [1150/2244]  eta: 0:29:48  lr: 0.000063  loss_ita: -0.0227  lr_temp_net: 0.00000215  loss_temp: -0.0085  avg_image_tau: 0.0043  avg_text_tau: 0.0082  time: 1.4746  data: 0.0327  max mem: 34806
Train Epoch: [25]  [1200/2244]  eta: 0:28:20  lr: 0.000063  loss_ita: -0.0239  lr_temp_net: 0.00000215  loss_temp: -0.0038  avg_image_tau: 0.0043  avg_text_tau: 0.0083  time: 1.5300  data: 0.0240  max mem: 34806
Train Epoch: [25]  [1250/2244]  eta: 0:26:56  lr: 0.000063  loss_ita: -0.0246  lr_temp_net: 0.00000215  loss_temp: -0.0080  avg_image_tau: 0.0044  avg_text_tau: 0.0083  time: 1.5356  data: 0.0292  max mem: 34806
Train Epoch: [25]  [1300/2244]  eta: 0:25:33  lr: 0.000063  loss_ita: -0.0227  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0043  avg_text_tau: 0.0083  time: 1.7170  data: 0.0204  max mem: 34806
Train Epoch: [25]  [1350/2244]  eta: 0:24:07  lr: 0.000063  loss_ita: -0.0225  lr_temp_net: 0.00000215  loss_temp: -0.0050  avg_image_tau: 0.0044  avg_text_tau: 0.0083  time: 1.5589  data: 0.0333  max mem: 34806
Train Epoch: [25]  [1400/2244]  eta: 0:22:42  lr: 0.000063  loss_ita: -0.0229  lr_temp_net: 0.00000215  loss_temp: -0.0050  avg_image_tau: 0.0044  avg_text_tau: 0.0083  time: 1.5088  data: 0.0267  max mem: 34806
Train Epoch: [25]  [1450/2244]  eta: 0:21:21  lr: 0.000063  loss_ita: -0.0264  lr_temp_net: 0.00000215  loss_temp: -0.0090  avg_image_tau: 0.0044  avg_text_tau: 0.0085  time: 1.6711  data: 0.0442  max mem: 34806
Train Epoch: [25]  [1500/2244]  eta: 0:20:00  lr: 0.000063  loss_ita: -0.0215  lr_temp_net: 0.00000215  loss_temp: -0.0073  avg_image_tau: 0.0044  avg_text_tau: 0.0084  time: 1.5997  data: 0.0660  max mem: 34806
Train Epoch: [25]  [1550/2244]  eta: 0:18:37  lr: 0.000063  loss_ita: -0.0218  lr_temp_net: 0.00000215  loss_temp: -0.0006  avg_image_tau: 0.0044  avg_text_tau: 0.0084  time: 1.4175  data: 0.0214  max mem: 34806
Train Epoch: [25]  [1600/2244]  eta: 0:17:15  lr: 0.000063  loss_ita: -0.0236  lr_temp_net: 0.00000215  loss_temp: -0.0080  avg_image_tau: 0.0044  avg_text_tau: 0.0084  time: 1.5761  data: 0.0348  max mem: 34806
Train Epoch: [25]  [1650/2244]  eta: 0:15:53  lr: 0.000063  loss_ita: -0.0231  lr_temp_net: 0.00000215  loss_temp: -0.0091  avg_image_tau: 0.0045  avg_text_tau: 0.0085  time: 1.4696  data: 0.0196  max mem: 34806
Train Epoch: [25]  [1700/2244]  eta: 0:14:31  lr: 0.000063  loss_ita: -0.0272  lr_temp_net: 0.00000215  loss_temp: -0.0082  avg_image_tau: 0.0045  avg_text_tau: 0.0087  time: 1.4691  data: 0.0207  max mem: 34806
Train Epoch: [25]  [1750/2244]  eta: 0:13:10  lr: 0.000063  loss_ita: -0.0235  lr_temp_net: 0.00000215  loss_temp: -0.0043  avg_image_tau: 0.0044  avg_text_tau: 0.0086  time: 1.5545  data: 0.0221  max mem: 34806
Train Epoch: [25]  [1800/2244]  eta: 0:11:49  lr: 0.000063  loss_ita: -0.0252  lr_temp_net: 0.00000215  loss_temp: -0.0097  avg_image_tau: 0.0044  avg_text_tau: 0.0087  time: 1.5404  data: 0.0316  max mem: 34806
Train Epoch: [25]  [1850/2244]  eta: 0:10:28  lr: 0.000063  loss_ita: -0.0225  lr_temp_net: 0.00000215  loss_temp: -0.0085  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.5398  data: 0.0239  max mem: 34806
Train Epoch: [25]  [1900/2244]  eta: 0:09:07  lr: 0.000063  loss_ita: -0.0259  lr_temp_net: 0.00000215  loss_temp: -0.0065  avg_image_tau: 0.0045  avg_text_tau: 0.0085  time: 1.4839  data: 0.0217  max mem: 34806
Train Epoch: [25]  [1950/2244]  eta: 0:07:47  lr: 0.000063  loss_ita: -0.0230  lr_temp_net: 0.00000215  loss_temp: -0.0062  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.4426  data: 0.0207  max mem: 34806
Train Epoch: [25]  [2000/2244]  eta: 0:06:27  lr: 0.000063  loss_ita: -0.0245  lr_temp_net: 0.00000215  loss_temp: -0.0070  avg_image_tau: 0.0044  avg_text_tau: 0.0086  time: 1.6360  data: 0.0222  max mem: 34806
Train Epoch: [25]  [2050/2244]  eta: 0:05:07  lr: 0.000063  loss_ita: -0.0261  lr_temp_net: 0.00000215  loss_temp: -0.0034  avg_image_tau: 0.0045  avg_text_tau: 0.0087  time: 1.4640  data: 0.0211  max mem: 34806
Train Epoch: [25]  [2100/2244]  eta: 0:03:48  lr: 0.000063  loss_ita: -0.0245  lr_temp_net: 0.00000215  loss_temp: -0.0060  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.5552  data: 0.0238  max mem: 34806
Train Epoch: [25]  [2150/2244]  eta: 0:02:28  lr: 0.000063  loss_ita: -0.0221  lr_temp_net: 0.00000215  loss_temp: -0.0061  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.5221  data: 0.0242  max mem: 34806
Train Epoch: [25]  [2200/2244]  eta: 0:01:09  lr: 0.000063  loss_ita: -0.0242  lr_temp_net: 0.00000215  loss_temp: -0.0066  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.4597  data: 0.0207  max mem: 34806
Train Epoch: [25]  [2243/2244]  eta: 0:00:01  lr: 0.000063  loss_ita: -0.0236  lr_temp_net: 0.00000215  loss_temp: -0.0049  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.5211  data: 0.0405  max mem: 34806
Train Epoch: [25] Total time: 0:59:09 (1.5819 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0228  lr_temp_net: 0.0000  loss_temp: -0.0063  avg_image_tau: 0.0043  avg_text_tau: 0.0082
Computing features for evaluation...
Evaluation time 0:00:58
Computing features for evaluation...
Evaluation time 0:00:43
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:16
coco val: {'txt_r1': 43.7, 'txt_r5': 68.84, 'txt_r10': 78.84, 'txt_r_mean': 63.79333333333333, 'img_r1': 27.093162734906038, 'img_r5': 52.50699720111955, 'img_r10': 64.30227908836466, 'img_r_mean': 47.96747967479675, 'r_mean': 55.880406504065036}
coco test: {'txt_r1': 41.52, 'txt_r5': 68.38, 'txt_r10': 78.26, 'txt_r_mean': 62.720000000000006, 'img_r1': 26.80527788884446, 'img_r5': 52.099160335865655, 'img_r10': 63.49860055977609, 'img_r_mean': 47.46767959482873, 'r_mean': 55.09383979741437}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [26]  [   0/2244]  eta: 4:08:34  lr: 0.000044  loss_ita: -0.0240  lr_temp_net: 0.00000194  loss_temp: -0.0023  avg_image_tau: 0.0045  avg_text_tau: 0.0087  time: 6.6465  data: 4.4783  max mem: 34806
Train Epoch: [26]  [  50/2244]  eta: 1:01:47  lr: 0.000044  loss_ita: -0.0212  lr_temp_net: 0.00000194  loss_temp: -0.0035  avg_image_tau: 0.0045  avg_text_tau: 0.0088  time: 1.4921  data: 0.2596  max mem: 34806
Train Epoch: [26]  [ 100/2244]  eta: 0:57:27  lr: 0.000044  loss_ita: -0.0244  lr_temp_net: 0.00000194  loss_temp: -0.0015  avg_image_tau: 0.0044  avg_text_tau: 0.0087  time: 1.5319  data: 0.2350  max mem: 34806
Train Epoch: [26]  [ 150/2244]  eta: 0:54:20  lr: 0.000044  loss_ita: -0.0222  lr_temp_net: 0.00000194  loss_temp: -0.0029  avg_image_tau: 0.0045  avg_text_tau: 0.0087  time: 1.4533  data: 0.2576  max mem: 34806
Train Epoch: [26]  [ 200/2244]  eta: 0:52:27  lr: 0.000044  loss_ita: -0.0228  lr_temp_net: 0.00000194  loss_temp: -0.0044  avg_image_tau: 0.0045  avg_text_tau: 0.0086  time: 1.5002  data: 0.1876  max mem: 34806
Train Epoch: [26]  [ 250/2244]  eta: 0:50:33  lr: 0.000044  loss_ita: -0.0240  lr_temp_net: 0.00000194  loss_temp: -0.0062  avg_image_tau: 0.0045  avg_text_tau: 0.0088  time: 1.4316  data: 0.0419  max mem: 34806
Train Epoch: [26]  [ 300/2244]  eta: 0:49:12  lr: 0.000044  loss_ita: -0.0249  lr_temp_net: 0.00000194  loss_temp: -0.0077  avg_image_tau: 0.0044  avg_text_tau: 0.0088  time: 1.4906  data: 0.2931  max mem: 34806
Train Epoch: [26]  [ 350/2244]  eta: 0:48:12  lr: 0.000044  loss_ita: -0.0238  lr_temp_net: 0.00000194  loss_temp: -0.0067  avg_image_tau: 0.0045  avg_text_tau: 0.0088  time: 1.5059  data: 0.1343  max mem: 34806
Train Epoch: [26]  [ 400/2244]  eta: 0:47:13  lr: 0.000044  loss_ita: -0.0237  lr_temp_net: 0.00000194  loss_temp: -0.0035  avg_image_tau: 0.0045  avg_text_tau: 0.0088  time: 1.5966  data: 0.1908  max mem: 34806
Train Epoch: [26]  [ 450/2244]  eta: 0:46:07  lr: 0.000044  loss_ita: -0.0230  lr_temp_net: 0.00000194  loss_temp: -0.0058  avg_image_tau: 0.0044  avg_text_tau: 0.0089  time: 1.4950  data: 0.2136  max mem: 34806
Train Epoch: [26]  [ 500/2244]  eta: 0:45:00  lr: 0.000044  loss_ita: -0.0247  lr_temp_net: 0.00000194  loss_temp: -0.0020  avg_image_tau: 0.0044  avg_text_tau: 0.0088  time: 1.5508  data: 0.1931  max mem: 34806
Train Epoch: [26]  [ 550/2244]  eta: 0:43:36  lr: 0.000044  loss_ita: -0.0265  lr_temp_net: 0.00000194  loss_temp: -0.0074  avg_image_tau: 0.0045  avg_text_tau: 0.0089  time: 1.5035  data: 0.2653  max mem: 34806
Train Epoch: [26]  [ 600/2244]  eta: 0:42:13  lr: 0.000044  loss_ita: -0.0241  lr_temp_net: 0.00000194  loss_temp: -0.0049  avg_image_tau: 0.0045  avg_text_tau: 0.0089  time: 1.5294  data: 0.2259  max mem: 34806
Train Epoch: [26]  [ 650/2244]  eta: 0:40:53  lr: 0.000044  loss_ita: -0.0257  lr_temp_net: 0.00000194  loss_temp: -0.0042  avg_image_tau: 0.0045  avg_text_tau: 0.0089  time: 1.5650  data: 0.0241  max mem: 34806
Train Epoch: [26]  [ 700/2244]  eta: 0:39:37  lr: 0.000044  loss_ita: -0.0249  lr_temp_net: 0.00000194  loss_temp: -0.0042  avg_image_tau: 0.0044  avg_text_tau: 0.0089  time: 1.5194  data: 0.0630  max mem: 34806
Train Epoch: [26]  [ 750/2244]  eta: 0:38:16  lr: 0.000044  loss_ita: -0.0226  lr_temp_net: 0.00000194  loss_temp: -0.0030  avg_image_tau: 0.0044  avg_text_tau: 0.0088  time: 1.4908  data: 0.2636  max mem: 34806
Train Epoch: [26]  [ 800/2244]  eta: 0:36:55  lr: 0.000044  loss_ita: -0.0226  lr_temp_net: 0.00000194  loss_temp: -0.0052  avg_image_tau: 0.0044  avg_text_tau: 0.0088  time: 1.4785  data: 0.2169  max mem: 34806
Train Epoch: [26]  [ 850/2244]  eta: 0:35:32  lr: 0.000044  loss_ita: -0.0236  lr_temp_net: 0.00000194  loss_temp: -0.0038  avg_image_tau: 0.0044  avg_text_tau: 0.0089  time: 1.4822  data: 0.0629  max mem: 34806
Train Epoch: [26]  [ 900/2244]  eta: 0:34:10  lr: 0.000044  loss_ita: -0.0231  lr_temp_net: 0.00000194  loss_temp: -0.0064  avg_image_tau: 0.0044  avg_text_tau: 0.0089  time: 1.4759  data: 0.2563  max mem: 34806
Train Epoch: [26]  [ 950/2244]  eta: 0:32:56  lr: 0.000044  loss_ita: -0.0249  lr_temp_net: 0.00000194  loss_temp: -0.0048  avg_image_tau: 0.0045  avg_text_tau: 0.0089  time: 1.5791  data: 0.3274  max mem: 34806
Train Epoch: [26]  [1000/2244]  eta: 0:31:40  lr: 0.000044  loss_ita: -0.0248  lr_temp_net: 0.00000194  loss_temp: -0.0046  avg_image_tau: 0.0045  avg_text_tau: 0.0089  time: 1.5423  data: 0.1326  max mem: 34806
Train Epoch: [26]  [1050/2244]  eta: 0:30:26  lr: 0.000044  loss_ita: -0.0242  lr_temp_net: 0.00000194  loss_temp: -0.0039  avg_image_tau: 0.0045  avg_text_tau: 0.0090  time: 1.6217  data: 0.2459  max mem: 34806
Train Epoch: [26]  [1100/2244]  eta: 0:29:12  lr: 0.000044  loss_ita: -0.0256  lr_temp_net: 0.00000194  loss_temp: -0.0065  avg_image_tau: 0.0045  avg_text_tau: 0.0090  time: 1.5153  data: 0.1292  max mem: 34806
Train Epoch: [26]  [1150/2244]  eta: 0:27:56  lr: 0.000044  loss_ita: -0.0250  lr_temp_net: 0.00000194  loss_temp: -0.0049  avg_image_tau: 0.0044  avg_text_tau: 0.0090  time: 1.5474  data: 0.0914  max mem: 34806
Train Epoch: [26]  [1200/2244]  eta: 0:26:39  lr: 0.000044  loss_ita: -0.0244  lr_temp_net: 0.00000194  loss_temp: -0.0077  avg_image_tau: 0.0045  avg_text_tau: 0.0090  time: 1.5202  data: 0.0222  max mem: 34806
Train Epoch: [26]  [1250/2244]  eta: 0:25:21  lr: 0.000044  loss_ita: -0.0254  lr_temp_net: 0.00000194  loss_temp: -0.0044  avg_image_tau: 0.0045  avg_text_tau: 0.0091  time: 1.4641  data: 0.0226  max mem: 34806
Train Epoch: [26]  [1300/2244]  eta: 0:24:04  lr: 0.000044  loss_ita: -0.0272  lr_temp_net: 0.00000194  loss_temp: -0.0052  avg_image_tau: 0.0046  avg_text_tau: 0.0091  time: 1.5488  data: 0.1322  max mem: 34806
Train Epoch: [26]  [1350/2244]  eta: 0:22:47  lr: 0.000044  loss_ita: -0.0238  lr_temp_net: 0.00000194  loss_temp: -0.0039  avg_image_tau: 0.0045  avg_text_tau: 0.0090  time: 1.5070  data: 0.2089  max mem: 34806
Train Epoch: [26]  [1400/2244]  eta: 0:22:04  lr: 0.000044  loss_ita: -0.0261  lr_temp_net: 0.00000194  loss_temp: -0.0070  avg_image_tau: 0.0046  avg_text_tau: 0.0091  time: 2.4446  data: 0.0318  max mem: 34806
Train Epoch: [26]  [1450/2244]  eta: 0:20:44  lr: 0.000044  loss_ita: -0.0234  lr_temp_net: 0.00000194  loss_temp: -0.0038  avg_image_tau: 0.0045  avg_text_tau: 0.0091  time: 1.5071  data: 0.0236  max mem: 34806
Train Epoch: [26]  [1500/2244]  eta: 0:19:23  lr: 0.000044  loss_ita: -0.0254  lr_temp_net: 0.00000194  loss_temp: -0.0070  avg_image_tau: 0.0045  avg_text_tau: 0.0090  time: 1.4727  data: 0.0197  max mem: 34806
Train Epoch: [26]  [1550/2244]  eta: 0:18:02  lr: 0.000044  loss_ita: -0.0245  lr_temp_net: 0.00000194  loss_temp: 0.0002  avg_image_tau: 0.0046  avg_text_tau: 0.0092  time: 1.4693  data: 0.0203  max mem: 34806
Train Epoch: [26]  [1600/2244]  eta: 0:16:42  lr: 0.000044  loss_ita: -0.0249  lr_temp_net: 0.00000194  loss_temp: -0.0039  avg_image_tau: 0.0045  avg_text_tau: 0.0091  time: 1.4679  data: 0.0215  max mem: 34806
Train Epoch: [26]  [1650/2244]  eta: 0:15:23  lr: 0.000044  loss_ita: -0.0282  lr_temp_net: 0.00000194  loss_temp: -0.0060  avg_image_tau: 0.0046  avg_text_tau: 0.0092  time: 1.4639  data: 0.0182  max mem: 34806
Train Epoch: [26]  [1700/2244]  eta: 0:14:05  lr: 0.000044  loss_ita: -0.0256  lr_temp_net: 0.00000194  loss_temp: -0.0082  avg_image_tau: 0.0046  avg_text_tau: 0.0091  time: 1.5500  data: 0.3186  max mem: 34806
Train Epoch: [26]  [1750/2244]  eta: 0:12:46  lr: 0.000044  loss_ita: -0.0284  lr_temp_net: 0.00000194  loss_temp: -0.0013  avg_image_tau: 0.0046  avg_text_tau: 0.0092  time: 1.4791  data: 0.1820  max mem: 34806
Train Epoch: [26]  [1800/2244]  eta: 0:11:27  lr: 0.000044  loss_ita: -0.0293  lr_temp_net: 0.00000194  loss_temp: -0.0058  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.4269  data: 0.1961  max mem: 34806
Train Epoch: [26]  [1850/2244]  eta: 0:10:09  lr: 0.000044  loss_ita: -0.0259  lr_temp_net: 0.00000194  loss_temp: -0.0111  avg_image_tau: 0.0046  avg_text_tau: 0.0093  time: 1.4819  data: 0.1152  max mem: 34806
Train Epoch: [26]  [1900/2244]  eta: 0:09:02  lr: 0.000044  loss_ita: -0.0282  lr_temp_net: 0.00000194  loss_temp: -0.0081  avg_image_tau: 0.0046  avg_text_tau: 0.0093  time: 1.5052  data: 0.0229  max mem: 34806
Train Epoch: [26]  [1950/2244]  eta: 0:07:43  lr: 0.000044  loss_ita: -0.0286  lr_temp_net: 0.00000194  loss_temp: -0.0083  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.6178  data: 0.0251  max mem: 34806
Train Epoch: [26]  [2000/2244]  eta: 0:06:24  lr: 0.000044  loss_ita: -0.0246  lr_temp_net: 0.00000194  loss_temp: -0.0055  avg_image_tau: 0.0046  avg_text_tau: 0.0093  time: 1.4830  data: 0.0236  max mem: 34806
Train Epoch: [26]  [2050/2244]  eta: 0:05:05  lr: 0.000044  loss_ita: -0.0270  lr_temp_net: 0.00000194  loss_temp: -0.0073  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.5716  data: 0.0199  max mem: 34806
Train Epoch: [26]  [2100/2244]  eta: 0:03:46  lr: 0.000044  loss_ita: -0.0324  lr_temp_net: 0.00000194  loss_temp: -0.0035  avg_image_tau: 0.0046  avg_text_tau: 0.0093  time: 1.4530  data: 0.0228  max mem: 34806
Train Epoch: [26]  [2150/2244]  eta: 0:02:27  lr: 0.000044  loss_ita: -0.0270  lr_temp_net: 0.00000194  loss_temp: -0.0078  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.4752  data: 0.0225  max mem: 34806
Train Epoch: [26]  [2200/2244]  eta: 0:01:08  lr: 0.000044  loss_ita: -0.0295  lr_temp_net: 0.00000194  loss_temp: -0.0046  avg_image_tau: 0.0046  avg_text_tau: 0.0094  time: 1.4787  data: 0.0209  max mem: 34806
Train Epoch: [26]  [2243/2244]  eta: 0:00:01  lr: 0.000044  loss_ita: -0.0273  lr_temp_net: 0.00000194  loss_temp: -0.0094  avg_image_tau: 0.0046  avg_text_tau: 0.0094  time: 1.4860  data: 0.0204  max mem: 34806
Train Epoch: [26] Total time: 0:58:35 (1.5667 s / it)
Averaged stats: lr: 0.0000  loss_ita: -0.0255  lr_temp_net: 0.0000  loss_temp: -0.0058  avg_image_tau: 0.0045  avg_text_tau: 0.0090
Computing features for evaluation...
Evaluation time 0:00:52
Computing features for evaluation...
Evaluation time 0:00:42
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:16
coco val: {'txt_r1': 43.56, 'txt_r5': 69.54, 'txt_r10': 78.9, 'txt_r_mean': 64.0, 'img_r1': 27.285085965613753, 'img_r5': 52.4390243902439, 'img_r10': 64.54618152738904, 'img_r_mean': 48.09009729441556, 'r_mean': 56.04504864720778}
coco test: {'txt_r1': 42.3, 'txt_r5': 68.98, 'txt_r10': 78.52, 'txt_r_mean': 63.26666666666667, 'img_r1': 27.253098760495803, 'img_r5': 52.28308676529388, 'img_r10': 63.69452219112355, 'img_r_mean': 47.74356923897108, 'r_mean': 55.50511795281888}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [27]  [   0/2244]  eta: 3:36:33  lr: 0.000029  loss_ita: -0.0252  lr_temp_net: 0.00000174  loss_temp: -0.0062  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 5.7903  data: 4.0864  max mem: 34806
Train Epoch: [27]  [  50/2244]  eta: 0:58:05  lr: 0.000029  loss_ita: -0.0237  lr_temp_net: 0.00000174  loss_temp: -0.0034  avg_image_tau: 0.0046  avg_text_tau: 0.0094  time: 1.4723  data: 0.0219  max mem: 34806
Train Epoch: [27]  [ 100/2244]  eta: 0:54:15  lr: 0.000029  loss_ita: -0.0250  lr_temp_net: 0.00000174  loss_temp: -0.0083  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.4292  data: 0.0214  max mem: 34806
Train Epoch: [27]  [ 150/2244]  eta: 0:53:02  lr: 0.000029  loss_ita: -0.0261  lr_temp_net: 0.00000174  loss_temp: -0.0069  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.5480  data: 0.3400  max mem: 34806
Train Epoch: [27]  [ 200/2244]  eta: 0:51:32  lr: 0.000029  loss_ita: -0.0244  lr_temp_net: 0.00000174  loss_temp: -0.0020  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.4592  data: 0.2156  max mem: 34806
Train Epoch: [27]  [ 250/2244]  eta: 0:49:59  lr: 0.000029  loss_ita: -0.0249  lr_temp_net: 0.00000174  loss_temp: -0.0065  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.4776  data: 0.0324  max mem: 34806
Train Epoch: [27]  [ 300/2244]  eta: 0:48:29  lr: 0.000029  loss_ita: -0.0270  lr_temp_net: 0.00000174  loss_temp: -0.0063  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.4062  data: 0.0208  max mem: 34806
Train Epoch: [27]  [ 350/2244]  eta: 0:46:59  lr: 0.000029  loss_ita: -0.0287  lr_temp_net: 0.00000174  loss_temp: -0.0057  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.4744  data: 0.0231  max mem: 34806
Train Epoch: [27]  [ 400/2244]  eta: 0:45:45  lr: 0.000029  loss_ita: -0.0275  lr_temp_net: 0.00000174  loss_temp: -0.0033  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.5408  data: 0.0238  max mem: 34806
Train Epoch: [27]  [ 450/2244]  eta: 0:45:01  lr: 0.000029  loss_ita: -0.0262  lr_temp_net: 0.00000174  loss_temp: -0.0042  avg_image_tau: 0.0045  avg_text_tau: 0.0093  time: 1.9317  data: 0.0222  max mem: 34806
Train Epoch: [27]  [ 500/2244]  eta: 0:44:36  lr: 0.000029  loss_ita: -0.0265  lr_temp_net: 0.00000174  loss_temp: -0.0052  avg_image_tau: 0.0045  avg_text_tau: 0.0094  time: 1.4707  data: 0.0569  max mem: 34806
Train Epoch: [27]  [ 550/2244]  eta: 0:43:12  lr: 0.000029  loss_ita: -0.0272  lr_temp_net: 0.00000174  loss_temp: -0.0043  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.4349  data: 0.2086  max mem: 34806
Train Epoch: [27]  [ 600/2244]  eta: 0:41:54  lr: 0.000029  loss_ita: -0.0253  lr_temp_net: 0.00000174  loss_temp: -0.0094  avg_image_tau: 0.0044  avg_text_tau: 0.0094  time: 1.5058  data: 0.0823  max mem: 34806
Train Epoch: [27]  [ 650/2244]  eta: 0:40:34  lr: 0.000029  loss_ita: -0.0280  lr_temp_net: 0.00000174  loss_temp: -0.0038  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.4726  data: 0.0208  max mem: 34806
Train Epoch: [27]  [ 700/2244]  eta: 0:39:14  lr: 0.000029  loss_ita: -0.0278  lr_temp_net: 0.00000174  loss_temp: -0.0048  avg_image_tau: 0.0044  avg_text_tau: 0.0095  time: 1.5319  data: 0.0207  max mem: 34806
Train Epoch: [27]  [ 750/2244]  eta: 0:37:51  lr: 0.000029  loss_ita: -0.0273  lr_temp_net: 0.00000174  loss_temp: -0.0043  avg_image_tau: 0.0044  avg_text_tau: 0.0095  time: 1.4723  data: 0.0206  max mem: 34806
Train Epoch: [27]  [ 800/2244]  eta: 0:36:30  lr: 0.000029  loss_ita: -0.0245  lr_temp_net: 0.00000174  loss_temp: -0.0093  avg_image_tau: 0.0044  avg_text_tau: 0.0095  time: 1.4889  data: 0.0211  max mem: 34806
Train Epoch: [27]  [ 850/2244]  eta: 0:35:21  lr: 0.000029  loss_ita: -0.0272  lr_temp_net: 0.00000174  loss_temp: -0.0062  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.5422  data: 0.0190  max mem: 34806
Train Epoch: [27]  [ 900/2244]  eta: 0:34:00  lr: 0.000029  loss_ita: -0.0298  lr_temp_net: 0.00000174  loss_temp: -0.0052  avg_image_tau: 0.0044  avg_text_tau: 0.0096  time: 1.4220  data: 0.0216  max mem: 34806
Train Epoch: [27]  [ 950/2244]  eta: 0:32:53  lr: 0.000029  loss_ita: -0.0277  lr_temp_net: 0.00000174  loss_temp: -0.0070  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.8441  data: 0.0226  max mem: 34806
Train Epoch: [27]  [1000/2244]  eta: 0:31:32  lr: 0.000029  loss_ita: -0.0266  lr_temp_net: 0.00000174  loss_temp: -0.0054  avg_image_tau: 0.0045  avg_text_tau: 0.0095  time: 1.4439  data: 0.0293  max mem: 34806
Train Epoch: [27]  [1050/2244]  eta: 0:30:18  lr: 0.000029  loss_ita: -0.0265  lr_temp_net: 0.00000174  loss_temp: -0.0042  avg_image_tau: 0.0044  avg_text_tau: 0.0096  time: 1.5051  data: 0.2645  max mem: 34806
Train Epoch: [27]  [1100/2244]  eta: 0:29:06  lr: 0.000029  loss_ita: -0.0263  lr_temp_net: 0.00000174  loss_temp: -0.0060  avg_image_tau: 0.0044  avg_text_tau: 0.0096  time: 1.4506  data: 0.1129  max mem: 34806
Train Epoch: [27]  [1150/2244]  eta: 0:27:48  lr: 0.000029  loss_ita: -0.0269  lr_temp_net: 0.00000174  loss_temp: -0.0069  avg_image_tau: 0.0045  avg_text_tau: 0.0096  time: 1.5293  data: 0.0294  max mem: 34806
Train Epoch: [27]  [1200/2244]  eta: 0:26:31  lr: 0.000029  loss_ita: -0.0304  lr_temp_net: 0.00000174  loss_temp: -0.0108  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 1.4818  data: 0.0389  max mem: 34806
Train Epoch: [27]  [1250/2244]  eta: 0:25:14  lr: 0.000029  loss_ita: -0.0298  lr_temp_net: 0.00000174  loss_temp: -0.0052  avg_image_tau: 0.0046  avg_text_tau: 0.0097  time: 1.5222  data: 0.0225  max mem: 34806
Train Epoch: [27]  [1300/2244]  eta: 0:23:57  lr: 0.000029  loss_ita: -0.0292  lr_temp_net: 0.00000174  loss_temp: -0.0078  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 1.4806  data: 0.0245  max mem: 34806
Train Epoch: [27]  [1350/2244]  eta: 0:23:03  lr: 0.000029  loss_ita: -0.0263  lr_temp_net: 0.00000174  loss_temp: -0.0057  avg_image_tau: 0.0045  avg_text_tau: 0.0096  time: 1.5151  data: 0.1017  max mem: 34806
Train Epoch: [27]  [1400/2244]  eta: 0:22:13  lr: 0.000029  loss_ita: -0.0310  lr_temp_net: 0.00000174  loss_temp: -0.0042  avg_image_tau: 0.0045  avg_text_tau: 0.0098  time: 3.5736  data: 0.0526  max mem: 34806
Train Epoch: [27]  [1450/2244]  eta: 0:20:54  lr: 0.000029  loss_ita: -0.0269  lr_temp_net: 0.00000174  loss_temp: -0.0089  avg_image_tau: 0.0045  avg_text_tau: 0.0098  time: 1.6262  data: 0.0177  max mem: 34806
Train Epoch: [27]  [1500/2244]  eta: 0:19:32  lr: 0.000029  loss_ita: -0.0265  lr_temp_net: 0.00000174  loss_temp: -0.0093  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 1.4698  data: 0.0173  max mem: 34806
Train Epoch: [27]  [1550/2244]  eta: 0:18:13  lr: 0.000029  loss_ita: -0.0283  lr_temp_net: 0.00000174  loss_temp: -0.0064  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 1.6068  data: 0.0506  max mem: 34806
Train Epoch: [27]  [1600/2244]  eta: 0:17:01  lr: 0.000029  loss_ita: -0.0266  lr_temp_net: 0.00000174  loss_temp: -0.0016  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 1.5207  data: 0.2441  max mem: 34806
Train Epoch: [27]  [1650/2244]  eta: 0:15:50  lr: 0.000029  loss_ita: -0.0306  lr_temp_net: 0.00000174  loss_temp: -0.0058  avg_image_tau: 0.0045  avg_text_tau: 0.0098  time: 2.0576  data: 0.1201  max mem: 34806
Train Epoch: [27]  [1700/2244]  eta: 0:14:49  lr: 0.000029  loss_ita: -0.0276  lr_temp_net: 0.00000174  loss_temp: -0.0054  avg_image_tau: 0.0045  avg_text_tau: 0.0097  time: 3.8401  data: 0.0246  max mem: 34806
Train Epoch: [27]  [1750/2244]  eta: 0:13:32  lr: 0.000029  loss_ita: -0.0260  lr_temp_net: 0.00000174  loss_temp: -0.0060  avg_image_tau: 0.0045  avg_text_tau: 0.0098  time: 2.4975  data: 0.0955  max mem: 34806
Train Epoch: [27]  [1800/2244]  eta: 0:12:11  lr: 0.000029  loss_ita: -0.0286  lr_temp_net: 0.00000174  loss_temp: -0.0054  avg_image_tau: 0.0046  avg_text_tau: 0.0099  time: 1.4338  data: 0.0199  max mem: 34806
Train Epoch: [27]  [1850/2244]  eta: 0:11:00  lr: 0.000029  loss_ita: -0.0260  lr_temp_net: 0.00000174  loss_temp: -0.0068  avg_image_tau: 0.0046  avg_text_tau: 0.0098  time: 3.2793  data: 0.2428  max mem: 34806
Train Epoch: [27]  [1900/2244]  eta: 0:09:39  lr: 0.000029  loss_ita: -0.0269  lr_temp_net: 0.00000174  loss_temp: -0.0039  avg_image_tau: 0.0045  avg_text_tau: 0.0098  time: 1.5730  data: 0.0209  max mem: 34806
Train Epoch: [27]  [1950/2244]  eta: 0:08:14  lr: 0.000029  loss_ita: -0.0279  lr_temp_net: 0.00000174  loss_temp: -0.0034  avg_image_tau: 0.0046  avg_text_tau: 0.0098  time: 1.5819  data: 0.0215  max mem: 34806
slurmstepd: error: *** STEP 12684700.0 ON g001 CANCELLED AT 2025-02-22T18:03:31 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 12684700 ON g001 CANCELLED AT 2025-02-22T18:03:31 DUE TO TIME LIMIT ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
