| distributed init (rank 4): env://
| distributed init (rank 6): env://
| distributed init (rank 2): env://
| distributed init (rank 0): env://
| distributed init (rank 5): env://
| distributed init (rank 7): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
we have created Simple Tokenizer by OpenAI
here we create traindataset
here we have created traindataset
len of coco val/test: 5000 5000
len of flickr val/test: 1014 1000
here we create trainloader
we have created the trainloader for webdataset style data
number of train samples are 9191424
Creating model
Transformer
we have created the Vision Transformer Base 32
we have created the Text Transformer
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Received Image
add: criterion.image_temp_gen.scaler torch.Size([]) to tempnet optimizer
add: criterion.image_temp_gen.prototypes torch.Size([512, 512]) to tempnet optimizer
add: criterion.image_temp_gen.proj.weight torch.Size([512, 512]) to tempnet optimizer
add: criterion.image_temp_gen.proj.bias torch.Size([512]) to tempnet optimizer
add: criterion.image_temp_gen.linear_1.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.image_temp_gen.linear_1.bias torch.Size([1]) to tempnet optimizer
add: criterion.image_temp_gen.linear_2.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.text_temp_gen.scaler torch.Size([]) to tempnet optimizer
add: criterion.text_temp_gen.prototypes torch.Size([512, 512]) to tempnet optimizer
add: criterion.text_temp_gen.proj.weight torch.Size([512, 512]) to tempnet optimizer
add: criterion.text_temp_gen.proj.bias torch.Size([512]) to tempnet optimizer
add: criterion.text_temp_gen.linear_1.weight torch.Size([1, 512]) to tempnet optimizer
add: criterion.text_temp_gen.linear_1.bias torch.Size([1]) to tempnet optimizer
add: criterion.text_temp_gen.linear_2.weight torch.Size([1, 512]) to tempnet optimizer
Start training
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [0]  [   0/2244]  eta: 15:00:40  lr: 0.000010  loss_ita: 0.0300  lr_temp_net: 0.00003000  loss_temp: 0.7653  avg_image_tau: 0.0408  avg_text_tau: 0.0413  time: 24.0820  data: 3.1744  max mem: 20491
Train Epoch: [0]  [  50/2244]  eta: 0:56:36  lr: 0.000010  loss_ita: -0.0003  lr_temp_net: 0.00003000  loss_temp: 0.7566  avg_image_tau: 0.0396  avg_text_tau: 0.0403  time: 1.1377  data: 0.0954  max mem: 22275
Train Epoch: [0]  [ 100/2244]  eta: 0:47:56  lr: 0.000010  loss_ita: -0.0007  lr_temp_net: 0.00003000  loss_temp: 0.7316  avg_image_tau: 0.0385  avg_text_tau: 0.0390  time: 1.1338  data: 0.0016  max mem: 22277
Train Epoch: [0]  [ 150/2244]  eta: 0:44:17  lr: 0.000049  loss_ita: 0.0037  lr_temp_net: 0.00003000  loss_temp: 0.6868  avg_image_tau: 0.0374  avg_text_tau: 0.0380  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 200/2244]  eta: 0:42:04  lr: 0.000049  loss_ita: 0.0022  lr_temp_net: 0.00003000  loss_temp: 0.6561  avg_image_tau: 0.0365  avg_text_tau: 0.0369  time: 1.1342  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 250/2244]  eta: 0:40:19  lr: 0.000089  loss_ita: 0.0007  lr_temp_net: 0.00003000  loss_temp: 0.6407  avg_image_tau: 0.0354  avg_text_tau: 0.0360  time: 1.1323  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 300/2244]  eta: 0:38:50  lr: 0.000089  loss_ita: 0.0010  lr_temp_net: 0.00003000  loss_temp: 0.6069  avg_image_tau: 0.0344  avg_text_tau: 0.0349  time: 1.1291  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 350/2244]  eta: 0:37:32  lr: 0.000129  loss_ita: 0.0003  lr_temp_net: 0.00003000  loss_temp: 0.5852  avg_image_tau: 0.0335  avg_text_tau: 0.0339  time: 1.1222  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 400/2244]  eta: 0:36:18  lr: 0.000129  loss_ita: -0.0044  lr_temp_net: 0.00003000  loss_temp: 0.5652  avg_image_tau: 0.0326  avg_text_tau: 0.0328  time: 1.1280  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 450/2244]  eta: 0:35:07  lr: 0.000168  loss_ita: 0.0012  lr_temp_net: 0.00003000  loss_temp: 0.5345  avg_image_tau: 0.0317  avg_text_tau: 0.0319  time: 1.1277  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 500/2244]  eta: 0:34:00  lr: 0.000168  loss_ita: 0.0135  lr_temp_net: 0.00003000  loss_temp: 0.5064  avg_image_tau: 0.0310  avg_text_tau: 0.0311  time: 1.1252  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 550/2244]  eta: 0:32:57  lr: 0.000207  loss_ita: -0.0012  lr_temp_net: 0.00003000  loss_temp: 0.5037  avg_image_tau: 0.0300  avg_text_tau: 0.0300  time: 1.1190  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 600/2244]  eta: 0:31:53  lr: 0.000207  loss_ita: -0.0031  lr_temp_net: 0.00003000  loss_temp: 0.4783  avg_image_tau: 0.0293  avg_text_tau: 0.0293  time: 1.1262  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 650/2244]  eta: 0:30:53  lr: 0.000247  loss_ita: -0.0013  lr_temp_net: 0.00003000  loss_temp: 0.4574  avg_image_tau: 0.0284  avg_text_tau: 0.0284  time: 1.1233  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 700/2244]  eta: 0:29:51  lr: 0.000247  loss_ita: 0.0025  lr_temp_net: 0.00003000  loss_temp: 0.4414  avg_image_tau: 0.0277  avg_text_tau: 0.0275  time: 1.1223  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 750/2244]  eta: 0:28:49  lr: 0.000287  loss_ita: 0.0075  lr_temp_net: 0.00003000  loss_temp: 0.4171  avg_image_tau: 0.0269  avg_text_tau: 0.0267  time: 1.1229  data: 0.0016  max mem: 22279
Train Epoch: [0]  [ 800/2244]  eta: 0:27:47  lr: 0.000287  loss_ita: -0.0004  lr_temp_net: 0.00003000  loss_temp: 0.4057  avg_image_tau: 0.0261  avg_text_tau: 0.0258  time: 1.1193  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 850/2244]  eta: 0:26:46  lr: 0.000326  loss_ita: 0.0009  lr_temp_net: 0.00003000  loss_temp: 0.3893  avg_image_tau: 0.0253  avg_text_tau: 0.0249  time: 1.1166  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 900/2244]  eta: 0:25:47  lr: 0.000326  loss_ita: 0.0026  lr_temp_net: 0.00003000  loss_temp: 0.3698  avg_image_tau: 0.0244  avg_text_tau: 0.0241  time: 1.1247  data: 0.0015  max mem: 22279
Train Epoch: [0]  [ 950/2244]  eta: 0:24:47  lr: 0.000365  loss_ita: -0.0019  lr_temp_net: 0.00003000  loss_temp: 0.3583  avg_image_tau: 0.0237  avg_text_tau: 0.0232  time: 1.1204  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1000/2244]  eta: 0:23:48  lr: 0.000365  loss_ita: 0.0029  lr_temp_net: 0.00003000  loss_temp: 0.3405  avg_image_tau: 0.0229  avg_text_tau: 0.0225  time: 1.1246  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1050/2244]  eta: 0:22:47  lr: 0.000405  loss_ita: 0.0007  lr_temp_net: 0.00003000  loss_temp: 0.3260  avg_image_tau: 0.0222  avg_text_tau: 0.0217  time: 1.0908  data: 0.0014  max mem: 22279
Train Epoch: [0]  [1100/2244]  eta: 0:21:47  lr: 0.000405  loss_ita: 0.0000  lr_temp_net: 0.00003000  loss_temp: 0.3144  avg_image_tau: 0.0214  avg_text_tau: 0.0209  time: 1.0849  data: 0.0014  max mem: 22279
Train Epoch: [0]  [1150/2244]  eta: 0:20:47  lr: 0.000445  loss_ita: -0.0033  lr_temp_net: 0.00003000  loss_temp: 0.2999  avg_image_tau: 0.0206  avg_text_tau: 0.0201  time: 1.1001  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1200/2244]  eta: 0:19:50  lr: 0.000445  loss_ita: 0.0009  lr_temp_net: 0.00003000  loss_temp: 0.2851  avg_image_tau: 0.0200  avg_text_tau: 0.0193  time: 1.1228  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1250/2244]  eta: 0:18:52  lr: 0.000484  loss_ita: -0.0025  lr_temp_net: 0.00003000  loss_temp: 0.2734  avg_image_tau: 0.0192  avg_text_tau: 0.0186  time: 1.1239  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1300/2244]  eta: 0:17:54  lr: 0.000484  loss_ita: 0.0002  lr_temp_net: 0.00003000  loss_temp: 0.2567  avg_image_tau: 0.0184  avg_text_tau: 0.0179  time: 1.1070  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1350/2244]  eta: 0:16:56  lr: 0.000523  loss_ita: 0.0011  lr_temp_net: 0.00003000  loss_temp: 0.2453  avg_image_tau: 0.0177  avg_text_tau: 0.0171  time: 1.0842  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1400/2244]  eta: 0:15:58  lr: 0.000523  loss_ita: -0.0001  lr_temp_net: 0.00003000  loss_temp: 0.2334  avg_image_tau: 0.0171  avg_text_tau: 0.0164  time: 1.1170  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1450/2244]  eta: 0:15:01  lr: 0.000563  loss_ita: 0.0012  lr_temp_net: 0.00003000  loss_temp: 0.2190  avg_image_tau: 0.0162  avg_text_tau: 0.0156  time: 1.1190  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1500/2244]  eta: 0:14:03  lr: 0.000563  loss_ita: -0.0039  lr_temp_net: 0.00003000  loss_temp: 0.2129  avg_image_tau: 0.0155  avg_text_tau: 0.0149  time: 1.1211  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1550/2244]  eta: 0:13:06  lr: 0.000602  loss_ita: -0.0005  lr_temp_net: 0.00003000  loss_temp: 0.1961  avg_image_tau: 0.0147  avg_text_tau: 0.0141  time: 1.1209  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1600/2244]  eta: 0:12:10  lr: 0.000602  loss_ita: 0.0006  lr_temp_net: 0.00003000  loss_temp: 0.1828  avg_image_tau: 0.0141  avg_text_tau: 0.0134  time: 1.1256  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1650/2244]  eta: 0:11:13  lr: 0.000642  loss_ita: -0.0012  lr_temp_net: 0.00003000  loss_temp: 0.1760  avg_image_tau: 0.0133  avg_text_tau: 0.0127  time: 1.1256  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1700/2244]  eta: 0:10:16  lr: 0.000642  loss_ita: -0.0004  lr_temp_net: 0.00003000  loss_temp: 0.1635  avg_image_tau: 0.0127  avg_text_tau: 0.0121  time: 1.1262  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1750/2244]  eta: 0:09:19  lr: 0.000682  loss_ita: -0.0011  lr_temp_net: 0.00003000  loss_temp: 0.1525  avg_image_tau: 0.0118  avg_text_tau: 0.0114  time: 1.1281  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1800/2244]  eta: 0:08:23  lr: 0.000682  loss_ita: -0.0023  lr_temp_net: 0.00003000  loss_temp: 0.1418  avg_image_tau: 0.0110  avg_text_tau: 0.0107  time: 1.1291  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1850/2244]  eta: 0:07:26  lr: 0.000721  loss_ita: 0.0015  lr_temp_net: 0.00003000  loss_temp: 0.1301  avg_image_tau: 0.0103  avg_text_tau: 0.0100  time: 1.1262  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1900/2244]  eta: 0:06:29  lr: 0.000721  loss_ita: 0.0005  lr_temp_net: 0.00003000  loss_temp: 0.1212  avg_image_tau: 0.0097  avg_text_tau: 0.0093  time: 1.1294  data: 0.0015  max mem: 22279
Train Epoch: [0]  [1950/2244]  eta: 0:05:32  lr: 0.000760  loss_ita: -0.0002  lr_temp_net: 0.00003000  loss_temp: 0.1134  avg_image_tau: 0.0088  avg_text_tau: 0.0087  time: 1.1266  data: 0.0015  max mem: 22279
Train Epoch: [0]  [2000/2244]  eta: 0:04:36  lr: 0.000760  loss_ita: -0.0017  lr_temp_net: 0.00003000  loss_temp: 0.1055  avg_image_tau: 0.0082  avg_text_tau: 0.0080  time: 1.1338  data: 0.0015  max mem: 22279
Train Epoch: [0]  [2050/2244]  eta: 0:03:39  lr: 0.000800  loss_ita: 0.0004  lr_temp_net: 0.00003000  loss_temp: 0.0949  avg_image_tau: 0.0074  avg_text_tau: 0.0074  time: 1.1302  data: 0.0015  max mem: 22279
Train Epoch: [0]  [2100/2244]  eta: 0:02:43  lr: 0.000800  loss_ita: -0.0013  lr_temp_net: 0.00003000  loss_temp: 0.0856  avg_image_tau: 0.0067  avg_text_tau: 0.0068  time: 1.1298  data: 0.0015  max mem: 22279
Train Epoch: [0]  [2150/2244]  eta: 0:01:46  lr: 0.000800  loss_ita: 0.0012  lr_temp_net: 0.00003000  loss_temp: 0.0761  avg_image_tau: 0.0060  avg_text_tau: 0.0061  time: 1.1280  data: 0.0014  max mem: 22279
Train Epoch: [0]  [2200/2244]  eta: 0:00:49  lr: 0.000800  loss_ita: 0.0000  lr_temp_net: 0.00003000  loss_temp: 0.0700  avg_image_tau: 0.0054  avg_text_tau: 0.0055  time: 1.1277  data: 0.0015  max mem: 22279
Train Epoch: [0]  [2243/2244]  eta: 0:00:01  lr: 0.000800  loss_ita: -0.0001  lr_temp_net: 0.00003000  loss_temp: 0.0610  avg_image_tau: 0.0047  avg_text_tau: 0.0050  time: 1.0973  data: 0.0015  max mem: 22279
Train Epoch: [0] Total time: 0:42:20 (1.1321 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0004  lr_temp_net: 0.0000  loss_temp: 0.3421  avg_image_tau: 0.0215  avg_text_tau: 0.0213
Computing features for evaluation...
Evaluation time 0:00:52
Computing features for evaluation...
Evaluation time 0:00:50
Computing features for evaluation...
Evaluation time 0:00:17
Computing features for evaluation...
Evaluation time 0:00:18
coco val: {'txt_r1': 4.54, 'txt_r5': 12.96, 'txt_r10': 18.86, 'txt_r_mean': 12.12, 'img_r1': 2.5629748100759695, 'img_r5': 8.548580567772891, 'img_r10': 13.494602159136345, 'img_r_mean': 8.202052512328402, 'r_mean': 10.1610262561642}
coco test: {'txt_r1': 4.62, 'txt_r5': 12.98, 'txt_r10': 18.92, 'txt_r_mean': 12.173333333333334, 'img_r1': 2.734906037584966, 'img_r5': 8.884446221511395, 'img_r10': 13.786485405837665, 'img_r_mean': 8.468612554978009, 'r_mean': 10.32097294415567}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [1]  [   0/2244]  eta: 2:05:11  lr: 0.000798  loss_ita: 0.0085  lr_temp_net: 0.00002700  loss_temp: 0.0766  avg_image_tau: 0.0047  avg_text_tau: 0.0051  time: 3.3472  data: 2.7576  max mem: 22279
Train Epoch: [1]  [  50/2244]  eta: 0:42:15  lr: 0.000798  loss_ita: 0.0004  lr_temp_net: 0.00002700  loss_temp: 0.0647  avg_image_tau: 0.0036  avg_text_tau: 0.0042  time: 1.0872  data: 0.1114  max mem: 22279
Train Epoch: [1]  [ 100/2244]  eta: 0:40:43  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0525  avg_image_tau: 0.0029  avg_text_tau: 0.0034  time: 1.1199  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 150/2244]  eta: 0:39:40  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0440  avg_image_tau: 0.0025  avg_text_tau: 0.0029  time: 1.1299  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 200/2244]  eta: 0:38:40  lr: 0.000798  loss_ita: 0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0370  avg_image_tau: 0.0022  avg_text_tau: 0.0024  time: 1.1319  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 250/2244]  eta: 0:37:39  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0326  avg_image_tau: 0.0019  avg_text_tau: 0.0021  time: 1.1226  data: 0.0016  max mem: 22279
Train Epoch: [1]  [ 300/2244]  eta: 0:36:42  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0294  avg_image_tau: 0.0018  avg_text_tau: 0.0020  time: 1.1341  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 350/2244]  eta: 0:35:44  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0276  avg_image_tau: 0.0017  avg_text_tau: 0.0019  time: 1.1261  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 400/2244]  eta: 0:34:46  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0250  avg_image_tau: 0.0015  avg_text_tau: 0.0017  time: 1.1269  data: 0.0016  max mem: 22279
Train Epoch: [1]  [ 450/2244]  eta: 0:33:50  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0232  avg_image_tau: 0.0014  avg_text_tau: 0.0016  time: 1.1262  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 500/2244]  eta: 0:32:52  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0223  avg_image_tau: 0.0014  avg_text_tau: 0.0015  time: 1.1258  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 550/2244]  eta: 0:31:55  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0213  avg_image_tau: 0.0014  avg_text_tau: 0.0014  time: 1.1331  data: 0.0016  max mem: 22279
Train Epoch: [1]  [ 600/2244]  eta: 0:30:59  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0201  avg_image_tau: 0.0013  avg_text_tau: 0.0014  time: 1.1274  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 650/2244]  eta: 0:30:02  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0189  avg_image_tau: 0.0013  avg_text_tau: 0.0013  time: 1.1281  data: 0.0016  max mem: 22279
Train Epoch: [1]  [ 700/2244]  eta: 0:29:05  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0182  avg_image_tau: 0.0012  avg_text_tau: 0.0013  time: 1.1286  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 750/2244]  eta: 0:28:08  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0180  avg_image_tau: 0.0012  avg_text_tau: 0.0013  time: 1.1266  data: 0.0015  max mem: 22279
Train Epoch: [1]  [ 800/2244]  eta: 0:27:12  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0171  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 1.1290  data: 0.0016  max mem: 22279
Train Epoch: [1]  [ 850/2244]  eta: 0:26:16  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0167  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 1.1148  data: 0.1864  max mem: 22279
Train Epoch: [1]  [ 900/2244]  eta: 0:25:20  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0166  avg_image_tau: 0.0012  avg_text_tau: 0.0012  time: 1.1658  data: 0.1087  max mem: 22279
Train Epoch: [1]  [ 950/2244]  eta: 0:24:23  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0161  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.1377  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1000/2244]  eta: 0:23:27  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0156  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.1248  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1050/2244]  eta: 0:22:30  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0153  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.1209  data: 0.0115  max mem: 22279
Train Epoch: [1]  [1100/2244]  eta: 0:21:34  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0154  avg_image_tau: 0.0011  avg_text_tau: 0.0012  time: 1.1348  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1150/2244]  eta: 0:20:37  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0151  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1370  data: 0.0016  max mem: 22279
Train Epoch: [1]  [1200/2244]  eta: 0:19:41  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0150  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1313  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1250/2244]  eta: 0:18:45  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0146  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1286  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1300/2244]  eta: 0:17:48  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0143  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1368  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1350/2244]  eta: 0:16:51  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0140  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1044  data: 0.0344  max mem: 22279
Train Epoch: [1]  [1400/2244]  eta: 0:15:54  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0139  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1197  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1450/2244]  eta: 0:14:58  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0138  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1354  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1500/2244]  eta: 0:14:02  lr: 0.000798  loss_ita: -0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0139  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1405  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1550/2244]  eta: 0:13:05  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0137  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1284  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1600/2244]  eta: 0:12:08  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0134  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1217  data: 0.0224  max mem: 22279
Train Epoch: [1]  [1650/2244]  eta: 0:11:11  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0133  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1264  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1700/2244]  eta: 0:10:15  lr: 0.000798  loss_ita: 0.0003  lr_temp_net: 0.00002700  loss_temp: 0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1349  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1750/2244]  eta: 0:09:18  lr: 0.000798  loss_ita: -0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0132  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1251  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1800/2244]  eta: 0:08:22  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1279  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1850/2244]  eta: 0:07:25  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0129  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1595  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1900/2244]  eta: 0:06:29  lr: 0.000798  loss_ita: 0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0128  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1306  data: 0.0015  max mem: 22279
Train Epoch: [1]  [1950/2244]  eta: 0:05:32  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0129  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.1156  data: 0.0015  max mem: 22279
Train Epoch: [1]  [2000/2244]  eta: 0:04:35  lr: 0.000798  loss_ita: -0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1282  data: 0.0015  max mem: 22279
Train Epoch: [1]  [2050/2244]  eta: 0:03:39  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1289  data: 0.0015  max mem: 22279
Train Epoch: [1]  [2100/2244]  eta: 0:02:42  lr: 0.000798  loss_ita: 0.0000  lr_temp_net: 0.00002700  loss_temp: 0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1228  data: 0.0015  max mem: 22279
Train Epoch: [1]  [2150/2244]  eta: 0:01:46  lr: 0.000798  loss_ita: -0.0002  lr_temp_net: 0.00002700  loss_temp: 0.0133  avg_image_tau: 0.0011  avg_text_tau: 0.0011  time: 1.0865  data: 0.0015  max mem: 22279
Train Epoch: [1]  [2200/2244]  eta: 0:00:49  lr: 0.000798  loss_ita: 0.0001  lr_temp_net: 0.00002700  loss_temp: 0.0130  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.0102  data: 0.0017  max mem: 22279
Train Epoch: [1]  [2243/2244]  eta: 0:00:01  lr: 0.000798  loss_ita: 0.0004  lr_temp_net: 0.00002700  loss_temp: 0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1128  data: 0.0015  max mem: 22279
Train Epoch: [1] Total time: 0:42:13 (1.1290 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0202  avg_image_tau: 0.0014  avg_text_tau: 0.0015
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:23
Computing features for evaluation...
Evaluation time 0:00:05
Computing features for evaluation...
Evaluation time 0:00:05
coco val: {'txt_r1': 6.62, 'txt_r5': 17.54, 'txt_r10': 24.76, 'txt_r_mean': 16.30666666666667, 'img_r1': 3.7984806077568973, 'img_r5': 11.615353858456617, 'img_r10': 17.888844462215115, 'img_r_mean': 11.100892976142875, 'r_mean': 13.703779821404773}
coco test: {'txt_r1': 6.44, 'txt_r5': 17.14, 'txt_r10': 25.54, 'txt_r_mean': 16.373333333333335, 'img_r1': 3.914434226309476, 'img_r5': 11.867253098760496, 'img_r10': 18.22870851659336, 'img_r_mean': 11.336798613887778, 'r_mean': 13.855065973610557}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [2]  [   0/2244]  eta: 2:07:45  lr: 0.000793  loss_ita: 0.0008  lr_temp_net: 0.00002430  loss_temp: 0.0153  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 3.4162  data: 2.8859  max mem: 22279
Train Epoch: [2]  [  50/2244]  eta: 0:42:25  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0151  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.0949  data: 0.2374  max mem: 22279
Train Epoch: [2]  [ 100/2244]  eta: 0:40:30  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0151  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1206  data: 0.0017  max mem: 22279
Train Epoch: [2]  [ 150/2244]  eta: 0:39:25  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0148  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1197  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 200/2244]  eta: 0:38:24  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0146  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1180  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 250/2244]  eta: 0:37:14  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0145  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.0843  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 300/2244]  eta: 0:36:07  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0141  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0837  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 350/2244]  eta: 0:35:07  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1208  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 400/2244]  eta: 0:34:16  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1332  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 450/2244]  eta: 0:33:23  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0136  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1261  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 500/2244]  eta: 0:32:29  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0134  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1268  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 550/2244]  eta: 0:31:35  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0133  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1280  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 600/2244]  eta: 0:30:40  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0131  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1301  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 650/2244]  eta: 0:29:45  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1327  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 700/2244]  eta: 0:28:50  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1256  data: 0.0016  max mem: 22279
Train Epoch: [2]  [ 750/2244]  eta: 0:27:55  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1403  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 800/2244]  eta: 0:27:00  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1310  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 850/2244]  eta: 0:26:05  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1377  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 900/2244]  eta: 0:25:08  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0847  data: 0.0015  max mem: 22279
Train Epoch: [2]  [ 950/2244]  eta: 0:24:09  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0837  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1000/2244]  eta: 0:23:12  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0125  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0881  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1050/2244]  eta: 0:22:15  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0968  data: 0.1706  max mem: 22279
Train Epoch: [2]  [1100/2244]  eta: 0:21:18  lr: 0.000793  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0122  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1164  data: 0.0016  max mem: 22279
Train Epoch: [2]  [1150/2244]  eta: 0:20:24  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0121  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.2134  data: 0.0032  max mem: 22279
Train Epoch: [2]  [1200/2244]  eta: 0:19:29  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0122  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1290  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1250/2244]  eta: 0:18:34  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1281  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1300/2244]  eta: 0:17:39  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1295  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1350/2244]  eta: 0:16:43  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1252  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1400/2244]  eta: 0:15:47  lr: 0.000793  loss_ita: -0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1209  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1450/2244]  eta: 0:14:51  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1183  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1500/2244]  eta: 0:13:55  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1236  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1550/2244]  eta: 0:12:59  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1240  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1600/2244]  eta: 0:12:02  lr: 0.000793  loss_ita: 0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1213  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1650/2244]  eta: 0:11:06  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1118  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1700/2244]  eta: 0:10:10  lr: 0.000793  loss_ita: 0.0001  lr_temp_net: 0.00002430  loss_temp: 0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0016  max mem: 22279
Train Epoch: [2]  [1750/2244]  eta: 0:09:14  lr: 0.000793  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1800/2244]  eta: 0:08:18  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1850/2244]  eta: 0:07:21  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1062  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1900/2244]  eta: 0:06:25  lr: 0.000793  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1188  data: 0.0015  max mem: 22279
Train Epoch: [2]  [1950/2244]  eta: 0:05:29  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [2]  [2000/2244]  eta: 0:04:33  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0043  max mem: 22279
Train Epoch: [2]  [2050/2244]  eta: 0:03:37  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1218  data: 0.0015  max mem: 22279
Train Epoch: [2]  [2100/2244]  eta: 0:02:41  lr: 0.000793  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1244  data: 0.0015  max mem: 22279
Train Epoch: [2]  [2150/2244]  eta: 0:01:45  lr: 0.000793  loss_ita: -0.0000  lr_temp_net: 0.00002430  loss_temp: 0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1231  data: 0.0015  max mem: 22279
Train Epoch: [2]  [2200/2244]  eta: 0:00:49  lr: 0.000793  loss_ita: 0.0002  lr_temp_net: 0.00002430  loss_temp: 0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1167  data: 0.0015  max mem: 22279
Train Epoch: [2]  [2243/2244]  eta: 0:00:01  lr: 0.000793  loss_ita: 0.0003  lr_temp_net: 0.00002430  loss_temp: 0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1350  data: 0.0015  max mem: 22279
Train Epoch: [2] Total time: 0:41:54 (1.1204 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:25
Computing features for evaluation...
Evaluation time 0:00:24
Computing features for evaluation...
Evaluation time 0:00:06
Computing features for evaluation...
Evaluation time 0:00:06
coco val: {'txt_r1': 8.64, 'txt_r5': 20.96, 'txt_r10': 28.82, 'txt_r_mean': 19.473333333333333, 'img_r1': 5.393842463014794, 'img_r5': 14.938024790083967, 'img_r10': 21.76329468212715, 'img_r_mean': 14.031720645075303, 'r_mean': 16.75252698920432}
coco test: {'txt_r1': 8.5, 'txt_r5': 20.78, 'txt_r10': 29.68, 'txt_r_mean': 19.653333333333332, 'img_r1': 5.1179528188724515, 'img_r5': 15.065973610555778, 'img_r10': 22.23110755697721, 'img_r_mean': 14.138344662135147, 'r_mean': 16.895838997734238}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [3]  [   0/2244]  eta: 3:40:52  lr: 0.000784  loss_ita: 0.0009  lr_temp_net: 0.00002187  loss_temp: 0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.9058  data: 3.1382  max mem: 22279
Train Epoch: [3]  [  50/2244]  eta: 0:43:43  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0130  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1274  data: 0.0017  max mem: 22279
Train Epoch: [3]  [ 100/2244]  eta: 0:41:27  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1262  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 150/2244]  eta: 0:40:06  lr: 0.000784  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1243  data: 0.0187  max mem: 22279
Train Epoch: [3]  [ 200/2244]  eta: 0:38:58  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1366  data: 0.0021  max mem: 22279
Train Epoch: [3]  [ 250/2244]  eta: 0:37:53  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1314  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 300/2244]  eta: 0:36:52  lr: 0.000784  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1345  data: 0.0014  max mem: 22279
Train Epoch: [3]  [ 350/2244]  eta: 0:35:51  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1226  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 400/2244]  eta: 0:34:52  lr: 0.000784  loss_ita: -0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1256  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 450/2244]  eta: 0:33:56  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0978  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 500/2244]  eta: 0:32:52  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0924  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 550/2244]  eta: 0:31:51  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0872  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 600/2244]  eta: 0:30:50  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0956  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 650/2244]  eta: 0:29:49  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0968  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 700/2244]  eta: 0:28:50  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0907  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 750/2244]  eta: 0:27:51  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0895  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 800/2244]  eta: 0:26:52  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0893  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 850/2244]  eta: 0:25:54  lr: 0.000784  loss_ita: -0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0986  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 900/2244]  eta: 0:24:57  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0931  data: 0.0015  max mem: 22279
Train Epoch: [3]  [ 950/2244]  eta: 0:23:59  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0111  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0855  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1000/2244]  eta: 0:23:03  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0969  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1050/2244]  eta: 0:22:06  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0111  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0946  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1100/2244]  eta: 0:21:10  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0111  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0931  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1150/2244]  eta: 0:20:15  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1018  data: 0.1202  max mem: 22279
Train Epoch: [3]  [1200/2244]  eta: 0:19:19  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1099  data: 0.0017  max mem: 22279
Train Epoch: [3]  [1250/2244]  eta: 0:18:24  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1300/2244]  eta: 0:17:28  lr: 0.000784  loss_ita: 0.0003  lr_temp_net: 0.00002187  loss_temp: 0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1128  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1350/2244]  eta: 0:16:33  lr: 0.000784  loss_ita: -0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1183  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1400/2244]  eta: 0:15:37  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1032  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1450/2244]  eta: 0:14:41  lr: 0.000784  loss_ita: -0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1052  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1500/2244]  eta: 0:13:46  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1112  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1550/2244]  eta: 0:12:50  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1600/2244]  eta: 0:11:55  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1650/2244]  eta: 0:10:59  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1157  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1700/2244]  eta: 0:10:04  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1750/2244]  eta: 0:09:08  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1800/2244]  eta: 0:08:13  lr: 0.000784  loss_ita: 0.0000  lr_temp_net: 0.00002187  loss_temp: 0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [3]  [1850/2244]  eta: 0:07:17  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0016  max mem: 22279
Train Epoch: [3]  [1900/2244]  eta: 0:06:22  lr: 0.000784  loss_ita: 0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0016  max mem: 22279
Train Epoch: [3]  [1950/2244]  eta: 0:05:26  lr: 0.000784  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2000/2244]  eta: 0:04:30  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2050/2244]  eta: 0:03:35  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1178  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2100/2244]  eta: 0:02:39  lr: 0.000784  loss_ita: -0.0002  lr_temp_net: 0.00002187  loss_temp: 0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2150/2244]  eta: 0:01:44  lr: 0.000784  loss_ita: -0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2200/2244]  eta: 0:00:48  lr: 0.000784  loss_ita: 0.0001  lr_temp_net: 0.00002187  loss_temp: 0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0015  max mem: 22279
Train Epoch: [3]  [2243/2244]  eta: 0:00:01  lr: 0.000784  loss_ita: 0.0006  lr_temp_net: 0.00002187  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1670  data: 0.0015  max mem: 22279
Train Epoch: [3] Total time: 0:41:34 (1.1117 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:35
Computing features for evaluation...
Evaluation time 0:00:30
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:09
coco val: {'txt_r1': 10.92, 'txt_r5': 26.4, 'txt_r10': 35.36, 'txt_r_mean': 24.22666666666667, 'img_r1': 6.585365853658536, 'img_r5': 18.18872451019592, 'img_r10': 25.865653738504598, 'img_r_mean': 16.879914700786355, 'r_mean': 20.553290683726512}
coco test: {'txt_r1': 11.3, 'txt_r5': 26.78, 'txt_r10': 36.42, 'txt_r_mean': 24.833333333333332, 'img_r1': 6.457417033186725, 'img_r5': 18.028788484606157, 'img_r10': 26.3734506197521, 'img_r_mean': 16.953218712514992, 'r_mean': 20.893276022924162}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [4]  [   0/2244]  eta: 3:10:08  lr: 0.000772  loss_ita: 0.0007  lr_temp_net: 0.00001968  loss_temp: 0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.0841  data: 2.9332  max mem: 22279
Train Epoch: [4]  [  50/2244]  eta: 0:42:36  lr: 0.000772  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0912  data: 0.0017  max mem: 22279
Train Epoch: [4]  [ 100/2244]  eta: 0:40:19  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0974  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 150/2244]  eta: 0:38:57  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0877  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 200/2244]  eta: 0:37:53  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 250/2244]  eta: 0:36:57  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 300/2244]  eta: 0:36:01  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 350/2244]  eta: 0:35:05  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1047  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 400/2244]  eta: 0:34:09  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1135  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 450/2244]  eta: 0:33:13  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1080  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 500/2244]  eta: 0:32:17  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1078  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 550/2244]  eta: 0:31:21  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0926  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 600/2244]  eta: 0:30:26  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 650/2244]  eta: 0:29:30  lr: 0.000772  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0098  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 700/2244]  eta: 0:28:34  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 750/2244]  eta: 0:27:38  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1099  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 800/2244]  eta: 0:26:42  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0819  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 850/2244]  eta: 0:25:45  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0098  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1311  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 900/2244]  eta: 0:24:50  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1151  data: 0.0015  max mem: 22279
Train Epoch: [4]  [ 950/2244]  eta: 0:23:56  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1251  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1000/2244]  eta: 0:23:03  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1995  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1050/2244]  eta: 0:22:09  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1645  data: 0.0014  max mem: 22279
Train Epoch: [4]  [1100/2244]  eta: 0:21:14  lr: 0.000772  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1265  data: 0.0014  max mem: 22279
Train Epoch: [4]  [1150/2244]  eta: 0:20:20  lr: 0.000772  loss_ita: 0.0003  lr_temp_net: 0.00001968  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1318  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1200/2244]  eta: 0:19:25  lr: 0.000772  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1210  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1250/2244]  eta: 0:18:29  lr: 0.000772  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1158  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1300/2244]  eta: 0:17:34  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1196  data: 0.0016  max mem: 22279
Train Epoch: [4]  [1350/2244]  eta: 0:16:38  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1134  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1400/2244]  eta: 0:15:43  lr: 0.000772  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1294  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1450/2244]  eta: 0:14:48  lr: 0.000772  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1252  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1500/2244]  eta: 0:13:52  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1259  data: 0.0016  max mem: 22279
Train Epoch: [4]  [1550/2244]  eta: 0:12:56  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1210  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1600/2244]  eta: 0:12:00  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0676  data: 0.5356  max mem: 22279
Train Epoch: [4]  [1650/2244]  eta: 0:11:04  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1193  data: 0.0054  max mem: 22279
Train Epoch: [4]  [1700/2244]  eta: 0:10:08  lr: 0.000772  loss_ita: -0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1280  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1750/2244]  eta: 0:09:12  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1168  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1800/2244]  eta: 0:08:17  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1236  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1850/2244]  eta: 0:07:21  lr: 0.000772  loss_ita: -0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1311  data: 0.0015  max mem: 22279
Train Epoch: [4]  [1900/2244]  eta: 0:06:25  lr: 0.000772  loss_ita: -0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1188  data: 0.0016  max mem: 22279
Train Epoch: [4]  [1950/2244]  eta: 0:05:29  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1272  data: 0.0014  max mem: 22279
Train Epoch: [4]  [2000/2244]  eta: 0:04:33  lr: 0.000772  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1228  data: 0.0015  max mem: 22279
Train Epoch: [4]  [2050/2244]  eta: 0:03:37  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1248  data: 0.0015  max mem: 22279
Train Epoch: [4]  [2100/2244]  eta: 0:02:41  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1216  data: 0.0015  max mem: 22279
Train Epoch: [4]  [2150/2244]  eta: 0:01:45  lr: 0.000772  loss_ita: 0.0000  lr_temp_net: 0.00001968  loss_temp: 0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1243  data: 0.0015  max mem: 22279
Train Epoch: [4]  [2200/2244]  eta: 0:00:49  lr: 0.000772  loss_ita: 0.0001  lr_temp_net: 0.00001968  loss_temp: 0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1228  data: 0.0015  max mem: 22279
Train Epoch: [4]  [2243/2244]  eta: 0:00:01  lr: 0.000772  loss_ita: 0.0002  lr_temp_net: 0.00001968  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1264  data: 0.0015  max mem: 22279
Train Epoch: [4] Total time: 0:41:53 (1.1203 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 15.82, 'txt_r5': 33.86, 'txt_r10': 44.22, 'txt_r_mean': 31.3, 'img_r1': 9.31627349060376, 'img_r5': 23.326669332267095, 'img_r10': 32.64294282287085, 'img_r_mean': 21.7619618819139, 'r_mean': 26.53098094095695}
coco test: {'txt_r1': 15.18, 'txt_r5': 33.62, 'txt_r10': 44.68, 'txt_r_mean': 31.159999999999997, 'img_r1': 8.808476609356257, 'img_r5': 23.58656537385046, 'img_r10': 33.21471411435426, 'img_r_mean': 21.869918699186993, 'r_mean': 26.514959349593497}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [5]  [   0/2244]  eta: 2:26:50  lr: 0.000756  loss_ita: 0.0006  lr_temp_net: 0.00001771  loss_temp: 0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.9263  data: 2.8161  max mem: 22279
Train Epoch: [5]  [  50/2244]  eta: 0:43:35  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1267  data: 0.0016  max mem: 22279
Train Epoch: [5]  [ 100/2244]  eta: 0:41:21  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1235  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 150/2244]  eta: 0:40:00  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1211  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 200/2244]  eta: 0:38:53  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1223  data: 0.0014  max mem: 22279
Train Epoch: [5]  [ 250/2244]  eta: 0:37:48  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1246  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 300/2244]  eta: 0:36:46  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1252  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 350/2244]  eta: 0:35:46  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1184  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 400/2244]  eta: 0:34:47  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1282  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 450/2244]  eta: 0:33:47  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0016  max mem: 22279
Train Epoch: [5]  [ 500/2244]  eta: 0:32:49  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1247  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 550/2244]  eta: 0:31:51  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1194  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 600/2244]  eta: 0:30:54  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1269  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 650/2244]  eta: 0:29:57  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1263  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 700/2244]  eta: 0:29:00  lr: 0.000756  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1195  data: 0.0015  max mem: 22279
Train Epoch: [5]  [ 750/2244]  eta: 0:28:03  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0016  max mem: 22279
Train Epoch: [5]  [ 800/2244]  eta: 0:27:06  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1266  data: 0.0014  max mem: 22279
Train Epoch: [5]  [ 850/2244]  eta: 0:26:10  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1213  data: 0.0014  max mem: 22279
Train Epoch: [5]  [ 900/2244]  eta: 0:25:13  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1255  data: 0.0014  max mem: 22279
Train Epoch: [5]  [ 950/2244]  eta: 0:24:17  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1221  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1000/2244]  eta: 0:23:20  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1133  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1050/2244]  eta: 0:22:24  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1296  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1100/2244]  eta: 0:21:30  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0753  data: 0.3152  max mem: 22279
Train Epoch: [5]  [1150/2244]  eta: 0:20:33  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1244  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1200/2244]  eta: 0:19:37  lr: 0.000756  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1263  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1250/2244]  eta: 0:18:40  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1244  data: 0.0016  max mem: 22279
Train Epoch: [5]  [1300/2244]  eta: 0:17:43  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0768  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1350/2244]  eta: 0:16:45  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0858  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1400/2244]  eta: 0:15:49  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1295  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1450/2244]  eta: 0:14:52  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1192  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1500/2244]  eta: 0:13:56  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1352  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1550/2244]  eta: 0:13:00  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1245  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1600/2244]  eta: 0:12:04  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1277  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1650/2244]  eta: 0:11:08  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1201  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1700/2244]  eta: 0:10:12  lr: 0.000756  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1402  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1750/2244]  eta: 0:09:16  lr: 0.000756  loss_ita: 0.0003  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1325  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1800/2244]  eta: 0:08:19  lr: 0.000756  loss_ita: -0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1302  data: 0.0015  max mem: 22279
Train Epoch: [5]  [1850/2244]  eta: 0:07:23  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1291  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1900/2244]  eta: 0:06:27  lr: 0.000756  loss_ita: 0.0002  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1334  data: 0.0014  max mem: 22279
Train Epoch: [5]  [1950/2244]  eta: 0:05:31  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1282  data: 0.0015  max mem: 22279
Train Epoch: [5]  [2000/2244]  eta: 0:04:35  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1298  data: 0.0014  max mem: 22279
Train Epoch: [5]  [2050/2244]  eta: 0:03:38  lr: 0.000756  loss_ita: 0.0000  lr_temp_net: 0.00001771  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1288  data: 0.0015  max mem: 22279
Train Epoch: [5]  [2100/2244]  eta: 0:02:42  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1411  data: 0.0014  max mem: 22279
Train Epoch: [5]  [2150/2244]  eta: 0:01:45  lr: 0.000756  loss_ita: 0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1198  data: 0.0087  max mem: 22279
Train Epoch: [5]  [2200/2244]  eta: 0:00:49  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0842  data: 0.0015  max mem: 22279
Train Epoch: [5]  [2243/2244]  eta: 0:00:01  lr: 0.000756  loss_ita: -0.0001  lr_temp_net: 0.00001771  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1361  data: 0.0014  max mem: 22279
Train Epoch: [5] Total time: 0:42:07 (1.1262 s / it)
Averaged stats: lr: 0.0008  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:30
Computing features for evaluation...
Evaluation time 0:00:30
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 18.68, 'txt_r5': 37.98, 'txt_r10': 48.96, 'txt_r_mean': 35.20666666666667, 'img_r1': 10.643742502998801, 'img_r5': 26.385445821671333, 'img_r10': 36.40943622550979, 'img_r_mean': 24.47954151672664, 'r_mean': 29.843104091696656}
coco test: {'txt_r1': 17.46, 'txt_r5': 38.34, 'txt_r10': 48.48, 'txt_r_mean': 34.76, 'img_r1': 10.423830467812875, 'img_r5': 26.61735305877649, 'img_r10': 36.99720111955218, 'img_r_mean': 24.679461548713846, 'r_mean': 29.719730774356922}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [6]  [   0/2244]  eta: 2:19:36  lr: 0.000737  loss_ita: 0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.7327  data: 2.7834  max mem: 22279
Train Epoch: [6]  [  50/2244]  eta: 0:42:31  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0888  data: 0.0016  max mem: 22279
Train Epoch: [6]  [ 100/2244]  eta: 0:40:11  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0874  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 150/2244]  eta: 0:38:45  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0846  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 200/2244]  eta: 0:37:37  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0515  data: 0.0017  max mem: 22279
Train Epoch: [6]  [ 250/2244]  eta: 0:36:34  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0892  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 300/2244]  eta: 0:35:33  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0827  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 350/2244]  eta: 0:34:34  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0763  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 400/2244]  eta: 0:33:38  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0840  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 450/2244]  eta: 0:32:42  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0929  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 500/2244]  eta: 0:31:47  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0831  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 550/2244]  eta: 0:30:50  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0807  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 600/2244]  eta: 0:29:54  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0831  data: 0.0018  max mem: 22279
Train Epoch: [6]  [ 650/2244]  eta: 0:28:58  lr: 0.000737  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0850  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 700/2244]  eta: 0:28:04  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1006  data: 0.0016  max mem: 22279
Train Epoch: [6]  [ 750/2244]  eta: 0:27:11  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 800/2244]  eta: 0:26:18  lr: 0.000737  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1077  data: 0.0016  max mem: 22279
Train Epoch: [6]  [ 850/2244]  eta: 0:25:24  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [6]  [ 900/2244]  eta: 0:24:30  lr: 0.000737  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0972  data: 0.0016  max mem: 22279
Train Epoch: [6]  [ 950/2244]  eta: 0:23:36  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0704  data: 0.0547  max mem: 22279
Train Epoch: [6]  [1000/2244]  eta: 0:22:42  lr: 0.000737  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1050  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1050/2244]  eta: 0:21:48  lr: 0.000737  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0996  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1100/2244]  eta: 0:20:55  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1634  data: 0.0016  max mem: 22279
Train Epoch: [6]  [1150/2244]  eta: 0:19:59  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1002  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1200/2244]  eta: 0:19:05  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1250/2244]  eta: 0:18:10  lr: 0.000737  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1005  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1300/2244]  eta: 0:17:16  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1350/2244]  eta: 0:16:21  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1064  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1400/2244]  eta: 0:15:27  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1035  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1450/2244]  eta: 0:14:32  lr: 0.000737  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1500/2244]  eta: 0:13:36  lr: 0.000737  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0689  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1550/2244]  eta: 0:12:42  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1600/2244]  eta: 0:11:47  lr: 0.000737  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1178  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1650/2244]  eta: 0:10:52  lr: 0.000737  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1100  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1700/2244]  eta: 0:09:58  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1750/2244]  eta: 0:09:03  lr: 0.000737  loss_ita: 0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1170  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1800/2244]  eta: 0:08:08  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1850/2244]  eta: 0:07:13  lr: 0.000737  loss_ita: 0.0003  lr_temp_net: 0.00001594  loss_temp: 0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1148  data: 0.0015  max mem: 22279
Train Epoch: [6]  [1900/2244]  eta: 0:06:18  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1231  data: 0.0014  max mem: 22279
Train Epoch: [6]  [1950/2244]  eta: 0:05:23  lr: 0.000737  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1128  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2000/2244]  eta: 0:04:28  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1037  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2050/2244]  eta: 0:03:33  lr: 0.000737  loss_ita: -0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1053  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2100/2244]  eta: 0:02:38  lr: 0.000737  loss_ita: -0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2150/2244]  eta: 0:01:43  lr: 0.000737  loss_ita: 0.0000  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1222  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2200/2244]  eta: 0:00:48  lr: 0.000737  loss_ita: 0.0001  lr_temp_net: 0.00001594  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1156  data: 0.0015  max mem: 22279
Train Epoch: [6]  [2243/2244]  eta: 0:00:01  lr: 0.000737  loss_ita: -0.0002  lr_temp_net: 0.00001594  loss_temp: 0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1209  data: 0.0015  max mem: 22279
Train Epoch: [6] Total time: 0:41:13 (1.1022 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 19.38, 'txt_r5': 40.8, 'txt_r10': 51.8, 'txt_r_mean': 37.32666666666666, 'img_r1': 11.771291483406637, 'img_r5': 28.112754898040784, 'img_r10': 38.144742103158734, 'img_r_mean': 26.009596161535384, 'r_mean': 31.668131414101023}
coco test: {'txt_r1': 19.8, 'txt_r5': 41.74, 'txt_r10': 52.48, 'txt_r_mean': 38.00666666666667, 'img_r1': 12.12315073970412, 'img_r5': 29.412235105957617, 'img_r10': 39.58416633346661, 'img_r_mean': 27.039850726376116, 'r_mean': 32.523258696521395}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [7]  [   0/2244]  eta: 4:31:44  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.2659  data: 3.4716  max mem: 22279
Train Epoch: [7]  [  50/2244]  eta: 0:42:51  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1026  data: 0.0869  max mem: 22279
Train Epoch: [7]  [ 100/2244]  eta: 0:40:41  lr: 0.000715  loss_ita: 0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 150/2244]  eta: 0:39:16  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1002  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 200/2244]  eta: 0:38:11  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1036  data: 0.0016  max mem: 22279
Train Epoch: [7]  [ 250/2244]  eta: 0:37:08  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 300/2244]  eta: 0:36:08  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 350/2244]  eta: 0:35:08  lr: 0.000715  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0957  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 400/2244]  eta: 0:34:11  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0017  max mem: 22279
Train Epoch: [7]  [ 450/2244]  eta: 0:33:14  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 500/2244]  eta: 0:32:17  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0992  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 550/2244]  eta: 0:31:20  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0913  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 600/2244]  eta: 0:30:26  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1101  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 650/2244]  eta: 0:29:29  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0988  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 700/2244]  eta: 0:28:33  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0966  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 750/2244]  eta: 0:27:37  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.1153  max mem: 22279
Train Epoch: [7]  [ 800/2244]  eta: 0:26:41  lr: 0.000715  loss_ita: 0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1008  data: 0.0016  max mem: 22279
Train Epoch: [7]  [ 850/2244]  eta: 0:25:45  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [7]  [ 900/2244]  eta: 0:24:49  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1000  data: 0.0016  max mem: 22279
Train Epoch: [7]  [ 950/2244]  eta: 0:23:54  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0997  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1000/2244]  eta: 0:22:58  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1097  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1050/2244]  eta: 0:22:02  lr: 0.000715  loss_ita: 0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1033  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1100/2244]  eta: 0:21:07  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0970  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1150/2244]  eta: 0:20:13  lr: 0.000715  loss_ita: 0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.2251  data: 0.0756  max mem: 22279
Train Epoch: [7]  [1200/2244]  eta: 0:19:18  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1488  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1250/2244]  eta: 0:18:22  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0997  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1300/2244]  eta: 0:17:27  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1052  data: 0.0016  max mem: 22279
Train Epoch: [7]  [1350/2244]  eta: 0:16:31  lr: 0.000715  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1400/2244]  eta: 0:15:36  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1141  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1450/2244]  eta: 0:14:40  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1500/2244]  eta: 0:13:45  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1116  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1550/2244]  eta: 0:12:49  lr: 0.000715  loss_ita: 0.0002  lr_temp_net: 0.00001435  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1112  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1600/2244]  eta: 0:11:54  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1650/2244]  eta: 0:10:58  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1700/2244]  eta: 0:10:03  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1750/2244]  eta: 0:09:07  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1115  data: 0.0016  max mem: 22279
Train Epoch: [7]  [1800/2244]  eta: 0:08:12  lr: 0.000715  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1026  data: 0.0016  max mem: 22279
Train Epoch: [7]  [1850/2244]  eta: 0:07:16  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1063  data: 0.0015  max mem: 22279
Train Epoch: [7]  [1900/2244]  eta: 0:06:21  lr: 0.000715  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0810  data: 0.0016  max mem: 22279
Train Epoch: [7]  [1950/2244]  eta: 0:05:25  lr: 0.000715  loss_ita: -0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0733  data: 0.0017  max mem: 22279
Train Epoch: [7]  [2000/2244]  eta: 0:04:30  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0992  data: 0.0015  max mem: 22279
Train Epoch: [7]  [2050/2244]  eta: 0:03:34  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1045  data: 0.0015  max mem: 22279
Train Epoch: [7]  [2100/2244]  eta: 0:02:39  lr: 0.000715  loss_ita: 0.0003  lr_temp_net: 0.00001435  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0015  max mem: 22279
Train Epoch: [7]  [2150/2244]  eta: 0:01:44  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1151  data: 0.0015  max mem: 22279
Train Epoch: [7]  [2200/2244]  eta: 0:00:48  lr: 0.000715  loss_ita: -0.0000  lr_temp_net: 0.00001435  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [7]  [2243/2244]  eta: 0:00:01  lr: 0.000715  loss_ita: 0.0001  lr_temp_net: 0.00001435  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1493  data: 0.0015  max mem: 22279
Train Epoch: [7] Total time: 0:41:24 (1.1074 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:33
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 22.78, 'txt_r5': 43.56, 'txt_r10': 54.26, 'txt_r_mean': 40.199999999999996, 'img_r1': 13.334666133546582, 'img_r5': 30.73970411835266, 'img_r10': 41.51139544182327, 'img_r_mean': 28.528588564574168, 'r_mean': 34.364294282287084}
coco test: {'txt_r1': 21.52, 'txt_r5': 43.86, 'txt_r10': 54.78, 'txt_r_mean': 40.053333333333335, 'img_r1': 13.130747700919633, 'img_r5': 31.17952818872451, 'img_r10': 41.39944022391044, 'img_r_mean': 28.56990537118486, 'r_mean': 34.3116193522591}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [8]  [   0/2244]  eta: 4:00:23  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 6.4277  data: 2.7030  max mem: 22279
Train Epoch: [8]  [  50/2244]  eta: 0:43:17  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1156  data: 0.0017  max mem: 22279
Train Epoch: [8]  [ 100/2244]  eta: 0:41:10  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 150/2244]  eta: 0:39:47  lr: 0.000691  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1156  data: 0.0182  max mem: 22279
Train Epoch: [8]  [ 200/2244]  eta: 0:38:39  lr: 0.000691  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1226  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 250/2244]  eta: 0:37:36  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1162  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 300/2244]  eta: 0:36:35  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1202  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 350/2244]  eta: 0:35:34  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1097  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 400/2244]  eta: 0:34:34  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1132  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 450/2244]  eta: 0:33:37  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1209  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 500/2244]  eta: 0:32:40  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1231  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 550/2244]  eta: 0:31:43  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 600/2244]  eta: 0:30:46  lr: 0.000691  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1236  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 650/2244]  eta: 0:29:52  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1203  data: 0.0709  max mem: 22279
Train Epoch: [8]  [ 700/2244]  eta: 0:28:55  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1167  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 750/2244]  eta: 0:27:58  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1128  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 800/2244]  eta: 0:27:01  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1274  data: 0.0015  max mem: 22279
Train Epoch: [8]  [ 850/2244]  eta: 0:26:04  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1126  data: 0.0016  max mem: 22279
Train Epoch: [8]  [ 900/2244]  eta: 0:25:09  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1652  data: 0.0018  max mem: 22279
Train Epoch: [8]  [ 950/2244]  eta: 0:24:13  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1112  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1000/2244]  eta: 0:23:16  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1111  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1050/2244]  eta: 0:22:20  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0074  max mem: 22279
Train Epoch: [8]  [1100/2244]  eta: 0:21:23  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1150/2244]  eta: 0:20:27  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0908  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1200/2244]  eta: 0:19:31  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1155  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1250/2244]  eta: 0:18:34  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1300/2244]  eta: 0:17:38  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1041  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1350/2244]  eta: 0:16:41  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1400/2244]  eta: 0:15:45  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1450/2244]  eta: 0:14:48  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0991  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1500/2244]  eta: 0:13:52  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1550/2244]  eta: 0:12:56  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1600/2244]  eta: 0:12:00  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1087  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1650/2244]  eta: 0:11:03  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0750  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1700/2244]  eta: 0:10:07  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0705  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1750/2244]  eta: 0:09:10  lr: 0.000691  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0678  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1800/2244]  eta: 0:08:14  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0914  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1850/2244]  eta: 0:07:18  lr: 0.000691  loss_ita: 0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1000  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1900/2244]  eta: 0:06:23  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1100  data: 0.0015  max mem: 22279
Train Epoch: [8]  [1950/2244]  eta: 0:05:27  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [8]  [2000/2244]  eta: 0:04:31  lr: 0.000691  loss_ita: -0.0001  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [8]  [2050/2244]  eta: 0:03:35  lr: 0.000691  loss_ita: 0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1042  data: 0.0015  max mem: 22279
Train Epoch: [8]  [2100/2244]  eta: 0:02:40  lr: 0.000691  loss_ita: 0.0002  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1085  data: 0.0015  max mem: 22279
Train Epoch: [8]  [2150/2244]  eta: 0:01:44  lr: 0.000691  loss_ita: 0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0015  max mem: 22279
Train Epoch: [8]  [2200/2244]  eta: 0:00:48  lr: 0.000691  loss_ita: -0.0000  lr_temp_net: 0.00001291  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0260  data: 0.0017  max mem: 22279
Train Epoch: [8]  [2243/2244]  eta: 0:00:01  lr: 0.000691  loss_ita: -0.0003  lr_temp_net: 0.00001291  loss_temp: 0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0015  max mem: 22279
Train Epoch: [8] Total time: 0:41:38 (1.1133 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 24.38, 'txt_r5': 46.92, 'txt_r10': 58.0, 'txt_r_mean': 43.1, 'img_r1': 14.134346261495402, 'img_r5': 32.76689324270292, 'img_r10': 43.61855257896841, 'img_r_mean': 30.173264027722244, 'r_mean': 36.636632013861124}
coco test: {'txt_r1': 23.62, 'txt_r5': 46.4, 'txt_r10': 57.76, 'txt_r_mean': 42.593333333333334, 'img_r1': 14.12235105957617, 'img_r5': 32.802878848460615, 'img_r10': 43.442622950819676, 'img_r_mean': 30.12261761961882, 'r_mean': 36.35797547647608}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [9]  [   0/2244]  eta: 2:39:03  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 4.2529  data: 2.9416  max mem: 22279
Train Epoch: [9]  [  50/2244]  eta: 0:42:02  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0814  data: 0.3179  max mem: 22279
Train Epoch: [9]  [ 100/2244]  eta: 0:39:49  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0793  data: 0.0258  max mem: 22279
Train Epoch: [9]  [ 150/2244]  eta: 0:38:24  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0744  data: 0.0140  max mem: 22279
Train Epoch: [9]  [ 200/2244]  eta: 0:37:20  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0802  data: 0.0016  max mem: 22279
Train Epoch: [9]  [ 250/2244]  eta: 0:36:16  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0718  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 300/2244]  eta: 0:35:18  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0921  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 350/2244]  eta: 0:34:21  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0765  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 400/2244]  eta: 0:33:33  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 450/2244]  eta: 0:32:41  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1009  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 500/2244]  eta: 0:31:48  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1008  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 550/2244]  eta: 0:30:55  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1020  data: 0.0016  max mem: 22279
Train Epoch: [9]  [ 600/2244]  eta: 0:30:02  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 650/2244]  eta: 0:29:08  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1075  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 700/2244]  eta: 0:28:14  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1011  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 750/2244]  eta: 0:27:20  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 800/2244]  eta: 0:26:26  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1034  data: 0.0016  max mem: 22279
Train Epoch: [9]  [ 850/2244]  eta: 0:25:34  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1206  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 900/2244]  eta: 0:24:39  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1046  data: 0.0015  max mem: 22279
Train Epoch: [9]  [ 950/2244]  eta: 0:23:45  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1156  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1000/2244]  eta: 0:22:50  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1050/2244]  eta: 0:21:55  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1024  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1100/2244]  eta: 0:21:00  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0218  max mem: 22279
Train Epoch: [9]  [1150/2244]  eta: 0:20:07  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1185  data: 0.0019  max mem: 22279
Train Epoch: [9]  [1200/2244]  eta: 0:19:13  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1207  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1250/2244]  eta: 0:18:18  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1203  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1300/2244]  eta: 0:17:23  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1084  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1350/2244]  eta: 0:16:28  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1223  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1400/2244]  eta: 0:15:33  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1192  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1450/2244]  eta: 0:14:38  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1251  data: 0.0016  max mem: 22279
Train Epoch: [9]  [1500/2244]  eta: 0:13:43  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1550/2244]  eta: 0:12:48  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1259  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1600/2244]  eta: 0:11:53  lr: 0.000664  loss_ita: -0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1650/2244]  eta: 0:10:58  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1700/2244]  eta: 0:10:02  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1175  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1750/2244]  eta: 0:09:07  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1179  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1800/2244]  eta: 0:08:12  lr: 0.000664  loss_ita: 0.0004  lr_temp_net: 0.00001162  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1189  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1850/2244]  eta: 0:07:16  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1088  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1900/2244]  eta: 0:06:21  lr: 0.000664  loss_ita: 0.0000  lr_temp_net: 0.00001162  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1192  data: 0.0015  max mem: 22279
Train Epoch: [9]  [1950/2244]  eta: 0:05:26  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1165  data: 0.0015  max mem: 22279
Train Epoch: [9]  [2000/2244]  eta: 0:04:30  lr: 0.000664  loss_ita: -0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1214  data: 0.0014  max mem: 22279
Train Epoch: [9]  [2050/2244]  eta: 0:03:35  lr: 0.000664  loss_ita: 0.0003  lr_temp_net: 0.00001162  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [9]  [2100/2244]  eta: 0:02:39  lr: 0.000664  loss_ita: -0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0815  data: 0.0015  max mem: 22279
Train Epoch: [9]  [2150/2244]  eta: 0:01:44  lr: 0.000664  loss_ita: 0.0001  lr_temp_net: 0.00001162  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0685  data: 0.0015  max mem: 22279
Train Epoch: [9]  [2200/2244]  eta: 0:00:48  lr: 0.000664  loss_ita: 0.0002  lr_temp_net: 0.00001162  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0696  data: 0.0015  max mem: 22279
Train Epoch: [9]  [2243/2244]  eta: 0:00:01  lr: 0.000664  loss_ita: -0.0004  lr_temp_net: 0.00001162  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1671  data: 0.0015  max mem: 22279
Train Epoch: [9] Total time: 0:41:24 (1.1073 s / it)
Averaged stats: lr: 0.0007  loss_ita: 0.0001  lr_temp_net: 0.0000  loss_temp: 0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:26
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 25.02, 'txt_r5': 47.74, 'txt_r10': 58.86, 'txt_r_mean': 43.873333333333335, 'img_r1': 14.762095161935227, 'img_r5': 33.96641343462615, 'img_r10': 44.98200719712115, 'img_r_mean': 31.236838597894177, 'r_mean': 37.555085965613756}
coco test: {'txt_r1': 24.48, 'txt_r5': 47.2, 'txt_r10': 58.94, 'txt_r_mean': 43.54, 'img_r1': 14.738104758096762, 'img_r5': 33.8984406237505, 'img_r10': 44.85405837664934, 'img_r_mean': 31.163534586165536, 'r_mean': 37.351767293082766}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [10]  [   0/2244]  eta: 2:24:20  lr: 0.000634  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.8595  data: 2.8627  max mem: 22279
Train Epoch: [10]  [  50/2244]  eta: 0:41:49  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0712  data: 0.3058  max mem: 22279
Train Epoch: [10]  [ 100/2244]  eta: 0:39:36  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0833  data: 0.2510  max mem: 22279
Train Epoch: [10]  [ 150/2244]  eta: 0:38:13  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0722  data: 0.0400  max mem: 22279
Train Epoch: [10]  [ 200/2244]  eta: 0:37:07  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0746  data: 0.0017  max mem: 22279
Train Epoch: [10]  [ 250/2244]  eta: 0:36:05  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0672  data: 0.0016  max mem: 22279
Train Epoch: [10]  [ 300/2244]  eta: 0:35:07  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0815  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 350/2244]  eta: 0:34:28  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1898  data: 0.1963  max mem: 22279
Train Epoch: [10]  [ 400/2244]  eta: 0:33:35  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0017  max mem: 22279
Train Epoch: [10]  [ 450/2244]  eta: 0:32:44  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1176  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 500/2244]  eta: 0:31:52  lr: 0.000634  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1072  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 550/2244]  eta: 0:30:59  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1136  data: 0.0016  max mem: 22279
Train Epoch: [10]  [ 600/2244]  eta: 0:30:09  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1725  data: 0.0582  max mem: 22279
Train Epoch: [10]  [ 650/2244]  eta: 0:29:12  lr: 0.000634  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0967  data: 0.0019  max mem: 22279
Train Epoch: [10]  [ 700/2244]  eta: 0:28:18  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1004  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 750/2244]  eta: 0:27:24  lr: 0.000634  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0014  max mem: 22279
Train Epoch: [10]  [ 800/2244]  eta: 0:26:31  lr: 0.000634  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1383  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 850/2244]  eta: 0:25:37  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1168  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 900/2244]  eta: 0:24:43  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [10]  [ 950/2244]  eta: 0:23:48  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1195  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1000/2244]  eta: 0:22:53  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1053  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1050/2244]  eta: 0:21:58  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1121  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1100/2244]  eta: 0:21:03  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1150/2244]  eta: 0:20:09  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0633  data: 0.0018  max mem: 22279
Train Epoch: [10]  [1200/2244]  eta: 0:19:14  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1137  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1250/2244]  eta: 0:18:19  lr: 0.000634  loss_ita: -0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1206  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1300/2244]  eta: 0:17:24  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1153  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1350/2244]  eta: 0:16:28  lr: 0.000634  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1175  data: 0.0016  max mem: 22279
Train Epoch: [10]  [1400/2244]  eta: 0:15:33  lr: 0.000634  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1047  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1450/2244]  eta: 0:14:38  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1132  data: 0.0016  max mem: 22279
Train Epoch: [10]  [1500/2244]  eta: 0:13:43  lr: 0.000634  loss_ita: -0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1180  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1550/2244]  eta: 0:12:48  lr: 0.000634  loss_ita: -0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1170  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1600/2244]  eta: 0:11:52  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1043  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1650/2244]  eta: 0:10:57  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1700/2244]  eta: 0:10:02  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1750/2244]  eta: 0:09:07  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1245  data: 0.0016  max mem: 22279
Train Epoch: [10]  [1800/2244]  eta: 0:08:11  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1087  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1850/2244]  eta: 0:07:16  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1900/2244]  eta: 0:06:21  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1183  data: 0.0015  max mem: 22279
Train Epoch: [10]  [1950/2244]  eta: 0:05:25  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2000/2244]  eta: 0:04:30  lr: 0.000634  loss_ita: 0.0000  lr_temp_net: 0.00001046  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2050/2244]  eta: 0:03:34  lr: 0.000634  loss_ita: 0.0002  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2100/2244]  eta: 0:02:39  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1164  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2150/2244]  eta: 0:01:44  lr: 0.000634  loss_ita: 0.0001  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2200/2244]  eta: 0:00:48  lr: 0.000634  loss_ita: 0.0003  lr_temp_net: 0.00001046  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1018  data: 0.0015  max mem: 22279
Train Epoch: [10]  [2243/2244]  eta: 0:00:01  lr: 0.000634  loss_ita: -0.0004  lr_temp_net: 0.00001046  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1763  data: 0.0015  max mem: 22279
Train Epoch: [10] Total time: 0:41:29 (1.1096 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 26.76, 'txt_r5': 50.42, 'txt_r10': 61.08, 'txt_r_mean': 46.086666666666666, 'img_r1': 15.597760895641743, 'img_r5': 35.16193522590964, 'img_r10': 46.289484206317475, 'img_r_mean': 32.349726775956285, 'r_mean': 39.21819672131147}
coco test: {'txt_r1': 25.62, 'txt_r5': 49.2, 'txt_r10': 61.04, 'txt_r_mean': 45.28666666666667, 'img_r1': 15.085965613754498, 'img_r5': 35.10595761695322, 'img_r10': 46.16153538584566, 'img_r_mean': 32.11781953885113, 'r_mean': 38.7022431027589}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [11]  [   0/2244]  eta: 2:32:29  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 4.0775  data: 2.8653  max mem: 22279
Train Epoch: [11]  [  50/2244]  eta: 0:42:09  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0775  data: 0.3386  max mem: 22279
Train Epoch: [11]  [ 100/2244]  eta: 0:40:10  lr: 0.000603  loss_ita: 0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0927  data: 0.1715  max mem: 22279
Train Epoch: [11]  [ 150/2244]  eta: 0:38:31  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0662  data: 0.1622  max mem: 22279
Train Epoch: [11]  [ 200/2244]  eta: 0:37:21  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0732  data: 0.0019  max mem: 22279
Train Epoch: [11]  [ 250/2244]  eta: 0:36:18  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0757  data: 0.1461  max mem: 22279
Train Epoch: [11]  [ 300/2244]  eta: 0:35:18  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0811  data: 0.2251  max mem: 22279
Train Epoch: [11]  [ 350/2244]  eta: 0:34:27  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0725  data: 0.0016  max mem: 22279
Train Epoch: [11]  [ 400/2244]  eta: 0:33:30  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0731  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 450/2244]  eta: 0:32:33  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0838  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 500/2244]  eta: 0:31:37  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0803  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 550/2244]  eta: 0:30:42  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1063  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 600/2244]  eta: 0:30:04  lr: 0.000603  loss_ita: -0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1149  data: 0.0710  max mem: 22279
Train Epoch: [11]  [ 650/2244]  eta: 0:29:11  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1088  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 700/2244]  eta: 0:28:17  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 750/2244]  eta: 0:27:23  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 800/2244]  eta: 0:26:29  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 850/2244]  eta: 0:25:34  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1041  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 900/2244]  eta: 0:24:40  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1148  data: 0.0015  max mem: 22279
Train Epoch: [11]  [ 950/2244]  eta: 0:23:46  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1000/2244]  eta: 0:22:52  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1050/2244]  eta: 0:21:57  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1202  data: 0.0016  max mem: 22279
Train Epoch: [11]  [1100/2244]  eta: 0:21:02  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1150/2244]  eta: 0:20:07  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0510  data: 0.0242  max mem: 22279
Train Epoch: [11]  [1200/2244]  eta: 0:19:13  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1250/2244]  eta: 0:18:18  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1300/2244]  eta: 0:17:23  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1350/2244]  eta: 0:16:28  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1174  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1400/2244]  eta: 0:15:33  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1149  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1450/2244]  eta: 0:14:38  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1500/2244]  eta: 0:13:43  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1230  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1550/2244]  eta: 0:12:48  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1600/2244]  eta: 0:11:52  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1143  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1650/2244]  eta: 0:10:57  lr: 0.000603  loss_ita: -0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1171  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1700/2244]  eta: 0:10:02  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1168  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1750/2244]  eta: 0:09:07  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1800/2244]  eta: 0:08:11  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1850/2244]  eta: 0:07:16  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [11]  [1900/2244]  eta: 0:06:21  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1150  data: 0.0016  max mem: 22279
Train Epoch: [11]  [1950/2244]  eta: 0:05:25  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1164  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2000/2244]  eta: 0:04:30  lr: 0.000603  loss_ita: -0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2050/2244]  eta: 0:03:34  lr: 0.000603  loss_ita: 0.0001  lr_temp_net: 0.00000941  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1187  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2100/2244]  eta: 0:02:39  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1132  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2150/2244]  eta: 0:01:44  lr: 0.000603  loss_ita: 0.0000  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2200/2244]  eta: 0:00:48  lr: 0.000603  loss_ita: 0.0002  lr_temp_net: 0.00000941  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [11]  [2243/2244]  eta: 0:00:01  lr: 0.000603  loss_ita: -0.0003  lr_temp_net: 0.00000941  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1332  data: 0.0015  max mem: 22279
Train Epoch: [11] Total time: 0:41:27 (1.1085 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 26.44, 'txt_r5': 50.38, 'txt_r10': 61.56, 'txt_r_mean': 46.126666666666665, 'img_r1': 15.609756097560975, 'img_r5': 35.29388244702119, 'img_r10': 46.87325069972011, 'img_r_mean': 32.592296414767425, 'r_mean': 39.35948154071704}
coco test: {'txt_r1': 25.98, 'txt_r5': 50.4, 'txt_r10': 61.72, 'txt_r_mean': 46.03333333333333, 'img_r1': 15.989604158336665, 'img_r5': 35.83766493402639, 'img_r10': 46.87325069972011, 'img_r_mean': 32.90017326402772, 'r_mean': 39.46675329868053}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [12]  [   0/2244]  eta: 3:45:27  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 6.0281  data: 3.3843  max mem: 22279
Train Epoch: [12]  [  50/2244]  eta: 0:42:24  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0861  data: 0.0667  max mem: 22279
Train Epoch: [12]  [ 100/2244]  eta: 0:40:32  lr: 0.000569  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 150/2244]  eta: 0:39:19  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1131  data: 0.0016  max mem: 22279
Train Epoch: [12]  [ 200/2244]  eta: 0:38:15  lr: 0.000569  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 250/2244]  eta: 0:37:13  lr: 0.000569  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 300/2244]  eta: 0:36:14  lr: 0.000569  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0962  data: 0.1570  max mem: 22279
Train Epoch: [12]  [ 350/2244]  eta: 0:35:16  lr: 0.000569  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1160  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 400/2244]  eta: 0:34:19  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1126  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 450/2244]  eta: 0:33:21  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 500/2244]  eta: 0:32:24  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 550/2244]  eta: 0:31:28  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 600/2244]  eta: 0:30:31  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1141  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 650/2244]  eta: 0:29:35  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 700/2244]  eta: 0:28:39  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 750/2244]  eta: 0:27:43  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 800/2244]  eta: 0:26:47  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 850/2244]  eta: 0:25:52  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1202  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 900/2244]  eta: 0:24:56  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [12]  [ 950/2244]  eta: 0:24:00  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1167  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1000/2244]  eta: 0:23:04  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0016  max mem: 22279
Train Epoch: [12]  [1050/2244]  eta: 0:22:08  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1100/2244]  eta: 0:21:12  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1032  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1150/2244]  eta: 0:20:19  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.3238  max mem: 22279
Train Epoch: [12]  [1200/2244]  eta: 0:19:23  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0821  data: 0.0017  max mem: 22279
Train Epoch: [12]  [1250/2244]  eta: 0:18:26  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0836  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1300/2244]  eta: 0:17:29  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0759  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1350/2244]  eta: 0:16:32  lr: 0.000569  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0769  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1400/2244]  eta: 0:15:36  lr: 0.000569  loss_ita: 0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0821  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1450/2244]  eta: 0:14:40  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0738  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1500/2244]  eta: 0:13:44  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0825  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1550/2244]  eta: 0:12:48  lr: 0.000569  loss_ita: -0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0808  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1600/2244]  eta: 0:11:52  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0894  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1650/2244]  eta: 0:10:57  lr: 0.000569  loss_ita: -0.0000  lr_temp_net: 0.00000847  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1700/2244]  eta: 0:10:01  lr: 0.000569  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1750/2244]  eta: 0:09:06  lr: 0.000569  loss_ita: 0.0002  lr_temp_net: 0.00000847  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1800/2244]  eta: 0:08:11  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1850/2244]  eta: 0:07:15  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [12]  [1900/2244]  eta: 0:06:20  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0016  max mem: 22279
Train Epoch: [12]  [1950/2244]  eta: 0:05:25  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1053  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2000/2244]  eta: 0:04:29  lr: 0.000569  loss_ita: -0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2050/2244]  eta: 0:03:34  lr: 0.000569  loss_ita: 0.0003  lr_temp_net: 0.00000847  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1225  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2100/2244]  eta: 0:02:39  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1115  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2150/2244]  eta: 0:01:44  lr: 0.000569  loss_ita: 0.0004  lr_temp_net: 0.00000847  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1055  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2200/2244]  eta: 0:00:48  lr: 0.000569  loss_ita: 0.0001  lr_temp_net: 0.00000847  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1004  data: 0.0015  max mem: 22279
Train Epoch: [12]  [2243/2244]  eta: 0:00:01  lr: 0.000569  loss_ita: -0.0006  lr_temp_net: 0.00000847  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0829  data: 0.0015  max mem: 22279
Train Epoch: [12] Total time: 0:41:24 (1.1070 s / it)
Averaged stats: lr: 0.0006  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:34
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 26.46, 'txt_r5': 50.18, 'txt_r10': 61.28, 'txt_r_mean': 45.973333333333336, 'img_r1': 15.757696921231508, 'img_r5': 35.65373850459816, 'img_r10': 46.9812075169932, 'img_r_mean': 32.79754764760762, 'r_mean': 39.38544049047048}
coco test: {'txt_r1': 25.22, 'txt_r5': 48.82, 'txt_r10': 59.9, 'txt_r_mean': 44.64666666666667, 'img_r1': 15.741703318672531, 'img_r5': 35.88564574170332, 'img_r10': 46.94522191123551, 'img_r_mean': 32.857523657203785, 'r_mean': 38.75209516193523}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [13]  [   0/2244]  eta: 4:29:19  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.2010  data: 5.7083  max mem: 22279
Train Epoch: [13]  [  50/2244]  eta: 0:43:41  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0775  data: 0.0746  max mem: 22279
Train Epoch: [13]  [ 100/2244]  eta: 0:41:33  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1587  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 150/2244]  eta: 0:39:45  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1024  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 200/2244]  eta: 0:38:33  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 250/2244]  eta: 0:37:28  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0085  max mem: 22279
Train Epoch: [13]  [ 300/2244]  eta: 0:36:26  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 350/2244]  eta: 0:35:25  lr: 0.000534  loss_ita: -0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 400/2244]  eta: 0:34:27  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1103  data: 0.0017  max mem: 22279
Train Epoch: [13]  [ 450/2244]  eta: 0:33:30  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1190  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 500/2244]  eta: 0:32:33  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1143  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 550/2244]  eta: 0:31:35  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 600/2244]  eta: 0:30:37  lr: 0.000534  loss_ita: -0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 650/2244]  eta: 0:29:40  lr: 0.000534  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1141  data: 0.0016  max mem: 22279
Train Epoch: [13]  [ 700/2244]  eta: 0:28:44  lr: 0.000534  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 750/2244]  eta: 0:27:47  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 800/2244]  eta: 0:26:51  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1160  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 850/2244]  eta: 0:25:55  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1130  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 900/2244]  eta: 0:24:59  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1130  data: 0.0015  max mem: 22279
Train Epoch: [13]  [ 950/2244]  eta: 0:24:03  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1150  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1000/2244]  eta: 0:23:07  lr: 0.000534  loss_ita: 0.0004  lr_temp_net: 0.00000763  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0016  max mem: 22279
Train Epoch: [13]  [1050/2244]  eta: 0:22:11  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1104  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1100/2244]  eta: 0:21:15  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1107  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1150/2244]  eta: 0:20:20  lr: 0.000534  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1139  data: 0.0018  max mem: 22279
Train Epoch: [13]  [1200/2244]  eta: 0:19:24  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1372  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1250/2244]  eta: 0:18:28  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1300/2244]  eta: 0:17:32  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1161  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1350/2244]  eta: 0:16:37  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1107  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1400/2244]  eta: 0:15:41  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1162  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1450/2244]  eta: 0:14:45  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.0017  max mem: 22279
Train Epoch: [13]  [1500/2244]  eta: 0:13:49  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1172  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1550/2244]  eta: 0:12:53  lr: 0.000534  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1201  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1600/2244]  eta: 0:11:57  lr: 0.000534  loss_ita: 0.0004  lr_temp_net: 0.00000763  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0759  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1650/2244]  eta: 0:11:01  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0747  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1700/2244]  eta: 0:10:04  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0753  data: 0.0017  max mem: 22279
Train Epoch: [13]  [1750/2244]  eta: 0:09:08  lr: 0.000534  loss_ita: 0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0834  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1800/2244]  eta: 0:08:12  lr: 0.000534  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0765  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1850/2244]  eta: 0:07:17  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0935  data: 0.0015  max mem: 22279
Train Epoch: [13]  [1900/2244]  eta: 0:06:21  lr: 0.000534  loss_ita: 0.0002  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0014  max mem: 22279
Train Epoch: [13]  [1950/2244]  eta: 0:05:26  lr: 0.000534  loss_ita: -0.0000  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0981  data: 0.0015  max mem: 22279
Train Epoch: [13]  [2000/2244]  eta: 0:04:30  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [13]  [2050/2244]  eta: 0:03:35  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0990  data: 0.0014  max mem: 22279
Train Epoch: [13]  [2100/2244]  eta: 0:02:39  lr: 0.000534  loss_ita: -0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1009  data: 0.0015  max mem: 22279
Train Epoch: [13]  [2150/2244]  eta: 0:01:44  lr: 0.000534  loss_ita: 0.0003  lr_temp_net: 0.00000763  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [13]  [2200/2244]  eta: 0:00:48  lr: 0.000534  loss_ita: 0.0001  lr_temp_net: 0.00000763  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0954  data: 0.0014  max mem: 22279
Train Epoch: [13]  [2243/2244]  eta: 0:00:01  lr: 0.000534  loss_ita: -0.0005  lr_temp_net: 0.00000763  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1673  data: 0.0014  max mem: 22279
Train Epoch: [13] Total time: 0:41:26 (1.1082 s / it)
Averaged stats: lr: 0.0005  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:26
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 28.12, 'txt_r5': 51.28, 'txt_r10': 62.88, 'txt_r_mean': 47.42666666666667, 'img_r1': 16.717313074770093, 'img_r5': 36.73730507796881, 'img_r10': 48.308676529388244, 'img_r_mean': 33.921098227375715, 'r_mean': 40.67388244702119}
coco test: {'txt_r1': 26.4, 'txt_r5': 50.98, 'txt_r10': 62.26, 'txt_r_mean': 46.54666666666666, 'img_r1': 16.573370651739303, 'img_r5': 36.70531787285086, 'img_r10': 47.820871651339466, 'img_r_mean': 33.699853391976546, 'r_mean': 40.1232600293216}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [14]  [   0/2244]  eta: 4:38:58  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.4593  data: 4.0303  max mem: 22279
Train Epoch: [14]  [  50/2244]  eta: 0:43:36  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1226  data: 0.0215  max mem: 22279
Train Epoch: [14]  [ 100/2244]  eta: 0:41:10  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 150/2244]  eta: 0:39:42  lr: 0.000498  loss_ita: -0.0003  lr_temp_net: 0.00000686  loss_temp: 0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 200/2244]  eta: 0:38:32  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1209  data: 0.0016  max mem: 22279
Train Epoch: [14]  [ 250/2244]  eta: 0:37:17  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0755  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 300/2244]  eta: 0:36:05  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0710  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 350/2244]  eta: 0:34:59  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0734  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 400/2244]  eta: 0:33:58  lr: 0.000498  loss_ita: -0.0004  lr_temp_net: 0.00000686  loss_temp: 0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0947  data: 0.0016  max mem: 22279
Train Epoch: [14]  [ 450/2244]  eta: 0:32:57  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0814  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 500/2244]  eta: 0:31:57  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0738  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 550/2244]  eta: 0:30:59  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0821  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 600/2244]  eta: 0:30:06  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1115  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 650/2244]  eta: 0:29:12  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1099  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 700/2244]  eta: 0:28:18  lr: 0.000498  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0992  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 750/2244]  eta: 0:27:23  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1046  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 800/2244]  eta: 0:26:29  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1107  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 850/2244]  eta: 0:25:34  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0015  max mem: 22279
Train Epoch: [14]  [ 900/2244]  eta: 0:24:41  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0051  data: 0.3046  max mem: 22279
Train Epoch: [14]  [ 950/2244]  eta: 0:23:46  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0017  max mem: 22279
Train Epoch: [14]  [1000/2244]  eta: 0:22:51  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1050/2244]  eta: 0:21:57  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1051  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1100/2244]  eta: 0:21:02  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1150/2244]  eta: 0:20:09  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1023  data: 0.0923  max mem: 22279
Train Epoch: [14]  [1200/2244]  eta: 0:19:14  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1172  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1250/2244]  eta: 0:18:19  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1300/2244]  eta: 0:17:24  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1061  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1350/2244]  eta: 0:16:29  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1400/2244]  eta: 0:15:34  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1450/2244]  eta: 0:14:38  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1115  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1500/2244]  eta: 0:13:43  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1078  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1550/2244]  eta: 0:12:48  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1136  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1600/2244]  eta: 0:11:53  lr: 0.000498  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1650/2244]  eta: 0:10:57  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1700/2244]  eta: 0:10:02  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1750/2244]  eta: 0:09:07  lr: 0.000498  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1157  data: 0.0016  max mem: 22279
Train Epoch: [14]  [1800/2244]  eta: 0:08:11  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0660  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1850/2244]  eta: 0:07:15  lr: 0.000498  loss_ita: -0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0648  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1900/2244]  eta: 0:06:20  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [14]  [1950/2244]  eta: 0:05:25  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2000/2244]  eta: 0:04:29  lr: 0.000498  loss_ita: 0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2050/2244]  eta: 0:03:34  lr: 0.000498  loss_ita: -0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2100/2244]  eta: 0:02:39  lr: 0.000498  loss_ita: -0.0002  lr_temp_net: 0.00000686  loss_temp: 0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1210  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2150/2244]  eta: 0:01:43  lr: 0.000498  loss_ita: 0.0000  lr_temp_net: 0.00000686  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1193  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2200/2244]  eta: 0:00:48  lr: 0.000498  loss_ita: 0.0001  lr_temp_net: 0.00000686  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [14]  [2243/2244]  eta: 0:00:01  lr: 0.000498  loss_ita: -0.0004  lr_temp_net: 0.00000686  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1340  data: 0.0015  max mem: 22279
Train Epoch: [14] Total time: 0:41:22 (1.1064 s / it)
Averaged stats: lr: 0.0005  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 28.6, 'txt_r5': 52.18, 'txt_r10': 62.78, 'txt_r_mean': 47.85333333333333, 'img_r1': 16.441423430627747, 'img_r5': 36.81727309076369, 'img_r10': 48.260695721711315, 'img_r_mean': 33.83979741436759, 'r_mean': 40.84656537385046}
coco test: {'txt_r1': 26.5, 'txt_r5': 51.78, 'txt_r10': 63.3, 'txt_r_mean': 47.19333333333333, 'img_r1': 16.45341863254698, 'img_r5': 37.04518192722911, 'img_r10': 48.51659336265494, 'img_r_mean': 34.00506464081034, 'r_mean': 40.59919898707183}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [15]  [   0/2244]  eta: 4:56:39  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.9321  data: 5.2677  max mem: 22279
Train Epoch: [15]  [  50/2244]  eta: 0:44:39  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1081  data: 0.0017  max mem: 22279
Train Epoch: [15]  [ 100/2244]  eta: 0:41:35  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1046  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 150/2244]  eta: 0:39:58  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 200/2244]  eta: 0:38:42  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 250/2244]  eta: 0:37:36  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1200  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 300/2244]  eta: 0:36:32  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1117  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 350/2244]  eta: 0:35:30  lr: 0.000461  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1086  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 400/2244]  eta: 0:34:32  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 450/2244]  eta: 0:33:32  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 500/2244]  eta: 0:32:33  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1097  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 550/2244]  eta: 0:31:35  lr: 0.000461  loss_ita: 0.0003  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1078  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 600/2244]  eta: 0:30:37  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 650/2244]  eta: 0:29:40  lr: 0.000461  loss_ita: 0.0003  lr_temp_net: 0.00000618  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 700/2244]  eta: 0:28:44  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1192  data: 0.0016  max mem: 22279
Train Epoch: [15]  [ 750/2244]  eta: 0:27:47  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 800/2244]  eta: 0:26:49  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0855  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 850/2244]  eta: 0:25:50  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0667  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 900/2244]  eta: 0:24:51  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0657  data: 0.0015  max mem: 22279
Train Epoch: [15]  [ 950/2244]  eta: 0:23:55  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1034  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1000/2244]  eta: 0:22:59  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1037  data: 0.0016  max mem: 22279
Train Epoch: [15]  [1050/2244]  eta: 0:22:04  lr: 0.000461  loss_ita: 0.0003  lr_temp_net: 0.00000618  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0019  max mem: 22279
Train Epoch: [15]  [1100/2244]  eta: 0:21:08  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1150/2244]  eta: 0:20:13  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0580  data: 0.0018  max mem: 22279
Train Epoch: [15]  [1200/2244]  eta: 0:19:17  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0016  max mem: 22279
Train Epoch: [15]  [1250/2244]  eta: 0:18:22  lr: 0.000461  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1042  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1300/2244]  eta: 0:17:26  lr: 0.000461  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1075  data: 0.0016  max mem: 22279
Train Epoch: [15]  [1350/2244]  eta: 0:16:30  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0999  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1400/2244]  eta: 0:15:35  lr: 0.000461  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1450/2244]  eta: 0:14:39  lr: 0.000461  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1008  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1500/2244]  eta: 0:13:44  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0894  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1550/2244]  eta: 0:12:48  lr: 0.000461  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1600/2244]  eta: 0:11:53  lr: 0.000461  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0993  data: 0.0016  max mem: 22279
Train Epoch: [15]  [1650/2244]  eta: 0:10:57  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1017  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1700/2244]  eta: 0:10:02  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0950  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1750/2244]  eta: 0:09:06  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1800/2244]  eta: 0:08:11  lr: 0.000461  loss_ita: -0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0971  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1850/2244]  eta: 0:07:16  lr: 0.000461  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0991  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1900/2244]  eta: 0:06:20  lr: 0.000461  loss_ita: 0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1182  data: 0.0015  max mem: 22279
Train Epoch: [15]  [1950/2244]  eta: 0:05:25  lr: 0.000461  loss_ita: -0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0998  data: 0.0015  max mem: 22279
Train Epoch: [15]  [2000/2244]  eta: 0:04:29  lr: 0.000461  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1051  data: 0.0015  max mem: 22279
Train Epoch: [15]  [2050/2244]  eta: 0:03:34  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0903  data: 0.0015  max mem: 22279
Train Epoch: [15]  [2100/2244]  eta: 0:02:39  lr: 0.000461  loss_ita: -0.0000  lr_temp_net: 0.00000618  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0757  data: 0.0016  max mem: 22279
Train Epoch: [15]  [2150/2244]  eta: 0:01:43  lr: 0.000461  loss_ita: 0.0002  lr_temp_net: 0.00000618  loss_temp: 0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0708  data: 0.0016  max mem: 22279
Train Epoch: [15]  [2200/2244]  eta: 0:00:48  lr: 0.000461  loss_ita: 0.0001  lr_temp_net: 0.00000618  loss_temp: 0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [15]  [2243/2244]  eta: 0:00:01  lr: 0.000461  loss_ita: -0.0003  lr_temp_net: 0.00000618  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1668  data: 0.0015  max mem: 22279
Train Epoch: [15] Total time: 0:41:21 (1.1058 s / it)
Averaged stats: lr: 0.0005  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 28.64, 'txt_r5': 52.3, 'txt_r10': 63.02, 'txt_r_mean': 47.98666666666667, 'img_r1': 16.82127149140344, 'img_r5': 37.4610155937625, 'img_r10': 48.88044782087165, 'img_r_mean': 34.38757830201253, 'r_mean': 41.187122484339596}
coco test: {'txt_r1': 26.4, 'txt_r5': 51.14, 'txt_r10': 62.76, 'txt_r_mean': 46.76666666666666, 'img_r1': 16.957217113154737, 'img_r5': 37.377049180327866, 'img_r10': 48.46061575369852, 'img_r_mean': 34.264960682393706, 'r_mean': 40.51581367453018}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [16]  [   0/2244]  eta: 2:12:05  lr: 0.000424  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.5317  data: 2.8737  max mem: 22279
Train Epoch: [16]  [  50/2244]  eta: 0:43:14  lr: 0.000424  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: 0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1190  data: 0.0017  max mem: 22279
Train Epoch: [16]  [ 100/2244]  eta: 0:40:57  lr: 0.000424  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0016  max mem: 22279
Train Epoch: [16]  [ 150/2244]  eta: 0:39:34  lr: 0.000424  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: 0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1061  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 200/2244]  eta: 0:38:27  lr: 0.000424  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 250/2244]  eta: 0:37:23  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1098  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 300/2244]  eta: 0:36:22  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0016  max mem: 22279
Train Epoch: [16]  [ 350/2244]  eta: 0:35:22  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 400/2244]  eta: 0:34:23  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: 0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 450/2244]  eta: 0:33:26  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1143  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 500/2244]  eta: 0:32:29  lr: 0.000424  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 550/2244]  eta: 0:31:32  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0014  max mem: 22279
Train Epoch: [16]  [ 600/2244]  eta: 0:30:35  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1112  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 650/2244]  eta: 0:29:38  lr: 0.000424  loss_ita: 0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 700/2244]  eta: 0:28:42  lr: 0.000424  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 750/2244]  eta: 0:27:46  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1101  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 800/2244]  eta: 0:26:49  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0001  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 850/2244]  eta: 0:25:53  lr: 0.000424  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [16]  [ 900/2244]  eta: 0:24:57  lr: 0.000424  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0003  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0016  max mem: 22279
Train Epoch: [16]  [ 950/2244]  eta: 0:24:07  lr: 0.000424  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0022  max mem: 22279
Train Epoch: [16]  [1000/2244]  eta: 0:23:11  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0000  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1050/2244]  eta: 0:22:14  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1100/2244]  eta: 0:21:18  lr: 0.000424  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1150/2244]  eta: 0:20:22  lr: 0.000424  loss_ita: -0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0921  data: 0.0019  max mem: 22279
Train Epoch: [16]  [1200/2244]  eta: 0:19:25  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0730  data: 0.0018  max mem: 22279
Train Epoch: [16]  [1250/2244]  eta: 0:18:28  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0987  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1300/2244]  eta: 0:17:32  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1019  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1350/2244]  eta: 0:16:36  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1162  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1400/2244]  eta: 0:15:40  lr: 0.000424  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1161  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1450/2244]  eta: 0:14:44  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1026  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1500/2244]  eta: 0:13:48  lr: 0.000424  loss_ita: -0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0004  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1550/2244]  eta: 0:12:52  lr: 0.000424  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1135  data: 0.0014  max mem: 22279
Train Epoch: [16]  [1600/2244]  eta: 0:11:57  lr: 0.000424  loss_ita: 0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1072  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1650/2244]  eta: 0:11:00  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0637  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1700/2244]  eta: 0:10:04  lr: 0.000424  loss_ita: 0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1118  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1750/2244]  eta: 0:09:09  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1800/2244]  eta: 0:08:13  lr: 0.000424  loss_ita: -0.0002  lr_temp_net: 0.00000556  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1072  data: 0.0016  max mem: 22279
Train Epoch: [16]  [1850/2244]  eta: 0:07:17  lr: 0.000424  loss_ita: 0.0003  lr_temp_net: 0.00000556  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1066  data: 0.0016  max mem: 22279
Train Epoch: [16]  [1900/2244]  eta: 0:06:22  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [16]  [1950/2244]  eta: 0:05:26  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0015  max mem: 22279
Train Epoch: [16]  [2000/2244]  eta: 0:04:31  lr: 0.000424  loss_ita: -0.0000  lr_temp_net: 0.00000556  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.0015  max mem: 22279
Train Epoch: [16]  [2050/2244]  eta: 0:03:35  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1168  data: 0.0015  max mem: 22279
Train Epoch: [16]  [2100/2244]  eta: 0:02:40  lr: 0.000424  loss_ita: -0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0016  max mem: 22279
Train Epoch: [16]  [2150/2244]  eta: 0:01:44  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0015  max mem: 22279
Train Epoch: [16]  [2200/2244]  eta: 0:00:48  lr: 0.000424  loss_ita: 0.0001  lr_temp_net: 0.00000556  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [16]  [2243/2244]  eta: 0:00:01  lr: 0.000424  loss_ita: -0.0004  lr_temp_net: 0.00000556  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1227  data: 0.0015  max mem: 22279
Train Epoch: [16] Total time: 0:41:34 (1.1116 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:26
Computing features for evaluation...
Evaluation time 0:00:26
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 29.34, 'txt_r5': 53.04, 'txt_r10': 63.96, 'txt_r_mean': 48.78, 'img_r1': 17.069172331067573, 'img_r5': 37.91283486605358, 'img_r10': 49.41223510595762, 'img_r_mean': 34.79808076769292, 'r_mean': 41.78904038384646}
coco test: {'txt_r1': 27.44, 'txt_r5': 51.66, 'txt_r10': 62.34, 'txt_r_mean': 47.14666666666667, 'img_r1': 17.08516593362655, 'img_r5': 37.65693722510996, 'img_r10': 49.24830067972811, 'img_r_mean': 34.663467946154874, 'r_mean': 40.90506730641077}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [17]  [   0/2244]  eta: 3:18:59  lr: 0.000386  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.3208  data: 3.5033  max mem: 22279
Train Epoch: [17]  [  50/2244]  eta: 0:42:44  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0006  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0920  data: 0.1646  max mem: 22279
Train Epoch: [17]  [ 100/2244]  eta: 0:40:31  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0002  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0983  data: 0.0017  max mem: 22279
Train Epoch: [17]  [ 150/2244]  eta: 0:39:13  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0005  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0982  data: 0.0014  max mem: 22279
Train Epoch: [17]  [ 200/2244]  eta: 0:38:09  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1026  data: 0.0016  max mem: 22279
Train Epoch: [17]  [ 250/2244]  eta: 0:37:09  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0007  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1239  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 300/2244]  eta: 0:36:08  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 350/2244]  eta: 0:35:07  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0008  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0973  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 400/2244]  eta: 0:34:09  lr: 0.000386  loss_ita: 0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1020  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 450/2244]  eta: 0:33:12  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1061  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 500/2244]  eta: 0:32:19  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1118  data: 0.0016  max mem: 22279
Train Epoch: [17]  [ 550/2244]  eta: 0:31:21  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 600/2244]  eta: 0:30:24  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1021  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 650/2244]  eta: 0:29:28  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 700/2244]  eta: 0:28:32  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0979  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 750/2244]  eta: 0:27:35  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1031  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 800/2244]  eta: 0:26:40  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 850/2244]  eta: 0:25:45  lr: 0.000386  loss_ita: -0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0011  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1400  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 900/2244]  eta: 0:24:49  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1008  data: 0.0015  max mem: 22279
Train Epoch: [17]  [ 950/2244]  eta: 0:23:54  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1033  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1000/2244]  eta: 0:22:58  lr: 0.000386  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1050/2244]  eta: 0:22:02  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1030  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1100/2244]  eta: 0:21:09  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0999  data: 0.0064  max mem: 22279
Train Epoch: [17]  [1150/2244]  eta: 0:20:15  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0896  data: 0.1183  max mem: 22279
Train Epoch: [17]  [1200/2244]  eta: 0:19:19  lr: 0.000386  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1047  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1250/2244]  eta: 0:18:23  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0720  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1300/2244]  eta: 0:17:28  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1350/2244]  eta: 0:16:32  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0010  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1061  data: 0.0016  max mem: 22279
Train Epoch: [17]  [1400/2244]  eta: 0:15:37  lr: 0.000386  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1066  data: 0.0016  max mem: 22279
Train Epoch: [17]  [1450/2244]  eta: 0:14:41  lr: 0.000386  loss_ita: -0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1013  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1500/2244]  eta: 0:13:45  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1550/2244]  eta: 0:12:50  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1117  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1600/2244]  eta: 0:11:54  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1021  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1650/2244]  eta: 0:10:59  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1104  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1700/2244]  eta: 0:10:03  lr: 0.000386  loss_ita: 0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1033  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1750/2244]  eta: 0:09:08  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1130  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1800/2244]  eta: 0:08:12  lr: 0.000386  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1850/2244]  eta: 0:07:17  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1103  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1900/2244]  eta: 0:06:21  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [17]  [1950/2244]  eta: 0:05:26  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [17]  [2000/2244]  eta: 0:04:30  lr: 0.000386  loss_ita: 0.0002  lr_temp_net: 0.00000500  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1029  data: 0.0015  max mem: 22279
Train Epoch: [17]  [2050/2244]  eta: 0:03:35  lr: 0.000386  loss_ita: -0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [17]  [2100/2244]  eta: 0:02:39  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0014  max mem: 22279
Train Epoch: [17]  [2150/2244]  eta: 0:01:44  lr: 0.000386  loss_ita: -0.0000  lr_temp_net: 0.00000500  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0014  max mem: 22279
Train Epoch: [17]  [2200/2244]  eta: 0:00:48  lr: 0.000386  loss_ita: 0.0001  lr_temp_net: 0.00000500  loss_temp: -0.0014  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1031  data: 0.0015  max mem: 22279
Train Epoch: [17]  [2243/2244]  eta: 0:00:01  lr: 0.000386  loss_ita: -0.0003  lr_temp_net: 0.00000500  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0712  data: 0.0015  max mem: 22279
Train Epoch: [17] Total time: 0:41:29 (1.1094 s / it)
Averaged stats: lr: 0.0004  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 29.6, 'txt_r5': 53.58, 'txt_r10': 64.96, 'txt_r_mean': 49.379999999999995, 'img_r1': 17.465013994402238, 'img_r5': 38.392642942822874, 'img_r10': 49.856057576969214, 'img_r_mean': 35.23790483806477, 'r_mean': 42.30895241903238}
coco test: {'txt_r1': 27.58, 'txt_r5': 52.4, 'txt_r10': 63.1, 'txt_r_mean': 47.69333333333333, 'img_r1': 17.23310675729708, 'img_r5': 38.11675329868053, 'img_r10': 49.55217912834866, 'img_r_mean': 34.967346394775426, 'r_mean': 41.33033986405438}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2Rank: 0, world size: 8, worker: 0, num_workers: 2

Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [18]  [   0/2244]  eta: 2:11:45  lr: 0.000349  loss_ita: -0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0013  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.5231  data: 2.8006  max mem: 22279
Train Epoch: [18]  [  50/2244]  eta: 0:42:55  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 100/2244]  eta: 0:40:39  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0009  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0998  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 150/2244]  eta: 0:39:02  lr: 0.000349  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0015  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0714  data: 0.0016  max mem: 22279
Train Epoch: [18]  [ 200/2244]  eta: 0:37:43  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0731  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 250/2244]  eta: 0:36:35  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0754  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 300/2244]  eta: 0:35:31  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0728  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 350/2244]  eta: 0:34:29  lr: 0.000349  loss_ita: 0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0719  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 400/2244]  eta: 0:33:35  lr: 0.000349  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0012  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 450/2244]  eta: 0:32:43  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1126  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 500/2244]  eta: 0:31:51  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0017  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1050  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 550/2244]  eta: 0:30:58  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0016  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1072  data: 0.0016  max mem: 22279
Train Epoch: [18]  [ 600/2244]  eta: 0:30:05  lr: 0.000349  loss_ita: -0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1075  data: 0.0016  max mem: 22279
Train Epoch: [18]  [ 650/2244]  eta: 0:29:11  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1064  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 700/2244]  eta: 0:28:17  lr: 0.000349  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0974  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 750/2244]  eta: 0:27:22  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1024  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 800/2244]  eta: 0:26:28  lr: 0.000349  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 850/2244]  eta: 0:25:34  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0020  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1133  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 900/2244]  eta: 0:24:39  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0999  data: 0.0015  max mem: 22279
Train Epoch: [18]  [ 950/2244]  eta: 0:23:45  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1377  data: 0.0067  max mem: 22279
Train Epoch: [18]  [1000/2244]  eta: 0:22:51  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0019  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1050/2244]  eta: 0:21:56  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1100/2244]  eta: 0:21:01  lr: 0.000349  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0018  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1150/2244]  eta: 0:20:07  lr: 0.000349  loss_ita: -0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1491  data: 0.0017  max mem: 22279
Train Epoch: [18]  [1200/2244]  eta: 0:19:11  lr: 0.000349  loss_ita: 0.0002  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1051  data: 0.0017  max mem: 22279
Train Epoch: [18]  [1250/2244]  eta: 0:18:16  lr: 0.000349  loss_ita: -0.0003  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1300/2244]  eta: 0:17:21  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1350/2244]  eta: 0:16:26  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0979  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1400/2244]  eta: 0:15:31  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1031  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1450/2244]  eta: 0:14:36  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1500/2244]  eta: 0:13:41  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1550/2244]  eta: 0:12:45  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0849  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1600/2244]  eta: 0:11:50  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0899  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1650/2244]  eta: 0:10:54  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0995  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1700/2244]  eta: 0:09:59  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1035  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1750/2244]  eta: 0:09:04  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0984  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1800/2244]  eta: 0:08:09  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1216  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1850/2244]  eta: 0:07:14  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0981  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1900/2244]  eta: 0:06:19  lr: 0.000349  loss_ita: -0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0015  max mem: 22279
Train Epoch: [18]  [1950/2244]  eta: 0:05:24  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2000/2244]  eta: 0:04:29  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0978  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2050/2244]  eta: 0:03:33  lr: 0.000349  loss_ita: 0.0001  lr_temp_net: 0.00000450  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0954  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2100/2244]  eta: 0:02:38  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0975  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2150/2244]  eta: 0:01:43  lr: 0.000349  loss_ita: 0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1016  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2200/2244]  eta: 0:00:48  lr: 0.000349  loss_ita: -0.0000  lr_temp_net: 0.00000450  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0962  data: 0.0015  max mem: 22279
Train Epoch: [18]  [2243/2244]  eta: 0:00:01  lr: 0.000349  loss_ita: -0.0006  lr_temp_net: 0.00000450  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1331  data: 0.0015  max mem: 22279
Train Epoch: [18] Total time: 0:41:13 (1.1024 s / it)
Averaged stats: lr: 0.0003  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0021  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:30
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 29.3, 'txt_r5': 54.02, 'txt_r10': 64.5, 'txt_r_mean': 49.27333333333333, 'img_r1': 17.41703318672531, 'img_r5': 38.24870051979208, 'img_r10': 49.51219512195122, 'img_r_mean': 35.05930960948954, 'r_mean': 42.166321471411436}
coco test: {'txt_r1': 27.64, 'txt_r5': 52.02, 'txt_r10': 63.3, 'txt_r_mean': 47.65333333333333, 'img_r1': 17.54498200719712, 'img_r5': 38.432626949220314, 'img_r10': 49.7640943622551, 'img_r_mean': 35.24723443955751, 'r_mean': 41.45028388644542}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [19]  [   0/2244]  eta: 2:09:50  lr: 0.000312  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.4718  data: 2.8630  max mem: 22279
Train Epoch: [19]  [  50/2244]  eta: 0:41:34  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0022  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0749  data: 0.1276  max mem: 22279
Train Epoch: [19]  [ 100/2244]  eta: 0:40:13  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1148  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 150/2244]  eta: 0:39:03  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 200/2244]  eta: 0:38:01  lr: 0.000312  loss_ita: -0.0003  lr_temp_net: 0.00000405  loss_temp: -0.0024  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1042  data: 0.0017  max mem: 22279
Train Epoch: [19]  [ 250/2244]  eta: 0:37:02  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 300/2244]  eta: 0:36:07  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1107  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 350/2244]  eta: 0:35:09  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1046  data: 0.0016  max mem: 22279
Train Epoch: [19]  [ 400/2244]  eta: 0:34:13  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1088  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 450/2244]  eta: 0:33:16  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0025  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1127  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 500/2244]  eta: 0:32:20  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1117  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 550/2244]  eta: 0:31:23  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1038  data: 0.0016  max mem: 22279
Train Epoch: [19]  [ 600/2244]  eta: 0:30:27  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0968  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 650/2244]  eta: 0:29:26  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0026  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0695  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 700/2244]  eta: 0:28:29  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 750/2244]  eta: 0:27:34  lr: 0.000312  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 800/2244]  eta: 0:26:39  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0023  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 850/2244]  eta: 0:25:44  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1172  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 900/2244]  eta: 0:24:49  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [19]  [ 950/2244]  eta: 0:23:54  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0016  max mem: 22279
Train Epoch: [19]  [1000/2244]  eta: 0:22:59  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1171  data: 0.0016  max mem: 22279
Train Epoch: [19]  [1050/2244]  eta: 0:22:03  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1155  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1100/2244]  eta: 0:21:08  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1074  data: 0.0019  max mem: 22279
Train Epoch: [19]  [1150/2244]  eta: 0:20:14  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1688  data: 0.0016  max mem: 22279
Train Epoch: [19]  [1200/2244]  eta: 0:19:19  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1193  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1250/2244]  eta: 0:18:23  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1300/2244]  eta: 0:17:28  lr: 0.000312  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0016  max mem: 22279
Train Epoch: [19]  [1350/2244]  eta: 0:16:32  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1400/2244]  eta: 0:15:37  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1149  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1450/2244]  eta: 0:14:42  lr: 0.000312  loss_ita: 0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1500/2244]  eta: 0:13:46  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1550/2244]  eta: 0:12:50  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1600/2244]  eta: 0:11:55  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1210  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1650/2244]  eta: 0:10:59  lr: 0.000312  loss_ita: -0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1700/2244]  eta: 0:10:04  lr: 0.000312  loss_ita: 0.0002  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1131  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1750/2244]  eta: 0:09:08  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1800/2244]  eta: 0:08:13  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0036  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1850/2244]  eta: 0:07:17  lr: 0.000312  loss_ita: -0.0000  lr_temp_net: 0.00000405  loss_temp: -0.0032  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1900/2244]  eta: 0:06:22  lr: 0.000312  loss_ita: -0.0003  lr_temp_net: 0.00000405  loss_temp: -0.0028  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1191  data: 0.0015  max mem: 22279
Train Epoch: [19]  [1950/2244]  eta: 0:05:26  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1221  data: 0.0015  max mem: 22279
Train Epoch: [19]  [2000/2244]  eta: 0:04:31  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1052  data: 0.0016  max mem: 22279
Train Epoch: [19]  [2050/2244]  eta: 0:03:35  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1045  data: 0.0015  max mem: 22279
Train Epoch: [19]  [2100/2244]  eta: 0:02:40  lr: 0.000312  loss_ita: 0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1165  data: 0.0016  max mem: 22279
Train Epoch: [19]  [2150/2244]  eta: 0:01:44  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1149  data: 0.0016  max mem: 22279
Train Epoch: [19]  [2200/2244]  eta: 0:00:48  lr: 0.000312  loss_ita: -0.0001  lr_temp_net: 0.00000405  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1088  data: 0.0016  max mem: 22279
Train Epoch: [19]  [2243/2244]  eta: 0:00:01  lr: 0.000312  loss_ita: -0.0009  lr_temp_net: 0.00000405  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [19] Total time: 0:41:33 (1.1111 s / it)
Averaged stats: lr: 0.0003  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 29.48, 'txt_r5': 53.46, 'txt_r10': 64.34, 'txt_r_mean': 49.093333333333334, 'img_r1': 18.01279488204718, 'img_r5': 38.63654538184726, 'img_r10': 50.0999600159936, 'img_r_mean': 35.58310009329602, 'r_mean': 42.33821671331468}
coco test: {'txt_r1': 27.74, 'txt_r5': 52.28, 'txt_r10': 63.46, 'txt_r_mean': 47.82666666666666, 'img_r1': 17.500999600159936, 'img_r5': 38.48460615753699, 'img_r10': 50.011995201919234, 'img_r_mean': 35.33253365320539, 'r_mean': 41.57960015993602}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [20]  [   0/2244]  eta: 2:09:21  lr: 0.000276  loss_ita: -0.0004  lr_temp_net: 0.00000365  loss_temp: -0.0030  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.4586  data: 2.9136  max mem: 22279
Train Epoch: [20]  [  50/2244]  eta: 0:41:58  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0759  data: 0.0280  max mem: 22279
Train Epoch: [20]  [ 100/2244]  eta: 0:40:15  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0027  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1124  data: 0.0014  max mem: 22279
Train Epoch: [20]  [ 150/2244]  eta: 0:39:16  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0031  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1131  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 200/2244]  eta: 0:38:13  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1116  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 250/2244]  eta: 0:37:14  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1161  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 300/2244]  eta: 0:36:15  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1131  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 350/2244]  eta: 0:35:16  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 400/2244]  eta: 0:34:18  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0016  max mem: 22279
Train Epoch: [20]  [ 450/2244]  eta: 0:33:21  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0029  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1046  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 500/2244]  eta: 0:32:23  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1051  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 550/2244]  eta: 0:31:28  lr: 0.000276  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0033  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 600/2244]  eta: 0:30:31  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1066  data: 0.0017  max mem: 22279
Train Epoch: [20]  [ 650/2244]  eta: 0:29:35  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 700/2244]  eta: 0:28:38  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1018  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 750/2244]  eta: 0:27:42  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1064  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 800/2244]  eta: 0:26:46  lr: 0.000276  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0035  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1078  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 850/2244]  eta: 0:25:51  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1151  data: 0.0015  max mem: 22279
Train Epoch: [20]  [ 900/2244]  eta: 0:24:54  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0837  data: 0.0019  max mem: 22279
Train Epoch: [20]  [ 950/2244]  eta: 0:23:58  lr: 0.000276  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1000/2244]  eta: 0:23:03  lr: 0.000276  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0034  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1050/2244]  eta: 0:22:07  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1177  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1100/2244]  eta: 0:21:11  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1044  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1150/2244]  eta: 0:20:16  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1196  data: 0.0018  max mem: 22279
Train Epoch: [20]  [1200/2244]  eta: 0:19:20  lr: 0.000276  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1250/2244]  eta: 0:18:24  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1231  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1300/2244]  eta: 0:17:29  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1121  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1350/2244]  eta: 0:16:33  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1400/2244]  eta: 0:15:38  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1414  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1450/2244]  eta: 0:14:42  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1084  data: 0.0016  max mem: 22279
Train Epoch: [20]  [1500/2244]  eta: 0:13:47  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1133  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1550/2244]  eta: 0:12:51  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1600/2244]  eta: 0:11:56  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1164  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1650/2244]  eta: 0:11:00  lr: 0.000276  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1700/2244]  eta: 0:10:04  lr: 0.000276  loss_ita: -0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0041  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1750/2244]  eta: 0:09:09  lr: 0.000276  loss_ita: -0.0003  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1800/2244]  eta: 0:08:13  lr: 0.000276  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1123  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1850/2244]  eta: 0:07:18  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1122  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1900/2244]  eta: 0:06:22  lr: 0.000276  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0015  max mem: 22279
Train Epoch: [20]  [1950/2244]  eta: 0:05:26  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1159  data: 0.0015  max mem: 22279
Train Epoch: [20]  [2000/2244]  eta: 0:04:31  lr: 0.000276  loss_ita: 0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1041  data: 0.0014  max mem: 22279
Train Epoch: [20]  [2050/2244]  eta: 0:03:35  lr: 0.000276  loss_ita: 0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1224  data: 0.0015  max mem: 22279
Train Epoch: [20]  [2100/2244]  eta: 0:02:40  lr: 0.000276  loss_ita: -0.0002  lr_temp_net: 0.00000365  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0016  max mem: 22279
Train Epoch: [20]  [2150/2244]  eta: 0:01:44  lr: 0.000276  loss_ita: -0.0000  lr_temp_net: 0.00000365  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1148  data: 0.0015  max mem: 22279
Train Epoch: [20]  [2200/2244]  eta: 0:00:48  lr: 0.000276  loss_ita: 0.0001  lr_temp_net: 0.00000365  loss_temp: -0.0037  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1077  data: 0.0015  max mem: 22279
Train Epoch: [20]  [2243/2244]  eta: 0:00:01  lr: 0.000276  loss_ita: -0.0006  lr_temp_net: 0.00000365  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0873  data: 0.0016  max mem: 22279
Train Epoch: [20] Total time: 0:41:37 (1.1131 s / it)
Averaged stats: lr: 0.0003  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:28
Computing features for evaluation...
Evaluation time 0:00:25
Computing features for evaluation...
Evaluation time 0:00:07
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 29.88, 'txt_r5': 53.4, 'txt_r10': 64.4, 'txt_r_mean': 49.22666666666667, 'img_r1': 17.832866853258697, 'img_r5': 39.18032786885246, 'img_r10': 50.72770891643343, 'img_r_mean': 35.91363454618153, 'r_mean': 42.57015060642409}
coco test: {'txt_r1': 27.7, 'txt_r5': 51.92, 'txt_r10': 63.56, 'txt_r_mean': 47.72666666666667, 'img_r1': 17.421031587365054, 'img_r5': 39.1843262694922, 'img_r10': 50.0719712115154, 'img_r_mean': 35.55910968945755, 'r_mean': 41.64288817806211}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [21]  [   0/2244]  eta: 2:08:34  lr: 0.000241  loss_ita: -0.0004  lr_temp_net: 0.00000328  loss_temp: -0.0040  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.4379  data: 2.8070  max mem: 22279
Train Epoch: [21]  [  50/2244]  eta: 0:42:30  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0038  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0764  data: 0.0016  max mem: 22279
Train Epoch: [21]  [ 100/2244]  eta: 0:40:08  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0042  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0772  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 150/2244]  eta: 0:38:34  lr: 0.000241  loss_ita: 0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0039  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0692  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 200/2244]  eta: 0:37:22  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0043  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0751  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 250/2244]  eta: 0:36:19  lr: 0.000241  loss_ita: 0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0044  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0881  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 300/2244]  eta: 0:35:29  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1081  data: 0.0016  max mem: 22279
Train Epoch: [21]  [ 350/2244]  eta: 0:34:38  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 400/2244]  eta: 0:33:45  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 450/2244]  eta: 0:32:52  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0046  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1106  data: 0.0016  max mem: 22279
Train Epoch: [21]  [ 500/2244]  eta: 0:31:59  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0017  max mem: 22279
Train Epoch: [21]  [ 550/2244]  eta: 0:31:05  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 600/2244]  eta: 0:30:12  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1111  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 650/2244]  eta: 0:29:18  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1130  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 700/2244]  eta: 0:28:24  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1173  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 750/2244]  eta: 0:27:30  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 800/2244]  eta: 0:26:35  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1137  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 850/2244]  eta: 0:25:40  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1147  data: 0.0015  max mem: 22279
Train Epoch: [21]  [ 900/2244]  eta: 0:24:45  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1103  data: 0.0014  max mem: 22279
Train Epoch: [21]  [ 950/2244]  eta: 0:23:50  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0045  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1124  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1000/2244]  eta: 0:22:57  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1519  data: 0.0033  max mem: 22279
Train Epoch: [21]  [1050/2244]  eta: 0:22:01  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1058  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1100/2244]  eta: 0:21:06  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1091  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1150/2244]  eta: 0:20:12  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1135  data: 0.0018  max mem: 22279
Train Epoch: [21]  [1200/2244]  eta: 0:19:17  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1188  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1250/2244]  eta: 0:18:21  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1300/2244]  eta: 0:17:26  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0048  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1350/2244]  eta: 0:16:32  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1495  data: 0.0014  max mem: 22279
Train Epoch: [21]  [1400/2244]  eta: 0:15:36  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1167  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1450/2244]  eta: 0:14:41  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1097  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1500/2244]  eta: 0:13:45  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0047  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1163  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1550/2244]  eta: 0:12:50  lr: 0.000241  loss_ita: 0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1600/2244]  eta: 0:11:54  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1650/2244]  eta: 0:10:59  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1700/2244]  eta: 0:10:03  lr: 0.000241  loss_ita: 0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1104  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1750/2244]  eta: 0:09:08  lr: 0.000241  loss_ita: -0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1128  data: 0.0016  max mem: 22279
Train Epoch: [21]  [1800/2244]  eta: 0:08:12  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1116  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1850/2244]  eta: 0:07:17  lr: 0.000241  loss_ita: 0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1196  data: 0.0016  max mem: 22279
Train Epoch: [21]  [1900/2244]  eta: 0:06:21  lr: 0.000241  loss_ita: 0.0002  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0015  max mem: 22279
Train Epoch: [21]  [1950/2244]  eta: 0:05:26  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [21]  [2000/2244]  eta: 0:04:30  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1087  data: 0.0015  max mem: 22279
Train Epoch: [21]  [2050/2244]  eta: 0:03:35  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0052  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0731  data: 0.0015  max mem: 22279
Train Epoch: [21]  [2100/2244]  eta: 0:02:39  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0686  data: 0.0015  max mem: 22279
Train Epoch: [21]  [2150/2244]  eta: 0:01:44  lr: 0.000241  loss_ita: -0.0001  lr_temp_net: 0.00000328  loss_temp: -0.0053  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0019  max mem: 22279
Train Epoch: [21]  [2200/2244]  eta: 0:00:48  lr: 0.000241  loss_ita: -0.0000  lr_temp_net: 0.00000328  loss_temp: -0.0049  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1108  data: 0.0016  max mem: 22279
Train Epoch: [21]  [2243/2244]  eta: 0:00:01  lr: 0.000241  loss_ita: -0.0006  lr_temp_net: 0.00000328  loss_temp: -0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0014  max mem: 22279
Train Epoch: [21] Total time: 0:41:28 (1.1091 s / it)
Averaged stats: lr: 0.0002  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:29
Computing features for evaluation...
Evaluation time 0:00:27
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:07
coco val: {'txt_r1': 28.82, 'txt_r5': 54.44, 'txt_r10': 65.12, 'txt_r_mean': 49.46, 'img_r1': 18.42862854858057, 'img_r5': 39.5921631347461, 'img_r10': 51.26749300279888, 'img_r_mean': 36.42942822870852, 'r_mean': 42.944714114354255}
coco test: {'txt_r1': 27.68, 'txt_r5': 53.12, 'txt_r10': 63.2, 'txt_r_mean': 48.0, 'img_r1': 17.59296281487405, 'img_r5': 39.18832467013195, 'img_r10': 50.61575369852059, 'img_r_mean': 35.7990137278422, 'r_mean': 41.899506863921104}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [22]  [   0/2244]  eta: 2:15:08  lr: 0.000208  loss_ita: -0.0003  lr_temp_net: 0.00000295  loss_temp: -0.0050  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.6134  data: 2.8452  max mem: 22279
Train Epoch: [22]  [  50/2244]  eta: 0:42:19  lr: 0.000208  loss_ita: 0.0003  lr_temp_net: 0.00000295  loss_temp: -0.0051  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.2736  max mem: 22279
Train Epoch: [22]  [ 100/2244]  eta: 0:39:51  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0729  data: 0.0018  max mem: 22279
Train Epoch: [22]  [ 150/2244]  eta: 0:38:40  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0055  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0981  data: 0.0016  max mem: 22279
Train Epoch: [22]  [ 200/2244]  eta: 0:37:44  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 250/2244]  eta: 0:36:47  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1076  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 300/2244]  eta: 0:35:50  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1023  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 350/2244]  eta: 0:34:56  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0054  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0016  max mem: 22279
Train Epoch: [22]  [ 400/2244]  eta: 0:34:01  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 450/2244]  eta: 0:33:06  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1099  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 500/2244]  eta: 0:32:12  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1089  data: 0.0123  max mem: 22279
Train Epoch: [22]  [ 550/2244]  eta: 0:31:17  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 600/2244]  eta: 0:30:23  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1195  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 650/2244]  eta: 0:29:28  lr: 0.000208  loss_ita: 0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1089  data: 0.0016  max mem: 22279
Train Epoch: [22]  [ 700/2244]  eta: 0:28:33  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 750/2244]  eta: 0:27:38  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0059  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 800/2244]  eta: 0:26:39  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0058  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0692  data: 0.0016  max mem: 22279
Train Epoch: [22]  [ 850/2244]  eta: 0:25:41  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0736  data: 0.0015  max mem: 22279
Train Epoch: [22]  [ 900/2244]  eta: 0:24:45  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0076  data: 0.2926  max mem: 22279
Train Epoch: [22]  [ 950/2244]  eta: 0:23:50  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0056  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0016  max mem: 22279
Train Epoch: [22]  [1000/2244]  eta: 0:22:55  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1075  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1050/2244]  eta: 0:22:00  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1070  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1100/2244]  eta: 0:21:05  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1054  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1150/2244]  eta: 0:20:11  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 0.9944  data: 0.0036  max mem: 22279
Train Epoch: [22]  [1200/2244]  eta: 0:19:16  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0017  max mem: 22279
Train Epoch: [22]  [1250/2244]  eta: 0:18:21  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1300/2244]  eta: 0:17:26  lr: 0.000208  loss_ita: -0.0002  lr_temp_net: 0.00000295  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1350/2244]  eta: 0:16:30  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1196  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1400/2244]  eta: 0:15:35  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1220  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1450/2244]  eta: 0:14:40  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1500/2244]  eta: 0:13:45  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1139  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1550/2244]  eta: 0:12:49  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1108  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1600/2244]  eta: 0:11:53  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1650/2244]  eta: 0:10:58  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0063  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1015  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1700/2244]  eta: 0:10:02  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0626  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1750/2244]  eta: 0:09:06  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1037  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1800/2244]  eta: 0:08:11  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1050  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1850/2244]  eta: 0:07:16  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1900/2244]  eta: 0:06:20  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0060  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1124  data: 0.0015  max mem: 22279
Train Epoch: [22]  [1950/2244]  eta: 0:05:25  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0729  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2000/2244]  eta: 0:04:29  lr: 0.000208  loss_ita: 0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0064  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0683  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2050/2244]  eta: 0:03:34  lr: 0.000208  loss_ita: -0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0769  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2100/2244]  eta: 0:02:39  lr: 0.000208  loss_ita: -0.0000  lr_temp_net: 0.00000295  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1155  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2150/2244]  eta: 0:01:43  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0057  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2200/2244]  eta: 0:00:48  lr: 0.000208  loss_ita: 0.0001  lr_temp_net: 0.00000295  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [22]  [2243/2244]  eta: 0:00:01  lr: 0.000208  loss_ita: -0.0007  lr_temp_net: 0.00000295  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0856  data: 0.0015  max mem: 22279
Train Epoch: [22] Total time: 0:41:20 (1.1053 s / it)
Averaged stats: lr: 0.0002  loss_ita: 0.0000  lr_temp_net: 0.0000  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:10
Computing features for evaluation...
Evaluation time 0:00:09
coco val: {'txt_r1': 28.88, 'txt_r5': 53.78, 'txt_r10': 64.6, 'txt_r_mean': 49.086666666666666, 'img_r1': 18.212714914034386, 'img_r5': 39.20831667333067, 'img_r10': 51.13154738104758, 'img_r_mean': 36.18419298947088, 'r_mean': 42.63542982806877}
coco test: {'txt_r1': 27.16, 'txt_r5': 51.88, 'txt_r10': 63.32, 'txt_r_mean': 47.45333333333334, 'img_r1': 17.8968412634946, 'img_r5': 39.02439024390244, 'img_r10': 50.37984806077569, 'img_r_mean': 35.767026522724244, 'r_mean': 41.61017992802879}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [23]  [   0/2244]  eta: 3:14:06  lr: 0.000176  loss_ita: -0.0004  lr_temp_net: 0.00000266  loss_temp: -0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.1900  data: 3.8535  max mem: 22279
Train Epoch: [23]  [  50/2244]  eta: 0:43:10  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1155  data: 0.0731  max mem: 22279
Train Epoch: [23]  [ 100/2244]  eta: 0:41:01  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1136  data: 0.0016  max mem: 22279
Train Epoch: [23]  [ 150/2244]  eta: 0:39:35  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0061  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0017  max mem: 22279
Train Epoch: [23]  [ 200/2244]  eta: 0:38:26  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0066  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1126  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 250/2244]  eta: 0:37:25  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1152  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 300/2244]  eta: 0:36:24  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1205  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 350/2244]  eta: 0:35:25  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1109  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 400/2244]  eta: 0:34:26  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1139  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 450/2244]  eta: 0:33:29  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0067  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1042  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 500/2244]  eta: 0:32:31  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0068  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 550/2244]  eta: 0:31:34  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0065  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1161  data: 0.0016  max mem: 22279
Train Epoch: [23]  [ 600/2244]  eta: 0:30:37  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1123  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 650/2244]  eta: 0:29:43  lr: 0.000176  loss_ita: 0.0003  lr_temp_net: 0.00000266  loss_temp: -0.0062  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1727  data: 0.0016  max mem: 22279
Train Epoch: [23]  [ 700/2244]  eta: 0:28:45  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1044  data: 0.0018  max mem: 22279
Train Epoch: [23]  [ 750/2244]  eta: 0:27:48  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1165  data: 0.0016  max mem: 22279
Train Epoch: [23]  [ 800/2244]  eta: 0:26:52  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1024  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 850/2244]  eta: 0:25:55  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0041  max mem: 22279
Train Epoch: [23]  [ 900/2244]  eta: 0:24:57  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0713  data: 0.0015  max mem: 22279
Train Epoch: [23]  [ 950/2244]  eta: 0:24:00  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0946  data: 0.0016  max mem: 22279
Train Epoch: [23]  [1000/2244]  eta: 0:23:04  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1085  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1050/2244]  eta: 0:22:08  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0014  max mem: 22279
Train Epoch: [23]  [1100/2244]  eta: 0:21:12  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0070  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0994  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1150/2244]  eta: 0:20:19  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1061  data: 0.0016  max mem: 22279
Train Epoch: [23]  [1200/2244]  eta: 0:19:23  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1096  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1250/2244]  eta: 0:18:27  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1300/2244]  eta: 0:17:31  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1019  data: 0.0014  max mem: 22279
Train Epoch: [23]  [1350/2244]  eta: 0:16:35  lr: 0.000176  loss_ita: 0.0003  lr_temp_net: 0.00000266  loss_temp: -0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1400/2244]  eta: 0:15:39  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1048  data: 0.0016  max mem: 22279
Train Epoch: [23]  [1450/2244]  eta: 0:14:43  lr: 0.000176  loss_ita: -0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1015  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1500/2244]  eta: 0:13:47  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0083  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1051  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1550/2244]  eta: 0:12:51  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1018  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1600/2244]  eta: 0:11:56  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1043  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1650/2244]  eta: 0:11:00  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0994  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1700/2244]  eta: 0:10:04  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1113  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1750/2244]  eta: 0:09:09  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1095  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1800/2244]  eta: 0:08:13  lr: 0.000176  loss_ita: -0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1056  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1850/2244]  eta: 0:07:17  lr: 0.000176  loss_ita: -0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0933  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1900/2244]  eta: 0:06:21  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0768  data: 0.0015  max mem: 22279
Train Epoch: [23]  [1950/2244]  eta: 0:05:26  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0777  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2000/2244]  eta: 0:04:30  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0775  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2050/2244]  eta: 0:03:34  lr: 0.000176  loss_ita: 0.0000  lr_temp_net: 0.00000266  loss_temp: -0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0761  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2100/2244]  eta: 0:02:39  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0763  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2150/2244]  eta: 0:01:44  lr: 0.000176  loss_ita: 0.0001  lr_temp_net: 0.00000266  loss_temp: -0.0069  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0850  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2200/2244]  eta: 0:00:48  lr: 0.000176  loss_ita: 0.0002  lr_temp_net: 0.00000266  loss_temp: -0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0752  data: 0.0015  max mem: 22279
Train Epoch: [23]  [2243/2244]  eta: 0:00:01  lr: 0.000176  loss_ita: -0.0005  lr_temp_net: 0.00000266  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1368  data: 0.0014  max mem: 22279
Train Epoch: [23] Total time: 0:41:22 (1.1061 s / it)
Averaged stats: lr: 0.0002  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0072  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:33
Computing features for evaluation...
Evaluation time 0:00:30
Computing features for evaluation...
Evaluation time 0:00:08
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 29.86, 'txt_r5': 54.4, 'txt_r10': 65.12, 'txt_r_mean': 49.79333333333333, 'img_r1': 18.252698920431826, 'img_r5': 40.02399040383847, 'img_r10': 51.27948820471811, 'img_r_mean': 36.51872584299613, 'r_mean': 43.15602958816473}
coco test: {'txt_r1': 27.9, 'txt_r5': 52.08, 'txt_r10': 64.12, 'txt_r_mean': 48.03333333333333, 'img_r1': 18.18872451019592, 'img_r5': 39.70011995201919, 'img_r10': 50.919632147141144, 'img_r_mean': 36.26949220311875, 'r_mean': 42.15141276822604}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [24]  [   0/2244]  eta: 2:17:34  lr: 0.000146  loss_ita: -0.0004  lr_temp_net: 0.00000239  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.6786  data: 2.8246  max mem: 22279
Train Epoch: [24]  [  50/2244]  eta: 0:42:44  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0076  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0974  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 100/2244]  eta: 0:40:38  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1105  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 150/2244]  eta: 0:39:15  lr: 0.000146  loss_ita: -0.0002  lr_temp_net: 0.00000239  loss_temp: -0.0071  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0938  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 200/2244]  eta: 0:38:08  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0075  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1025  data: 0.0016  max mem: 22279
Train Epoch: [24]  [ 250/2244]  eta: 0:37:09  lr: 0.000146  loss_ita: -0.0002  lr_temp_net: 0.00000239  loss_temp: -0.0074  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1215  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 300/2244]  eta: 0:36:11  lr: 0.000146  loss_ita: -0.0002  lr_temp_net: 0.00000239  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1120  data: 0.0016  max mem: 22279
Train Epoch: [24]  [ 350/2244]  eta: 0:35:13  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0073  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1053  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 400/2244]  eta: 0:34:17  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0077  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1164  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 450/2244]  eta: 0:33:20  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 500/2244]  eta: 0:32:23  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0078  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1104  data: 0.0016  max mem: 22279
Train Epoch: [24]  [ 550/2244]  eta: 0:31:27  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0079  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 600/2244]  eta: 0:30:46  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1080  data: 0.0018  max mem: 22279
Train Epoch: [24]  [ 650/2244]  eta: 0:29:49  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1174  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 700/2244]  eta: 0:28:51  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 750/2244]  eta: 0:27:54  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1090  data: 0.0014  max mem: 22279
Train Epoch: [24]  [ 800/2244]  eta: 0:26:58  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1405  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 850/2244]  eta: 0:26:02  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [24]  [ 900/2244]  eta: 0:25:05  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1020  data: 0.0049  max mem: 22279
Train Epoch: [24]  [ 950/2244]  eta: 0:24:08  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1188  data: 0.0016  max mem: 22279
Train Epoch: [24]  [1000/2244]  eta: 0:23:12  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1151  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1050/2244]  eta: 0:22:16  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1155  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1100/2244]  eta: 0:21:19  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0080  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1150/2244]  eta: 0:20:30  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1117  data: 0.0117  max mem: 22279
Train Epoch: [24]  [1200/2244]  eta: 0:19:33  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0949  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1250/2244]  eta: 0:18:36  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1062  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1300/2244]  eta: 0:17:42  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.2875  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1350/2244]  eta: 0:16:45  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1098  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1400/2244]  eta: 0:15:48  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1179  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1450/2244]  eta: 0:14:52  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1500/2244]  eta: 0:13:55  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0086  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1191  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1550/2244]  eta: 0:12:59  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1139  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1600/2244]  eta: 0:12:02  lr: 0.000146  loss_ita: -0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0081  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1075  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1650/2244]  eta: 0:11:06  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1084  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1700/2244]  eta: 0:10:10  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1750/2244]  eta: 0:09:13  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1209  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1800/2244]  eta: 0:08:17  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1850/2244]  eta: 0:07:21  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1205  data: 0.0015  max mem: 22279
Train Epoch: [24]  [1900/2244]  eta: 0:06:25  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1217  data: 0.0014  max mem: 22279
Train Epoch: [24]  [1950/2244]  eta: 0:05:29  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2000/2244]  eta: 0:04:33  lr: 0.000146  loss_ita: 0.0000  lr_temp_net: 0.00000239  loss_temp: -0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2050/2244]  eta: 0:03:37  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1130  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2100/2244]  eta: 0:02:41  lr: 0.000146  loss_ita: 0.0002  lr_temp_net: 0.00000239  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1320  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2150/2244]  eta: 0:01:45  lr: 0.000146  loss_ita: -0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0088  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1047  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2200/2244]  eta: 0:00:49  lr: 0.000146  loss_ita: 0.0001  lr_temp_net: 0.00000239  loss_temp: -0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [24]  [2243/2244]  eta: 0:00:01  lr: 0.000146  loss_ita: -0.0006  lr_temp_net: 0.00000239  loss_temp: -0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1640  data: 0.0015  max mem: 22279
Train Epoch: [24] Total time: 0:41:54 (1.1207 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0084  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:32
Computing features for evaluation...
Evaluation time 0:00:34
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:09
coco val: {'txt_r1': 29.3, 'txt_r5': 53.84, 'txt_r10': 64.86, 'txt_r_mean': 49.333333333333336, 'img_r1': 18.63254698120752, 'img_r5': 40.16393442622951, 'img_r10': 51.79928028788485, 'img_r_mean': 36.86525389844062, 'r_mean': 43.09929361588698}
coco test: {'txt_r1': 28.28, 'txt_r5': 52.2, 'txt_r10': 63.1, 'txt_r_mean': 47.86000000000001, 'img_r1': 18.19672131147541, 'img_r5': 39.58816473410636, 'img_r10': 50.96361455417833, 'img_r_mean': 36.24950019992003, 'r_mean': 42.05475009996002}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [25]  [   0/2244]  eta: 2:21:01  lr: 0.000119  loss_ita: -0.0005  lr_temp_net: 0.00000215  loss_temp: -0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 3.7709  data: 3.0840  max mem: 22279
Train Epoch: [25]  [  50/2244]  eta: 0:43:13  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0085  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1021  data: 0.0017  max mem: 22279
Train Epoch: [25]  [ 100/2244]  eta: 0:40:52  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0082  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 150/2244]  eta: 0:39:26  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0929  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 200/2244]  eta: 0:38:16  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0087  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1084  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 250/2244]  eta: 0:37:10  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1005  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 300/2244]  eta: 0:36:10  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1124  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 350/2244]  eta: 0:35:13  lr: 0.000119  loss_ita: -0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0089  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1137  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 400/2244]  eta: 0:34:16  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0091  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0291  data: 0.0018  max mem: 22279
Train Epoch: [25]  [ 450/2244]  eta: 0:33:20  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0090  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0016  max mem: 22279
Train Epoch: [25]  [ 500/2244]  eta: 0:32:23  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1080  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 550/2244]  eta: 0:31:42  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.3330  data: 0.2473  max mem: 22279
Train Epoch: [25]  [ 600/2244]  eta: 0:30:45  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1169  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 650/2244]  eta: 0:29:47  lr: 0.000119  loss_ita: 0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 700/2244]  eta: 0:28:50  lr: 0.000119  loss_ita: -0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 750/2244]  eta: 0:27:53  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0092  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 800/2244]  eta: 0:26:57  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1377  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 850/2244]  eta: 0:26:00  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 900/2244]  eta: 0:25:04  lr: 0.000119  loss_ita: 0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0098  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [25]  [ 950/2244]  eta: 0:24:07  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1159  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1000/2244]  eta: 0:23:11  lr: 0.000119  loss_ita: -0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1173  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1050/2244]  eta: 0:22:15  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1162  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1100/2244]  eta: 0:21:24  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1080  data: 0.2069  max mem: 22279
Train Epoch: [25]  [1150/2244]  eta: 0:20:28  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1555  data: 0.0140  max mem: 22279
Train Epoch: [25]  [1200/2244]  eta: 0:19:30  lr: 0.000119  loss_ita: -0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1116  data: 0.0016  max mem: 22279
Train Epoch: [25]  [1250/2244]  eta: 0:18:34  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1136  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1300/2244]  eta: 0:17:38  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1132  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1350/2244]  eta: 0:16:41  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1189  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1400/2244]  eta: 0:15:45  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1178  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1450/2244]  eta: 0:14:48  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0760  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1500/2244]  eta: 0:13:51  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0099  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0771  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1550/2244]  eta: 0:12:55  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0899  data: 0.0016  max mem: 22279
Train Epoch: [25]  [1600/2244]  eta: 0:11:59  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1064  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1650/2244]  eta: 0:11:03  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1016  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1700/2244]  eta: 0:10:07  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0016  max mem: 22279
Train Epoch: [25]  [1750/2244]  eta: 0:09:11  lr: 0.000119  loss_ita: 0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1019  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1800/2244]  eta: 0:08:15  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0105  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1010  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1850/2244]  eta: 0:07:19  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1002  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1900/2244]  eta: 0:06:23  lr: 0.000119  loss_ita: -0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1171  data: 0.0015  max mem: 22279
Train Epoch: [25]  [1950/2244]  eta: 0:05:27  lr: 0.000119  loss_ita: 0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2000/2244]  eta: 0:04:31  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1013  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2050/2244]  eta: 0:03:36  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0975  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2100/2244]  eta: 0:02:40  lr: 0.000119  loss_ita: 0.0001  lr_temp_net: 0.00000215  loss_temp: -0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1125  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2150/2244]  eta: 0:01:44  lr: 0.000119  loss_ita: 0.0002  lr_temp_net: 0.00000215  loss_temp: -0.0104  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1154  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2200/2244]  eta: 0:00:48  lr: 0.000119  loss_ita: -0.0000  lr_temp_net: 0.00000215  loss_temp: -0.0093  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0973  data: 0.0015  max mem: 22279
Train Epoch: [25]  [2243/2244]  eta: 0:00:01  lr: 0.000119  loss_ita: -0.0006  lr_temp_net: 0.00000215  loss_temp: -0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1254  data: 0.0015  max mem: 22279
Train Epoch: [25] Total time: 0:41:38 (1.1135 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:37
Computing features for evaluation...
Evaluation time 0:00:36
Computing features for evaluation...
Evaluation time 0:00:12
Computing features for evaluation...
Evaluation time 0:00:11
coco val: {'txt_r1': 28.32, 'txt_r5': 53.96, 'txt_r10': 64.92, 'txt_r_mean': 49.06666666666666, 'img_r1': 18.480607756897243, 'img_r5': 39.816073570571774, 'img_r10': 51.583366653338665, 'img_r_mean': 36.62668266026923, 'r_mean': 42.84667466346795}
coco test: {'txt_r1': 28.08, 'txt_r5': 52.6, 'txt_r10': 62.8, 'txt_r_mean': 47.826666666666675, 'img_r1': 18.0687724910036, 'img_r5': 39.58816473410636, 'img_r10': 50.667732906837266, 'img_r_mean': 36.10822337731574, 'r_mean': 41.96744502199121}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Rank: 0, world size: 8, worker: 0, num_workers: 2Rank: 0, world size: 8, worker: 1, num_workers: 2

Train Epoch: [26]  [   0/2244]  eta: 3:43:48  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0100  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 5.9842  data: 3.3912  max mem: 22279
Train Epoch: [26]  [  50/2244]  eta: 0:42:29  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0096  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0702  data: 0.0043  max mem: 22279
Train Epoch: [26]  [ 100/2244]  eta: 0:40:22  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0098  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0997  data: 0.0019  max mem: 22279
Train Epoch: [26]  [ 150/2244]  eta: 0:39:12  lr: 0.000095  loss_ita: 0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0094  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1042  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 200/2244]  eta: 0:38:12  lr: 0.000095  loss_ita: 0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0097  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 250/2244]  eta: 0:37:11  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1183  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 300/2244]  eta: 0:36:11  lr: 0.000095  loss_ita: 0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0095  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 350/2244]  eta: 0:35:14  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1119  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 400/2244]  eta: 0:34:16  lr: 0.000095  loss_ita: -0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1014  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 450/2244]  eta: 0:33:20  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0103  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1065  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 500/2244]  eta: 0:32:25  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1202  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 550/2244]  eta: 0:31:27  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0101  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1016  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 600/2244]  eta: 0:30:31  lr: 0.000095  loss_ita: -0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1248  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 650/2244]  eta: 0:29:35  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1117  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 700/2244]  eta: 0:28:39  lr: 0.000095  loss_ita: -0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1177  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 750/2244]  eta: 0:27:55  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.3989  data: 0.1037  max mem: 22279
Train Epoch: [26]  [ 800/2244]  eta: 0:26:58  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 850/2244]  eta: 0:26:00  lr: 0.000095  loss_ita: 0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1098  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 900/2244]  eta: 0:25:05  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1405  data: 0.0015  max mem: 22279
Train Epoch: [26]  [ 950/2244]  eta: 0:24:07  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0108  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1067  data: 0.0016  max mem: 22279
Train Epoch: [26]  [1000/2244]  eta: 0:23:12  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1306  data: 0.0016  max mem: 22279
Train Epoch: [26]  [1050/2244]  eta: 0:22:15  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0102  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1134  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1100/2244]  eta: 0:21:28  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1055  data: 0.1335  max mem: 22279
Train Epoch: [26]  [1150/2244]  eta: 0:20:31  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0017  max mem: 22279
Train Epoch: [26]  [1200/2244]  eta: 0:19:34  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1135  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1250/2244]  eta: 0:18:37  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1098  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1300/2244]  eta: 0:17:41  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0107  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1161  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1350/2244]  eta: 0:16:44  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1184  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1400/2244]  eta: 0:15:48  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0106  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1231  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1450/2244]  eta: 0:14:52  lr: 0.000095  loss_ita: 0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1556  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1500/2244]  eta: 0:13:55  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0121  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0780  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1550/2244]  eta: 0:12:58  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1600/2244]  eta: 0:12:02  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1159  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1650/2244]  eta: 0:11:06  lr: 0.000095  loss_ita: -0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1079  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1700/2244]  eta: 0:10:10  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1137  data: 0.0016  max mem: 22279
Train Epoch: [26]  [1750/2244]  eta: 0:09:13  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1800/2244]  eta: 0:08:17  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1131  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1850/2244]  eta: 0:07:21  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0116  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1199  data: 0.0015  max mem: 22279
Train Epoch: [26]  [1900/2244]  eta: 0:06:25  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0699  data: 0.0016  max mem: 22279
Train Epoch: [26]  [1950/2244]  eta: 0:05:28  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2000/2244]  eta: 0:04:32  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2050/2244]  eta: 0:03:36  lr: 0.000095  loss_ita: 0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0857  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2100/2244]  eta: 0:02:40  lr: 0.000095  loss_ita: -0.0001  lr_temp_net: 0.00000194  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0848  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2150/2244]  eta: 0:01:45  lr: 0.000095  loss_ita: -0.0000  lr_temp_net: 0.00000194  loss_temp: -0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2200/2244]  eta: 0:00:49  lr: 0.000095  loss_ita: 0.0002  lr_temp_net: 0.00000194  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0969  data: 0.0015  max mem: 22279
Train Epoch: [26]  [2243/2244]  eta: 0:00:01  lr: 0.000095  loss_ita: -0.0005  lr_temp_net: 0.00000194  loss_temp: -0.0133  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1467  data: 0.0114  max mem: 22279
Train Epoch: [26] Total time: 0:41:45 (1.1167 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:33
Computing features for evaluation...
Evaluation time 0:00:33
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:11
coco val: {'txt_r1': 28.98, 'txt_r5': 53.82, 'txt_r10': 64.48, 'txt_r_mean': 49.093333333333334, 'img_r1': 18.416633346661335, 'img_r5': 39.88404638144742, 'img_r10': 51.35545781687325, 'img_r_mean': 36.55204584832733, 'r_mean': 42.822689590830336}
coco test: {'txt_r1': 26.78, 'txt_r5': 51.82, 'txt_r10': 63.06, 'txt_r_mean': 47.22, 'img_r1': 18.328668532586967, 'img_r5': 39.42822870851659, 'img_r10': 50.5797680927629, 'img_r_mean': 36.11222177795548, 'r_mean': 41.66611088897774}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [27]  [   0/2244]  eta: 2:31:48  lr: 0.000073  loss_ita: -0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 4.0591  data: 3.1213  max mem: 22279
Train Epoch: [27]  [  50/2244]  eta: 0:43:30  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0113  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1144  data: 0.0016  max mem: 22279
Train Epoch: [27]  [ 100/2244]  eta: 0:40:35  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0110  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0729  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 150/2244]  eta: 0:38:53  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0111  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0686  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 200/2244]  eta: 0:37:35  lr: 0.000073  loss_ita: -0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0109  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0757  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 250/2244]  eta: 0:36:36  lr: 0.000073  loss_ita: 0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0117  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 300/2244]  eta: 0:35:48  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1509  data: 0.0512  max mem: 22279
Train Epoch: [27]  [ 350/2244]  eta: 0:34:46  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0898  data: 0.0018  max mem: 22279
Train Epoch: [27]  [ 400/2244]  eta: 0:33:52  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0115  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1171  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 450/2244]  eta: 0:33:00  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1078  data: 0.0017  max mem: 22279
Train Epoch: [27]  [ 500/2244]  eta: 0:32:05  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0114  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1073  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 550/2244]  eta: 0:31:10  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0112  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1001  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 600/2244]  eta: 0:30:14  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0121  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1049  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 650/2244]  eta: 0:29:18  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0970  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 700/2244]  eta: 0:28:25  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1622  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 750/2244]  eta: 0:27:29  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1162  data: 0.0018  max mem: 22279
Train Epoch: [27]  [ 800/2244]  eta: 0:26:33  lr: 0.000073  loss_ita: 0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0979  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 850/2244]  eta: 0:25:39  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1146  data: 0.0015  max mem: 22279
Train Epoch: [27]  [ 900/2244]  eta: 0:24:43  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0952  data: 0.0016  max mem: 22279
Train Epoch: [27]  [ 950/2244]  eta: 0:23:50  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1000/2244]  eta: 0:22:55  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1050/2244]  eta: 0:21:59  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0964  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1100/2244]  eta: 0:21:10  lr: 0.000073  loss_ita: 0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0119  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.2559  data: 0.1537  max mem: 22279
Train Epoch: [27]  [1150/2244]  eta: 0:20:14  lr: 0.000073  loss_ita: -0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0120  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1133  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1200/2244]  eta: 0:19:18  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1218  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1250/2244]  eta: 0:18:23  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1045  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1300/2244]  eta: 0:17:27  lr: 0.000073  loss_ita: 0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1104  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1350/2244]  eta: 0:16:32  lr: 0.000073  loss_ita: 0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0118  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1138  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1400/2244]  eta: 0:15:36  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0124  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1160  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1450/2244]  eta: 0:14:41  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0992  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1500/2244]  eta: 0:13:45  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1566  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1550/2244]  eta: 0:12:49  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0125  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0945  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1600/2244]  eta: 0:11:54  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1650/2244]  eta: 0:10:58  lr: 0.000073  loss_ita: -0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0125  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1099  data: 0.0016  max mem: 22279
Train Epoch: [27]  [1700/2244]  eta: 0:10:03  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0125  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1068  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1750/2244]  eta: 0:09:07  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0131  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1069  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1800/2244]  eta: 0:08:12  lr: 0.000073  loss_ita: -0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1023  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1850/2244]  eta: 0:07:16  lr: 0.000073  loss_ita: 0.0002  lr_temp_net: 0.00000174  loss_temp: -0.0121  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1109  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1900/2244]  eta: 0:06:21  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0130  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1108  data: 0.0015  max mem: 22279
Train Epoch: [27]  [1950/2244]  eta: 0:05:26  lr: 0.000073  loss_ita: 0.0000  lr_temp_net: 0.00000174  loss_temp: -0.0132  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1092  data: 0.0015  max mem: 22279
Train Epoch: [27]  [2000/2244]  eta: 0:04:30  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0134  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1022  data: 0.0014  max mem: 22279
Train Epoch: [27]  [2050/2244]  eta: 0:03:35  lr: 0.000073  loss_ita: -0.0003  lr_temp_net: 0.00000174  loss_temp: -0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1171  data: 0.1464  max mem: 22279
Train Epoch: [27]  [2100/2244]  eta: 0:02:39  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0133  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1246  data: 0.0015  max mem: 22279
Train Epoch: [27]  [2150/2244]  eta: 0:01:44  lr: 0.000073  loss_ita: -0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0130  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1011  data: 0.0015  max mem: 22279
Train Epoch: [27]  [2200/2244]  eta: 0:00:48  lr: 0.000073  loss_ita: 0.0001  lr_temp_net: 0.00000174  loss_temp: -0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [27]  [2243/2244]  eta: 0:00:01  lr: 0.000073  loss_ita: -0.0006  lr_temp_net: 0.00000174  loss_temp: -0.0147  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0692  data: 0.0014  max mem: 22279
Train Epoch: [27] Total time: 0:41:30 (1.1096 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0000  lr_temp_net: 0.0000  loss_temp: -0.0123  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:39
Computing features for evaluation...
Evaluation time 0:00:37
Computing features for evaluation...
Evaluation time 0:00:12
Computing features for evaluation...
Evaluation time 0:00:10
coco val: {'txt_r1': 29.5, 'txt_r5': 53.98, 'txt_r10': 64.5, 'txt_r_mean': 49.32666666666666, 'img_r1': 18.59656137544982, 'img_r5': 39.9280287884846, 'img_r10': 51.49140343862455, 'img_r_mean': 36.67199786751966, 'r_mean': 42.99933226709316}
coco test: {'txt_r1': 27.2, 'txt_r5': 51.68, 'txt_r10': 63.0, 'txt_r_mean': 47.29333333333333, 'img_r1': 18.24470211915234, 'img_r5': 39.50419832067173, 'img_r10': 50.69172331067573, 'img_r_mean': 36.14687458349993, 'r_mean': 41.72010395841663}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [28]  [   0/2244]  eta: 4:34:25  lr: 0.000054  loss_ita: -0.0006  lr_temp_net: 0.00000157  loss_temp: -0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 7.3375  data: 3.2442  max mem: 22279
Train Epoch: [28]  [  50/2244]  eta: 0:43:30  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0122  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0680  data: 0.0017  max mem: 22279
Train Epoch: [28]  [ 100/2244]  eta: 0:41:07  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1063  data: 0.0178  max mem: 22279
Train Epoch: [28]  [ 150/2244]  eta: 0:39:38  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0122  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 200/2244]  eta: 0:38:26  lr: 0.000054  loss_ita: -0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0122  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1112  data: 0.0016  max mem: 22279
Train Epoch: [28]  [ 250/2244]  eta: 0:37:21  lr: 0.000054  loss_ita: -0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0130  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0689  data: 0.0018  max mem: 22279
Train Epoch: [28]  [ 300/2244]  eta: 0:36:19  lr: 0.000054  loss_ita: 0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0131  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1027  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 350/2244]  eta: 0:35:18  lr: 0.000054  loss_ita: -0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1040  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 400/2244]  eta: 0:34:18  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0126  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1032  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 450/2244]  eta: 0:33:19  lr: 0.000054  loss_ita: -0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0129  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1057  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 500/2244]  eta: 0:32:22  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0125  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1031  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 550/2244]  eta: 0:31:24  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0128  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 600/2244]  eta: 0:30:28  lr: 0.000054  loss_ita: 0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0137  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1044  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 650/2244]  eta: 0:29:31  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0141  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1021  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 700/2244]  eta: 0:28:35  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0127  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1004  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 750/2244]  eta: 0:27:39  lr: 0.000054  loss_ita: 0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0134  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1004  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 800/2244]  eta: 0:26:42  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0133  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1023  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 850/2244]  eta: 0:25:51  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0132  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.2392  data: 0.0015  max mem: 22279
Train Epoch: [28]  [ 900/2244]  eta: 0:24:52  lr: 0.000054  loss_ita: -0.0004  lr_temp_net: 0.00000157  loss_temp: -0.0135  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1045  data: 0.0018  max mem: 22279
Train Epoch: [28]  [ 950/2244]  eta: 0:23:56  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0144  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1108  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1000/2244]  eta: 0:23:01  lr: 0.000054  loss_ita: 0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0137  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.0920  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1050/2244]  eta: 0:22:05  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0136  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1083  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1100/2244]  eta: 0:21:10  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0133  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1327  data: 0.0631  max mem: 22279
Train Epoch: [28]  [1150/2244]  eta: 0:20:15  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1191  data: 0.0017  max mem: 22279
Train Epoch: [28]  [1200/2244]  eta: 0:19:20  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1132  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1250/2244]  eta: 0:18:24  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0140  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1145  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1300/2244]  eta: 0:17:29  lr: 0.000054  loss_ita: 0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0136  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1077  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1350/2244]  eta: 0:16:33  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0143  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1034  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1400/2244]  eta: 0:15:37  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1184  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1450/2244]  eta: 0:14:42  lr: 0.000054  loss_ita: 0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0142  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1081  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1500/2244]  eta: 0:13:46  lr: 0.000054  loss_ita: 0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0144  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1200  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1550/2244]  eta: 0:12:51  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0138  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1218  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1600/2244]  eta: 0:11:56  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0147  avg_image_tau: 0.0010  avg_text_tau: 0.0010  time: 1.1123  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1650/2244]  eta: 0:11:00  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0140  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1080  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1700/2244]  eta: 0:10:04  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0143  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1164  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1750/2244]  eta: 0:09:09  lr: 0.000054  loss_ita: -0.0000  lr_temp_net: 0.00000157  loss_temp: -0.0141  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1260  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1800/2244]  eta: 0:08:13  lr: 0.000054  loss_ita: -0.0002  lr_temp_net: 0.00000157  loss_temp: -0.0147  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1078  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1850/2244]  eta: 0:07:18  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0148  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1198  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1900/2244]  eta: 0:06:22  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1148  data: 0.0015  max mem: 22279
Train Epoch: [28]  [1950/2244]  eta: 0:05:27  lr: 0.000054  loss_ita: -0.0004  lr_temp_net: 0.00000157  loss_temp: -0.0145  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1180  data: 0.0015  max mem: 22279
Train Epoch: [28]  [2000/2244]  eta: 0:04:31  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0152  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1116  data: 0.0015  max mem: 22279
Train Epoch: [28]  [2050/2244]  eta: 0:03:35  lr: 0.000054  loss_ita: -0.0005  lr_temp_net: 0.00000157  loss_temp: -0.0143  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1175  data: 0.0015  max mem: 22279
Train Epoch: [28]  [2100/2244]  eta: 0:02:40  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0147  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1191  data: 0.0015  max mem: 22279
Train Epoch: [28]  [2150/2244]  eta: 0:01:44  lr: 0.000054  loss_ita: -0.0003  lr_temp_net: 0.00000157  loss_temp: -0.0153  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1165  data: 0.0016  max mem: 22279
Train Epoch: [28]  [2200/2244]  eta: 0:00:48  lr: 0.000054  loss_ita: -0.0001  lr_temp_net: 0.00000157  loss_temp: -0.0139  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1129  data: 0.0015  max mem: 22279
Train Epoch: [28]  [2243/2244]  eta: 0:00:01  lr: 0.000054  loss_ita: -0.0008  lr_temp_net: 0.00000157  loss_temp: -0.0174  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.3803  data: 0.0015  max mem: 22279
Train Epoch: [28] Total time: 0:41:42 (1.1151 s / it)
Averaged stats: lr: 0.0001  loss_ita: -0.0001  lr_temp_net: 0.0000  loss_temp: -0.0138  avg_image_tau: 0.0010  avg_text_tau: 0.0010
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 29.84, 'txt_r5': 53.36, 'txt_r10': 64.32, 'txt_r_mean': 49.173333333333325, 'img_r1': 18.44862055177929, 'img_r5': 39.84406237504998, 'img_r10': 51.43942423030788, 'img_r_mean': 36.57736905237905, 'r_mean': 42.875351192856186}
coco test: {'txt_r1': 27.34, 'txt_r5': 51.5, 'txt_r10': 62.82, 'txt_r_mean': 47.22, 'img_r1': 18.28468612554978, 'img_r5': 39.38024790083966, 'img_r10': 50.627748900439826, 'img_r_mean': 36.09756097560976, 'r_mean': 41.658780487804876}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [29]  [   0/2244]  eta: 3:11:10  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0150  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 5.1115  data: 3.4687  max mem: 22279
Train Epoch: [29]  [  50/2244]  eta: 0:43:56  lr: 0.000038  loss_ita: -0.0001  lr_temp_net: 0.00000141  loss_temp: -0.0142  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1687  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 100/2244]  eta: 0:41:22  lr: 0.000038  loss_ita: -0.0003  lr_temp_net: 0.00000141  loss_temp: -0.0146  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1140  data: 0.0016  max mem: 22279
Train Epoch: [29]  [ 150/2244]  eta: 0:39:54  lr: 0.000038  loss_ita: -0.0003  lr_temp_net: 0.00000141  loss_temp: -0.0143  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1090  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 200/2244]  eta: 0:38:41  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0138  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1172  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 250/2244]  eta: 0:37:36  lr: 0.000038  loss_ita: -0.0003  lr_temp_net: 0.00000141  loss_temp: -0.0150  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 300/2244]  eta: 0:36:35  lr: 0.000038  loss_ita: -0.0002  lr_temp_net: 0.00000141  loss_temp: -0.0154  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 350/2244]  eta: 0:35:35  lr: 0.000038  loss_ita: -0.0004  lr_temp_net: 0.00000141  loss_temp: -0.0150  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1101  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 400/2244]  eta: 0:34:35  lr: 0.000038  loss_ita: -0.0004  lr_temp_net: 0.00000141  loss_temp: -0.0150  avg_image_tau: 0.0010  avg_text_tau: 0.0011  time: 1.1140  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 450/2244]  eta: 0:33:37  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0155  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1180  data: 0.0016  max mem: 22279
Train Epoch: [29]  [ 500/2244]  eta: 0:32:39  lr: 0.000038  loss_ita: -0.0004  lr_temp_net: 0.00000141  loss_temp: -0.0151  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1115  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 550/2244]  eta: 0:31:41  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0158  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1149  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 600/2244]  eta: 0:30:44  lr: 0.000038  loss_ita: -0.0003  lr_temp_net: 0.00000141  loss_temp: -0.0155  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1241  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 650/2244]  eta: 0:29:47  lr: 0.000038  loss_ita: -0.0003  lr_temp_net: 0.00000141  loss_temp: -0.0158  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 700/2244]  eta: 0:28:50  lr: 0.000038  loss_ita: -0.0004  lr_temp_net: 0.00000141  loss_temp: -0.0163  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 750/2244]  eta: 0:27:53  lr: 0.000038  loss_ita: -0.0004  lr_temp_net: 0.00000141  loss_temp: -0.0158  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1157  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 800/2244]  eta: 0:26:56  lr: 0.000038  loss_ita: -0.0008  lr_temp_net: 0.00000141  loss_temp: -0.0166  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 850/2244]  eta: 0:26:00  lr: 0.000038  loss_ita: -0.0007  lr_temp_net: 0.00000141  loss_temp: -0.0161  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1265  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 900/2244]  eta: 0:25:05  lr: 0.000038  loss_ita: -0.0008  lr_temp_net: 0.00000141  loss_temp: -0.0167  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1267  data: 0.0015  max mem: 22279
Train Epoch: [29]  [ 950/2244]  eta: 0:24:08  lr: 0.000038  loss_ita: -0.0007  lr_temp_net: 0.00000141  loss_temp: -0.0165  avg_image_tau: 0.0010  avg_text_tau: 0.0012  time: 1.1155  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1000/2244]  eta: 0:23:12  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0169  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.1173  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1050/2244]  eta: 0:22:16  lr: 0.000038  loss_ita: -0.0006  lr_temp_net: 0.00000141  loss_temp: -0.0177  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.1058  data: 0.0016  max mem: 22279
Train Epoch: [29]  [1100/2244]  eta: 0:21:24  lr: 0.000038  loss_ita: -0.0010  lr_temp_net: 0.00000141  loss_temp: -0.0175  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.1342  data: 0.1150  max mem: 22279
Train Epoch: [29]  [1150/2244]  eta: 0:20:28  lr: 0.000038  loss_ita: -0.0011  lr_temp_net: 0.00000141  loss_temp: -0.0171  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.1008  data: 0.0016  max mem: 22279
Train Epoch: [29]  [1200/2244]  eta: 0:19:32  lr: 0.000038  loss_ita: -0.0012  lr_temp_net: 0.00000141  loss_temp: -0.0166  avg_image_tau: 0.0010  avg_text_tau: 0.0013  time: 1.0992  data: 0.0017  max mem: 22279
Train Epoch: [29]  [1250/2244]  eta: 0:18:36  lr: 0.000038  loss_ita: -0.0014  lr_temp_net: 0.00000141  loss_temp: -0.0173  avg_image_tau: 0.0011  avg_text_tau: 0.0013  time: 1.1140  data: 0.0016  max mem: 22279
Train Epoch: [29]  [1300/2244]  eta: 0:17:39  lr: 0.000038  loss_ita: -0.0012  lr_temp_net: 0.00000141  loss_temp: -0.0184  avg_image_tau: 0.0011  avg_text_tau: 0.0013  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1350/2244]  eta: 0:16:43  lr: 0.000038  loss_ita: -0.0012  lr_temp_net: 0.00000141  loss_temp: -0.0176  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1171  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1400/2244]  eta: 0:15:47  lr: 0.000038  loss_ita: -0.0008  lr_temp_net: 0.00000141  loss_temp: -0.0184  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1178  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1450/2244]  eta: 0:14:50  lr: 0.000038  loss_ita: -0.0012  lr_temp_net: 0.00000141  loss_temp: -0.0186  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1500/2244]  eta: 0:13:54  lr: 0.000038  loss_ita: -0.0013  lr_temp_net: 0.00000141  loss_temp: -0.0189  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1198  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1550/2244]  eta: 0:12:58  lr: 0.000038  loss_ita: -0.0015  lr_temp_net: 0.00000141  loss_temp: -0.0186  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1171  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1600/2244]  eta: 0:12:01  lr: 0.000038  loss_ita: -0.0008  lr_temp_net: 0.00000141  loss_temp: -0.0194  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1120  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1650/2244]  eta: 0:11:05  lr: 0.000038  loss_ita: -0.0013  lr_temp_net: 0.00000141  loss_temp: -0.0190  avg_image_tau: 0.0011  avg_text_tau: 0.0014  time: 1.1110  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1700/2244]  eta: 0:10:09  lr: 0.000038  loss_ita: -0.0015  lr_temp_net: 0.00000141  loss_temp: -0.0189  avg_image_tau: 0.0011  avg_text_tau: 0.0015  time: 1.1149  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1750/2244]  eta: 0:09:13  lr: 0.000038  loss_ita: -0.0014  lr_temp_net: 0.00000141  loss_temp: -0.0190  avg_image_tau: 0.0011  avg_text_tau: 0.0015  time: 1.1188  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1800/2244]  eta: 0:08:17  lr: 0.000038  loss_ita: -0.0020  lr_temp_net: 0.00000141  loss_temp: -0.0206  avg_image_tau: 0.0011  avg_text_tau: 0.0016  time: 1.1072  data: 0.0017  max mem: 22279
Train Epoch: [29]  [1850/2244]  eta: 0:07:21  lr: 0.000038  loss_ita: -0.0017  lr_temp_net: 0.00000141  loss_temp: -0.0198  avg_image_tau: 0.0011  avg_text_tau: 0.0015  time: 1.1161  data: 0.0015  max mem: 22279
Train Epoch: [29]  [1900/2244]  eta: 0:06:25  lr: 0.000038  loss_ita: -0.0020  lr_temp_net: 0.00000141  loss_temp: -0.0205  avg_image_tau: 0.0011  avg_text_tau: 0.0016  time: 1.1195  data: 0.0016  max mem: 22279
Train Epoch: [29]  [1950/2244]  eta: 0:05:29  lr: 0.000038  loss_ita: -0.0021  lr_temp_net: 0.00000141  loss_temp: -0.0205  avg_image_tau: 0.0011  avg_text_tau: 0.0016  time: 1.1161  data: 0.0015  max mem: 22279
Train Epoch: [29]  [2000/2244]  eta: 0:04:33  lr: 0.000038  loss_ita: -0.0020  lr_temp_net: 0.00000141  loss_temp: -0.0218  avg_image_tau: 0.0011  avg_text_tau: 0.0016  time: 1.1067  data: 0.0016  max mem: 22279
Train Epoch: [29]  [2050/2244]  eta: 0:03:37  lr: 0.000038  loss_ita: -0.0020  lr_temp_net: 0.00000141  loss_temp: -0.0223  avg_image_tau: 0.0011  avg_text_tau: 0.0016  time: 1.1164  data: 0.0016  max mem: 22279
Train Epoch: [29]  [2100/2244]  eta: 0:02:41  lr: 0.000038  loss_ita: -0.0022  lr_temp_net: 0.00000141  loss_temp: -0.0213  avg_image_tau: 0.0012  avg_text_tau: 0.0016  time: 1.1192  data: 0.0015  max mem: 22279
Train Epoch: [29]  [2150/2244]  eta: 0:01:45  lr: 0.000038  loss_ita: -0.0021  lr_temp_net: 0.00000141  loss_temp: -0.0220  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 1.1114  data: 0.0015  max mem: 22279
Train Epoch: [29]  [2200/2244]  eta: 0:00:49  lr: 0.000038  loss_ita: -0.0022  lr_temp_net: 0.00000141  loss_temp: -0.0208  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 1.1104  data: 0.0017  max mem: 22279
Train Epoch: [29]  [2243/2244]  eta: 0:00:01  lr: 0.000038  loss_ita: -0.0040  lr_temp_net: 0.00000141  loss_temp: -0.0240  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 1.1267  data: 0.0015  max mem: 22279
Train Epoch: [29] Total time: 0:41:51 (1.1192 s / it)
Averaged stats: lr: 0.0000  loss_ita: -0.0010  lr_temp_net: 0.0000  loss_temp: -0.0176  avg_image_tau: 0.0011  avg_text_tau: 0.0013
Computing features for evaluation...
Evaluation time 0:00:33
Computing features for evaluation...
Evaluation time 0:00:32
Computing features for evaluation...
Evaluation time 0:00:09
Computing features for evaluation...
Evaluation time 0:00:08
coco val: {'txt_r1': 29.06, 'txt_r5': 52.62, 'txt_r10': 63.7, 'txt_r_mean': 48.46, 'img_r1': 18.676529388244703, 'img_r5': 40.05997600959616, 'img_r10': 51.49940023990404, 'img_r_mean': 36.7453018792483, 'r_mean': 42.602650939624155}
coco test: {'txt_r1': 26.56, 'txt_r5': 51.3, 'txt_r10': 61.86, 'txt_r_mean': 46.57333333333333, 'img_r1': 18.220711715313875, 'img_r5': 39.63214714114354, 'img_r10': 50.78368652538985, 'img_r_mean': 36.21218179394909, 'r_mean': 41.39275756364121}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Train Epoch: [30]  [   0/2244]  eta: 4:09:21  lr: 0.000026  loss_ita: -0.0034  lr_temp_net: 0.00000127  loss_temp: -0.0214  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 6.6674  data: 4.0351  max mem: 22279
Train Epoch: [30]  [  50/2244]  eta: 0:44:06  lr: 0.000026  loss_ita: -0.0025  lr_temp_net: 0.00000127  loss_temp: -0.0216  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 1.1012  data: 0.0018  max mem: 22279
Train Epoch: [30]  [ 100/2244]  eta: 0:41:18  lr: 0.000026  loss_ita: -0.0023  lr_temp_net: 0.00000127  loss_temp: -0.0219  avg_image_tau: 0.0012  avg_text_tau: 0.0017  time: 1.1097  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 150/2244]  eta: 0:39:43  lr: 0.000026  loss_ita: -0.0028  lr_temp_net: 0.00000127  loss_temp: -0.0209  avg_image_tau: 0.0012  avg_text_tau: 0.0018  time: 1.0984  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 200/2244]  eta: 0:38:28  lr: 0.000026  loss_ita: -0.0034  lr_temp_net: 0.00000127  loss_temp: -0.0210  avg_image_tau: 0.0012  avg_text_tau: 0.0018  time: 1.1039  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 250/2244]  eta: 0:37:22  lr: 0.000026  loss_ita: -0.0022  lr_temp_net: 0.00000127  loss_temp: -0.0218  avg_image_tau: 0.0012  avg_text_tau: 0.0018  time: 1.1044  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 300/2244]  eta: 0:36:19  lr: 0.000026  loss_ita: -0.0024  lr_temp_net: 0.00000127  loss_temp: -0.0226  avg_image_tau: 0.0012  avg_text_tau: 0.0018  time: 1.1013  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 350/2244]  eta: 0:35:19  lr: 0.000026  loss_ita: -0.0032  lr_temp_net: 0.00000127  loss_temp: -0.0226  avg_image_tau: 0.0012  avg_text_tau: 0.0018  time: 1.1032  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 400/2244]  eta: 0:34:20  lr: 0.000026  loss_ita: -0.0025  lr_temp_net: 0.00000127  loss_temp: -0.0239  avg_image_tau: 0.0013  avg_text_tau: 0.0019  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 450/2244]  eta: 0:33:22  lr: 0.000026  loss_ita: -0.0037  lr_temp_net: 0.00000127  loss_temp: -0.0228  avg_image_tau: 0.0013  avg_text_tau: 0.0019  time: 1.1063  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 500/2244]  eta: 0:32:25  lr: 0.000026  loss_ita: -0.0042  lr_temp_net: 0.00000127  loss_temp: -0.0240  avg_image_tau: 0.0013  avg_text_tau: 0.0019  time: 1.1082  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 550/2244]  eta: 0:31:28  lr: 0.000026  loss_ita: -0.0040  lr_temp_net: 0.00000127  loss_temp: -0.0237  avg_image_tau: 0.0013  avg_text_tau: 0.0019  time: 1.1028  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 600/2244]  eta: 0:30:31  lr: 0.000026  loss_ita: -0.0033  lr_temp_net: 0.00000127  loss_temp: -0.0248  avg_image_tau: 0.0013  avg_text_tau: 0.0020  time: 1.1038  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 650/2244]  eta: 0:29:35  lr: 0.000026  loss_ita: -0.0032  lr_temp_net: 0.00000127  loss_temp: -0.0243  avg_image_tau: 0.0013  avg_text_tau: 0.0020  time: 1.1099  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 700/2244]  eta: 0:28:38  lr: 0.000026  loss_ita: -0.0038  lr_temp_net: 0.00000127  loss_temp: -0.0254  avg_image_tau: 0.0014  avg_text_tau: 0.0020  time: 1.1065  data: 0.0016  max mem: 22279
Train Epoch: [30]  [ 750/2244]  eta: 0:27:42  lr: 0.000026  loss_ita: -0.0036  lr_temp_net: 0.00000127  loss_temp: -0.0254  avg_image_tau: 0.0014  avg_text_tau: 0.0020  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 800/2244]  eta: 0:27:08  lr: 0.000026  loss_ita: -0.0042  lr_temp_net: 0.00000127  loss_temp: -0.0253  avg_image_tau: 0.0014  avg_text_tau: 0.0021  time: 1.7203  data: 0.1236  max mem: 22279
Train Epoch: [30]  [ 850/2244]  eta: 0:26:11  lr: 0.000026  loss_ita: -0.0032  lr_temp_net: 0.00000127  loss_temp: -0.0253  avg_image_tau: 0.0014  avg_text_tau: 0.0020  time: 1.1170  data: 0.0017  max mem: 22279
Train Epoch: [30]  [ 900/2244]  eta: 0:25:13  lr: 0.000026  loss_ita: -0.0057  lr_temp_net: 0.00000127  loss_temp: -0.0261  avg_image_tau: 0.0014  avg_text_tau: 0.0022  time: 1.1067  data: 0.0015  max mem: 22279
Train Epoch: [30]  [ 950/2244]  eta: 0:24:15  lr: 0.000026  loss_ita: -0.0046  lr_temp_net: 0.00000127  loss_temp: -0.0259  avg_image_tau: 0.0014  avg_text_tau: 0.0022  time: 1.1064  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1000/2244]  eta: 0:23:18  lr: 0.000026  loss_ita: -0.0048  lr_temp_net: 0.00000127  loss_temp: -0.0260  avg_image_tau: 0.0014  avg_text_tau: 0.0022  time: 1.1168  data: 0.0016  max mem: 22279
Train Epoch: [30]  [1050/2244]  eta: 0:22:23  lr: 0.000026  loss_ita: -0.0056  lr_temp_net: 0.00000127  loss_temp: -0.0276  avg_image_tau: 0.0015  avg_text_tau: 0.0022  time: 1.2008  data: 0.0016  max mem: 22279
Train Epoch: [30]  [1100/2244]  eta: 0:21:28  lr: 0.000026  loss_ita: -0.0048  lr_temp_net: 0.00000127  loss_temp: -0.0270  avg_image_tau: 0.0015  avg_text_tau: 0.0022  time: 1.1035  data: 0.0018  max mem: 22279
Train Epoch: [30]  [1150/2244]  eta: 0:20:31  lr: 0.000026  loss_ita: -0.0053  lr_temp_net: 0.00000127  loss_temp: -0.0279  avg_image_tau: 0.0015  avg_text_tau: 0.0023  time: 1.1134  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1200/2244]  eta: 0:19:34  lr: 0.000026  loss_ita: -0.0069  lr_temp_net: 0.00000127  loss_temp: -0.0278  avg_image_tau: 0.0015  avg_text_tau: 0.0023  time: 1.1221  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1250/2244]  eta: 0:18:37  lr: 0.000026  loss_ita: -0.0066  lr_temp_net: 0.00000127  loss_temp: -0.0283  avg_image_tau: 0.0016  avg_text_tau: 0.0023  time: 1.1044  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1300/2244]  eta: 0:17:40  lr: 0.000026  loss_ita: -0.0055  lr_temp_net: 0.00000127  loss_temp: -0.0288  avg_image_tau: 0.0016  avg_text_tau: 0.0024  time: 1.1188  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1350/2244]  eta: 0:16:44  lr: 0.000026  loss_ita: -0.0064  lr_temp_net: 0.00000127  loss_temp: -0.0291  avg_image_tau: 0.0016  avg_text_tau: 0.0024  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1400/2244]  eta: 0:15:47  lr: 0.000026  loss_ita: -0.0070  lr_temp_net: 0.00000127  loss_temp: -0.0284  avg_image_tau: 0.0016  avg_text_tau: 0.0024  time: 1.0991  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1450/2244]  eta: 0:14:50  lr: 0.000026  loss_ita: -0.0068  lr_temp_net: 0.00000127  loss_temp: -0.0304  avg_image_tau: 0.0016  avg_text_tau: 0.0025  time: 1.1051  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1500/2244]  eta: 0:13:54  lr: 0.000026  loss_ita: -0.0067  lr_temp_net: 0.00000127  loss_temp: -0.0300  avg_image_tau: 0.0017  avg_text_tau: 0.0025  time: 1.1044  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1550/2244]  eta: 0:12:58  lr: 0.000026  loss_ita: -0.0068  lr_temp_net: 0.00000127  loss_temp: -0.0300  avg_image_tau: 0.0017  avg_text_tau: 0.0025  time: 1.1145  data: 0.2408  max mem: 22279
Train Epoch: [30]  [1600/2244]  eta: 0:12:02  lr: 0.000026  loss_ita: -0.0072  lr_temp_net: 0.00000127  loss_temp: -0.0298  avg_image_tau: 0.0017  avg_text_tau: 0.0025  time: 1.1258  data: 0.0016  max mem: 22279
Train Epoch: [30]  [1650/2244]  eta: 0:11:06  lr: 0.000026  loss_ita: -0.0068  lr_temp_net: 0.00000127  loss_temp: -0.0322  avg_image_tau: 0.0017  avg_text_tau: 0.0026  time: 1.1103  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1700/2244]  eta: 0:10:09  lr: 0.000026  loss_ita: -0.0070  lr_temp_net: 0.00000127  loss_temp: -0.0297  avg_image_tau: 0.0017  avg_text_tau: 0.0026  time: 1.1180  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1750/2244]  eta: 0:09:13  lr: 0.000026  loss_ita: -0.0074  lr_temp_net: 0.00000127  loss_temp: -0.0326  avg_image_tau: 0.0018  avg_text_tau: 0.0026  time: 1.1137  data: 0.0016  max mem: 22279
Train Epoch: [30]  [1800/2244]  eta: 0:08:17  lr: 0.000026  loss_ita: -0.0080  lr_temp_net: 0.00000127  loss_temp: -0.0318  avg_image_tau: 0.0018  avg_text_tau: 0.0027  time: 1.1093  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1850/2244]  eta: 0:07:21  lr: 0.000026  loss_ita: -0.0076  lr_temp_net: 0.00000127  loss_temp: -0.0331  avg_image_tau: 0.0018  avg_text_tau: 0.0027  time: 1.1240  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1900/2244]  eta: 0:06:25  lr: 0.000026  loss_ita: -0.0071  lr_temp_net: 0.00000127  loss_temp: -0.0311  avg_image_tau: 0.0018  avg_text_tau: 0.0027  time: 1.1087  data: 0.0015  max mem: 22279
Train Epoch: [30]  [1950/2244]  eta: 0:05:29  lr: 0.000026  loss_ita: -0.0084  lr_temp_net: 0.00000127  loss_temp: -0.0332  avg_image_tau: 0.0018  avg_text_tau: 0.0027  time: 1.1162  data: 0.0015  max mem: 22279
Train Epoch: [30]  [2000/2244]  eta: 0:04:33  lr: 0.000026  loss_ita: -0.0088  lr_temp_net: 0.00000127  loss_temp: -0.0327  avg_image_tau: 0.0019  avg_text_tau: 0.0028  time: 1.1094  data: 0.0015  max mem: 22279
Train Epoch: [30]  [2050/2244]  eta: 0:03:37  lr: 0.000026  loss_ita: -0.0084  lr_temp_net: 0.00000127  loss_temp: -0.0334  avg_image_tau: 0.0019  avg_text_tau: 0.0028  time: 1.1163  data: 0.0016  max mem: 22279
Train Epoch: [30]  [2100/2244]  eta: 0:02:41  lr: 0.000026  loss_ita: -0.0097  lr_temp_net: 0.00000127  loss_temp: -0.0351  avg_image_tau: 0.0019  avg_text_tau: 0.0029  time: 1.1191  data: 0.0014  max mem: 22279
Train Epoch: [30]  [2150/2244]  eta: 0:01:45  lr: 0.000026  loss_ita: -0.0099  lr_temp_net: 0.00000127  loss_temp: -0.0340  avg_image_tau: 0.0020  avg_text_tau: 0.0029  time: 1.1106  data: 0.0015  max mem: 22279
Train Epoch: [30]  [2200/2244]  eta: 0:00:49  lr: 0.000026  loss_ita: -0.0073  lr_temp_net: 0.00000127  loss_temp: -0.0327  avg_image_tau: 0.0019  avg_text_tau: 0.0028  time: 1.1088  data: 0.0015  max mem: 22279
Train Epoch: [30]  [2243/2244]  eta: 0:00:01  lr: 0.000026  loss_ita: -0.0121  lr_temp_net: 0.00000127  loss_temp: -0.0380  avg_image_tau: 0.0020  avg_text_tau: 0.0030  time: 1.2368  data: 0.0051  max mem: 22279
Train Epoch: [30] Total time: 0:41:53 (1.1201 s / it)
Averaged stats: lr: 0.0000  loss_ita: -0.0055  lr_temp_net: 0.0000  loss_temp: -0.0276  avg_image_tau: 0.0015  avg_text_tau: 0.0023
Computing features for evaluation...
Evaluation time 0:00:35
Computing features for evaluation...
Evaluation time 0:00:31
Computing features for evaluation...
Evaluation time 0:00:10
Computing features for evaluation...
Evaluation time 0:00:09
coco val: {'txt_r1': 29.66, 'txt_r5': 53.62, 'txt_r10': 64.34, 'txt_r_mean': 49.20666666666667, 'img_r1': 18.572570971611356, 'img_r5': 39.94802079168333, 'img_r10': 51.41543382646941, 'img_r_mean': 36.64534186325469, 'r_mean': 42.92600426496068}
coco test: {'txt_r1': 27.04, 'txt_r5': 51.84, 'txt_r10': 63.04, 'txt_r_mean': 47.306666666666665, 'img_r1': 18.084766093562575, 'img_r5': 39.53218712514994, 'img_r10': 50.94362255097961, 'img_r_mean': 36.186858589897376, 'r_mean': 41.74676262828202}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [31]  [   0/2244]  eta: 2:26:18  lr: 0.000017  loss_ita: -0.0091  lr_temp_net: 0.00000114  loss_temp: -0.0345  avg_image_tau: 0.0019  avg_text_tau: 0.0029  time: 3.9119  data: 2.8720  max mem: 22279
Train Epoch: [31]  [  50/2244]  eta: 0:41:48  lr: 0.000017  loss_ita: -0.0085  lr_temp_net: 0.00000114  loss_temp: -0.0316  avg_image_tau: 0.0020  avg_text_tau: 0.0029  time: 1.0660  data: 0.2062  max mem: 22279
Train Epoch: [31]  [ 100/2244]  eta: 0:39:51  lr: 0.000017  loss_ita: -0.0102  lr_temp_net: 0.00000114  loss_temp: -0.0319  avg_image_tau: 0.0020  avg_text_tau: 0.0030  time: 1.1098  data: 0.0017  max mem: 22279
Train Epoch: [31]  [ 150/2244]  eta: 0:38:45  lr: 0.000017  loss_ita: -0.0098  lr_temp_net: 0.00000114  loss_temp: -0.0318  avg_image_tau: 0.0020  avg_text_tau: 0.0030  time: 1.0981  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 200/2244]  eta: 0:37:50  lr: 0.000017  loss_ita: -0.0094  lr_temp_net: 0.00000114  loss_temp: -0.0333  avg_image_tau: 0.0020  avg_text_tau: 0.0030  time: 1.1142  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 250/2244]  eta: 0:36:51  lr: 0.000017  loss_ita: -0.0093  lr_temp_net: 0.00000114  loss_temp: -0.0317  avg_image_tau: 0.0020  avg_text_tau: 0.0030  time: 1.1008  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 300/2244]  eta: 0:35:54  lr: 0.000017  loss_ita: -0.0092  lr_temp_net: 0.00000114  loss_temp: -0.0328  avg_image_tau: 0.0021  avg_text_tau: 0.0030  time: 1.1066  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 350/2244]  eta: 0:34:57  lr: 0.000017  loss_ita: -0.0102  lr_temp_net: 0.00000114  loss_temp: -0.0339  avg_image_tau: 0.0021  avg_text_tau: 0.0031  time: 1.1034  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 400/2244]  eta: 0:34:01  lr: 0.000017  loss_ita: -0.0113  lr_temp_net: 0.00000114  loss_temp: -0.0339  avg_image_tau: 0.0021  avg_text_tau: 0.0032  time: 1.1077  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 450/2244]  eta: 0:33:06  lr: 0.000017  loss_ita: -0.0120  lr_temp_net: 0.00000114  loss_temp: -0.0358  avg_image_tau: 0.0021  avg_text_tau: 0.0032  time: 1.1071  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 500/2244]  eta: 0:32:09  lr: 0.000017  loss_ita: -0.0113  lr_temp_net: 0.00000114  loss_temp: -0.0351  avg_image_tau: 0.0022  avg_text_tau: 0.0032  time: 1.1033  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 550/2244]  eta: 0:31:14  lr: 0.000017  loss_ita: -0.0114  lr_temp_net: 0.00000114  loss_temp: -0.0317  avg_image_tau: 0.0022  avg_text_tau: 0.0032  time: 1.0998  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 600/2244]  eta: 0:30:19  lr: 0.000017  loss_ita: -0.0107  lr_temp_net: 0.00000114  loss_temp: -0.0328  avg_image_tau: 0.0022  avg_text_tau: 0.0032  time: 1.1182  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 650/2244]  eta: 0:29:30  lr: 0.000017  loss_ita: -0.0128  lr_temp_net: 0.00000114  loss_temp: -0.0372  avg_image_tau: 0.0022  avg_text_tau: 0.0033  time: 1.2343  data: 0.0016  max mem: 22279
Train Epoch: [31]  [ 700/2244]  eta: 0:28:31  lr: 0.000017  loss_ita: -0.0120  lr_temp_net: 0.00000114  loss_temp: -0.0364  avg_image_tau: 0.0023  avg_text_tau: 0.0033  time: 1.0943  data: 0.0017  max mem: 22279
Train Epoch: [31]  [ 750/2244]  eta: 0:27:37  lr: 0.000017  loss_ita: -0.0129  lr_temp_net: 0.00000114  loss_temp: -0.0360  avg_image_tau: 0.0023  avg_text_tau: 0.0033  time: 1.0989  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 800/2244]  eta: 0:26:43  lr: 0.000017  loss_ita: -0.0124  lr_temp_net: 0.00000114  loss_temp: -0.0366  avg_image_tau: 0.0023  avg_text_tau: 0.0033  time: 1.1102  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 850/2244]  eta: 0:25:50  lr: 0.000017  loss_ita: -0.0137  lr_temp_net: 0.00000114  loss_temp: -0.0350  avg_image_tau: 0.0023  avg_text_tau: 0.0034  time: 1.1740  data: 0.2031  max mem: 22279
Train Epoch: [31]  [ 900/2244]  eta: 0:24:55  lr: 0.000017  loss_ita: -0.0135  lr_temp_net: 0.00000114  loss_temp: -0.0381  avg_image_tau: 0.0024  avg_text_tau: 0.0035  time: 1.0652  data: 0.0015  max mem: 22279
Train Epoch: [31]  [ 950/2244]  eta: 0:25:52  lr: 0.000017  loss_ita: -0.0132  lr_temp_net: 0.00000114  loss_temp: -0.0364  avg_image_tau: 0.0024  avg_text_tau: 0.0035  time: 1.2006  data: 0.0287  max mem: 22279
Train Epoch: [31]  [1000/2244]  eta: 0:24:56  lr: 0.000017  loss_ita: -0.0130  lr_temp_net: 0.00000114  loss_temp: -0.0360  avg_image_tau: 0.0024  avg_text_tau: 0.0035  time: 1.4091  data: 0.2541  max mem: 22279
Train Epoch: [31]  [1050/2244]  eta: 0:28:12  lr: 0.000017  loss_ita: -0.0145  lr_temp_net: 0.00000114  loss_temp: -0.0382  avg_image_tau: 0.0024  avg_text_tau: 0.0036  time: 1.0729  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1100/2244]  eta: 0:26:44  lr: 0.000017  loss_ita: -0.0131  lr_temp_net: 0.00000114  loss_temp: -0.0368  avg_image_tau: 0.0025  avg_text_tau: 0.0035  time: 1.0616  data: 0.0289  max mem: 22279
Train Epoch: [31]  [1150/2244]  eta: 0:25:28  lr: 0.000017  loss_ita: -0.0156  lr_temp_net: 0.00000114  loss_temp: -0.0356  avg_image_tau: 0.0025  avg_text_tau: 0.0036  time: 1.3080  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1200/2244]  eta: 0:24:15  lr: 0.000017  loss_ita: -0.0141  lr_temp_net: 0.00000114  loss_temp: -0.0371  avg_image_tau: 0.0025  avg_text_tau: 0.0036  time: 1.1220  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1250/2244]  eta: 0:22:59  lr: 0.000017  loss_ita: -0.0150  lr_temp_net: 0.00000114  loss_temp: -0.0367  avg_image_tau: 0.0025  avg_text_tau: 0.0036  time: 1.1030  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1300/2244]  eta: 0:21:40  lr: 0.000017  loss_ita: -0.0145  lr_temp_net: 0.00000114  loss_temp: -0.0387  avg_image_tau: 0.0026  avg_text_tau: 0.0036  time: 1.1194  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1350/2244]  eta: 0:20:28  lr: 0.000017  loss_ita: -0.0158  lr_temp_net: 0.00000114  loss_temp: -0.0393  avg_image_tau: 0.0026  avg_text_tau: 0.0037  time: 1.1319  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1400/2244]  eta: 0:19:12  lr: 0.000017  loss_ita: -0.0164  lr_temp_net: 0.00000114  loss_temp: -0.0384  avg_image_tau: 0.0026  avg_text_tau: 0.0037  time: 1.0819  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1450/2244]  eta: 0:17:57  lr: 0.000017  loss_ita: -0.0152  lr_temp_net: 0.00000114  loss_temp: -0.0374  avg_image_tau: 0.0026  avg_text_tau: 0.0038  time: 1.1016  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1500/2244]  eta: 0:16:44  lr: 0.000017  loss_ita: -0.0169  lr_temp_net: 0.00000114  loss_temp: -0.0379  avg_image_tau: 0.0026  avg_text_tau: 0.0038  time: 1.1302  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1550/2244]  eta: 0:15:31  lr: 0.000017  loss_ita: -0.0168  lr_temp_net: 0.00000114  loss_temp: -0.0395  avg_image_tau: 0.0026  avg_text_tau: 0.0039  time: 1.1102  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1600/2244]  eta: 0:14:19  lr: 0.000017  loss_ita: -0.0174  lr_temp_net: 0.00000114  loss_temp: -0.0390  avg_image_tau: 0.0026  avg_text_tau: 0.0038  time: 1.1004  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1650/2244]  eta: 0:13:09  lr: 0.000017  loss_ita: -0.0157  lr_temp_net: 0.00000114  loss_temp: -0.0404  avg_image_tau: 0.0027  avg_text_tau: 0.0039  time: 1.1063  data: 0.0017  max mem: 22279
Train Epoch: [31]  [1700/2244]  eta: 0:12:00  lr: 0.000017  loss_ita: -0.0165  lr_temp_net: 0.00000114  loss_temp: -0.0377  avg_image_tau: 0.0027  avg_text_tau: 0.0038  time: 1.1891  data: 0.0916  max mem: 22279
Train Epoch: [31]  [1750/2244]  eta: 0:10:50  lr: 0.000017  loss_ita: -0.0169  lr_temp_net: 0.00000114  loss_temp: -0.0407  avg_image_tau: 0.0028  avg_text_tau: 0.0040  time: 1.1328  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1800/2244]  eta: 0:09:42  lr: 0.000017  loss_ita: -0.0168  lr_temp_net: 0.00000114  loss_temp: -0.0406  avg_image_tau: 0.0027  avg_text_tau: 0.0040  time: 1.1004  data: 0.0016  max mem: 22279
Train Epoch: [31]  [1850/2244]  eta: 0:08:34  lr: 0.000017  loss_ita: -0.0172  lr_temp_net: 0.00000114  loss_temp: -0.0399  avg_image_tau: 0.0028  avg_text_tau: 0.0040  time: 1.1055  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1900/2244]  eta: 0:07:28  lr: 0.000017  loss_ita: -0.0178  lr_temp_net: 0.00000114  loss_temp: -0.0387  avg_image_tau: 0.0028  avg_text_tau: 0.0040  time: 1.2885  data: 0.0015  max mem: 22279
Train Epoch: [31]  [1950/2244]  eta: 0:06:22  lr: 0.000017  loss_ita: -0.0187  lr_temp_net: 0.00000114  loss_temp: -0.0412  avg_image_tau: 0.0029  avg_text_tau: 0.0041  time: 1.0840  data: 0.2649  max mem: 22279
Train Epoch: [31]  [2000/2244]  eta: 0:05:16  lr: 0.000017  loss_ita: -0.0194  lr_temp_net: 0.00000114  loss_temp: -0.0395  avg_image_tau: 0.0028  avg_text_tau: 0.0041  time: 1.1285  data: 0.0015  max mem: 22279
Train Epoch: [31]  [2050/2244]  eta: 0:04:11  lr: 0.000017  loss_ita: -0.0176  lr_temp_net: 0.00000114  loss_temp: -0.0407  avg_image_tau: 0.0029  avg_text_tau: 0.0041  time: 1.2259  data: 0.0193  max mem: 22279
Train Epoch: [31]  [2100/2244]  eta: 0:03:05  lr: 0.000017  loss_ita: -0.0187  lr_temp_net: 0.00000114  loss_temp: -0.0387  avg_image_tau: 0.0029  avg_text_tau: 0.0041  time: 1.1547  data: 0.0016  max mem: 22279
Train Epoch: [31]  [2150/2244]  eta: 0:02:01  lr: 0.000017  loss_ita: -0.0185  lr_temp_net: 0.00000114  loss_temp: -0.0386  avg_image_tau: 0.0029  avg_text_tau: 0.0041  time: 1.3789  data: 0.0660  max mem: 22279
Train Epoch: [31]  [2200/2244]  eta: 0:00:56  lr: 0.000017  loss_ita: -0.0177  lr_temp_net: 0.00000114  loss_temp: -0.0385  avg_image_tau: 0.0030  avg_text_tau: 0.0042  time: 1.1408  data: 0.0016  max mem: 22279
Train Epoch: [31]  [2243/2244]  eta: 0:00:01  lr: 0.000017  loss_ita: -0.0232  lr_temp_net: 0.00000114  loss_temp: -0.0450  avg_image_tau: 0.0030  avg_text_tau: 0.0042  time: 1.1523  data: 0.0015  max mem: 22279
Train Epoch: [31] Total time: 0:47:59 (1.2830 s / it)
Averaged stats: lr: 0.0000  loss_ita: -0.0144  lr_temp_net: 0.0000  loss_temp: -0.0370  avg_image_tau: 0.0025  avg_text_tau: 0.0035
Computing features for evaluation...
Evaluation time 0:00:59
Computing features for evaluation...
Evaluation time 0:00:57
Computing features for evaluation...
Evaluation time 0:00:25
Computing features for evaluation...
Evaluation time 0:00:11
coco val: {'txt_r1': 29.1, 'txt_r5': 54.14, 'txt_r10': 65.2, 'txt_r_mean': 49.48, 'img_r1': 18.620551779288284, 'img_r5': 40.175929628148744, 'img_r10': 51.55537784886046, 'img_r_mean': 36.78395308543249, 'r_mean': 43.131976542716245}
coco test: {'txt_r1': 27.54, 'txt_r5': 52.28, 'txt_r10': 63.92, 'txt_r_mean': 47.913333333333334, 'img_r1': 18.296681327469013, 'img_r5': 39.79608156737305, 'img_r10': 51.115553778488604, 'img_r_mean': 36.40277222444356, 'r_mean': 42.15805277888845}
Argument set for DDP as True
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 1, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Rank: 0, world size: 8, worker: 0, num_workers: 2
Train Epoch: [32]  [   0/2244]  eta: 2:20:13  lr: 0.000012  loss_ita: -0.0232  lr_temp_net: 0.00000103  loss_temp: -0.0389  avg_image_tau: 0.0030  avg_text_tau: 0.0042  time: 3.7495  data: 3.0073  max mem: 22279
Train Epoch: [32]  [  50/2244]  eta: 0:43:06  lr: 0.000012  loss_ita: -0.0209  lr_temp_net: 0.00000103  loss_temp: -0.0376  avg_image_tau: 0.0030  avg_text_tau: 0.0042  time: 1.1220  data: 0.0247  max mem: 22279
Train Epoch: [32]  [ 100/2244]  eta: 0:41:33  lr: 0.000012  loss_ita: -0.0196  lr_temp_net: 0.00000103  loss_temp: -0.0372  avg_image_tau: 0.0030  avg_text_tau: 0.0041  time: 1.1231  data: 0.5863  max mem: 22279
Train Epoch: [32]  [ 150/2244]  eta: 0:39:40  lr: 0.000012  loss_ita: -0.0195  lr_temp_net: 0.00000103  loss_temp: -0.0380  avg_image_tau: 0.0030  avg_text_tau: 0.0041  time: 1.0708  data: 0.5377  max mem: 22279
Train Epoch: [32]  [ 200/2244]  eta: 0:39:18  lr: 0.000012  loss_ita: -0.0195  lr_temp_net: 0.00000103  loss_temp: -0.0375  avg_image_tau: 0.0030  avg_text_tau: 0.0042  time: 1.2522  data: 0.0016  max mem: 22279
Train Epoch: [32]  [ 250/2244]  eta: 0:39:56  lr: 0.000012  loss_ita: -0.0198  lr_temp_net: 0.00000103  loss_temp: -0.0380  avg_image_tau: 0.0031  avg_text_tau: 0.0043  time: 1.5043  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 300/2244]  eta: 0:40:55  lr: 0.000012  loss_ita: -0.0214  lr_temp_net: 0.00000103  loss_temp: -0.0370  avg_image_tau: 0.0031  avg_text_tau: 0.0043  time: 1.2747  data: 0.2050  max mem: 22279
Train Epoch: [32]  [ 350/2244]  eta: 0:39:28  lr: 0.000012  loss_ita: -0.0212  lr_temp_net: 0.00000103  loss_temp: -0.0352  avg_image_tau: 0.0031  avg_text_tau: 0.0044  time: 1.0694  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 400/2244]  eta: 0:38:38  lr: 0.000012  loss_ita: -0.0211  lr_temp_net: 0.00000103  loss_temp: -0.0397  avg_image_tau: 0.0031  avg_text_tau: 0.0044  time: 1.1137  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 450/2244]  eta: 0:37:12  lr: 0.000012  loss_ita: -0.0227  lr_temp_net: 0.00000103  loss_temp: -0.0375  avg_image_tau: 0.0032  avg_text_tau: 0.0044  time: 1.1371  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 500/2244]  eta: 0:36:52  lr: 0.000012  loss_ita: -0.0202  lr_temp_net: 0.00000103  loss_temp: -0.0366  avg_image_tau: 0.0032  avg_text_tau: 0.0043  time: 1.3767  data: 0.0334  max mem: 22279
Train Epoch: [32]  [ 550/2244]  eta: 0:35:26  lr: 0.000012  loss_ita: -0.0227  lr_temp_net: 0.00000103  loss_temp: -0.0393  avg_image_tau: 0.0032  avg_text_tau: 0.0045  time: 1.0645  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 600/2244]  eta: 0:46:22  lr: 0.000012  loss_ita: -0.0226  lr_temp_net: 0.00000103  loss_temp: -0.0383  avg_image_tau: 0.0032  avg_text_tau: 0.0045  time: 14.6626  data: 0.0617  max mem: 22279
Train Epoch: [32]  [ 650/2244]  eta: 0:43:52  lr: 0.000012  loss_ita: -0.0232  lr_temp_net: 0.00000103  loss_temp: -0.0400  avg_image_tau: 0.0033  avg_text_tau: 0.0045  time: 1.1129  data: 0.0018  max mem: 22279
Train Epoch: [32]  [ 700/2244]  eta: 0:42:05  lr: 0.000012  loss_ita: -0.0213  lr_temp_net: 0.00000103  loss_temp: -0.0373  avg_image_tau: 0.0032  avg_text_tau: 0.0045  time: 1.1325  data: 0.0017  max mem: 22279
Train Epoch: [32]  [ 750/2244]  eta: 0:39:52  lr: 0.000012  loss_ita: -0.0232  lr_temp_net: 0.00000103  loss_temp: -0.0409  avg_image_tau: 0.0033  avg_text_tau: 0.0046  time: 1.1499  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 800/2244]  eta: 0:37:46  lr: 0.000012  loss_ita: -0.0253  lr_temp_net: 0.00000103  loss_temp: -0.0396  avg_image_tau: 0.0034  avg_text_tau: 0.0046  time: 1.1163  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 850/2244]  eta: 0:36:02  lr: 0.000012  loss_ita: -0.0253  lr_temp_net: 0.00000103  loss_temp: -0.0396  avg_image_tau: 0.0033  avg_text_tau: 0.0046  time: 1.4465  data: 0.0017  max mem: 22279
Train Epoch: [32]  [ 900/2244]  eta: 0:34:13  lr: 0.000012  loss_ita: -0.0248  lr_temp_net: 0.00000103  loss_temp: -0.0387  avg_image_tau: 0.0034  avg_text_tau: 0.0046  time: 1.0689  data: 0.0015  max mem: 22279
Train Epoch: [32]  [ 950/2244]  eta: 0:32:33  lr: 0.000012  loss_ita: -0.0244  lr_temp_net: 0.00000103  loss_temp: -0.0391  avg_image_tau: 0.0034  avg_text_tau: 0.0046  time: 1.1453  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1000/2244]  eta: 0:30:53  lr: 0.000012  loss_ita: -0.0244  lr_temp_net: 0.00000103  loss_temp: -0.0360  avg_image_tau: 0.0035  avg_text_tau: 0.0047  time: 1.0871  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1050/2244]  eta: 0:29:14  lr: 0.000012  loss_ita: -0.0240  lr_temp_net: 0.00000103  loss_temp: -0.0397  avg_image_tau: 0.0034  avg_text_tau: 0.0047  time: 1.0572  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1100/2244]  eta: 0:27:44  lr: 0.000012  loss_ita: -0.0265  lr_temp_net: 0.00000103  loss_temp: -0.0399  avg_image_tau: 0.0035  avg_text_tau: 0.0047  time: 1.0813  data: 0.0024  max mem: 22279
Train Epoch: [32]  [1150/2244]  eta: 0:26:17  lr: 0.000012  loss_ita: -0.0245  lr_temp_net: 0.00000103  loss_temp: -0.0373  avg_image_tau: 0.0035  avg_text_tau: 0.0048  time: 1.1583  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1200/2244]  eta: 0:24:52  lr: 0.000012  loss_ita: -0.0272  lr_temp_net: 0.00000103  loss_temp: -0.0402  avg_image_tau: 0.0035  avg_text_tau: 0.0048  time: 1.1346  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1250/2244]  eta: 0:23:27  lr: 0.000012  loss_ita: -0.0278  lr_temp_net: 0.00000103  loss_temp: -0.0396  avg_image_tau: 0.0035  avg_text_tau: 0.0048  time: 1.0601  data: 0.0017  max mem: 22279
Train Epoch: [32]  [1300/2244]  eta: 0:22:05  lr: 0.000012  loss_ita: -0.0280  lr_temp_net: 0.00000103  loss_temp: -0.0438  avg_image_tau: 0.0036  avg_text_tau: 0.0049  time: 1.0657  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1350/2244]  eta: 0:20:45  lr: 0.000012  loss_ita: -0.0270  lr_temp_net: 0.00000103  loss_temp: -0.0392  avg_image_tau: 0.0036  avg_text_tau: 0.0049  time: 1.1264  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1400/2244]  eta: 0:19:26  lr: 0.000012  loss_ita: -0.0275  lr_temp_net: 0.00000103  loss_temp: -0.0407  avg_image_tau: 0.0036  avg_text_tau: 0.0049  time: 1.0942  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1450/2244]  eta: 0:18:15  lr: 0.000012  loss_ita: -0.0281  lr_temp_net: 0.00000103  loss_temp: -0.0380  avg_image_tau: 0.0036  avg_text_tau: 0.0049  time: 1.0616  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1500/2244]  eta: 0:17:18  lr: 0.000012  loss_ita: -0.0288  lr_temp_net: 0.00000103  loss_temp: -0.0419  avg_image_tau: 0.0037  avg_text_tau: 0.0049  time: 2.9269  data: 0.1090  max mem: 22279
Train Epoch: [32]  [1550/2244]  eta: 0:16:09  lr: 0.000012  loss_ita: -0.0284  lr_temp_net: 0.00000103  loss_temp: -0.0411  avg_image_tau: 0.0037  avg_text_tau: 0.0049  time: 1.7359  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1600/2244]  eta: 0:15:06  lr: 0.000012  loss_ita: -0.0291  lr_temp_net: 0.00000103  loss_temp: -0.0402  avg_image_tau: 0.0037  avg_text_tau: 0.0050  time: 1.4294  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1650/2244]  eta: 0:13:53  lr: 0.000012  loss_ita: -0.0281  lr_temp_net: 0.00000103  loss_temp: -0.0396  avg_image_tau: 0.0037  avg_text_tau: 0.0050  time: 1.1374  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1700/2244]  eta: 0:12:40  lr: 0.000012  loss_ita: -0.0305  lr_temp_net: 0.00000103  loss_temp: -0.0408  avg_image_tau: 0.0038  avg_text_tau: 0.0051  time: 1.1622  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1750/2244]  eta: 0:11:32  lr: 0.000012  loss_ita: -0.0287  lr_temp_net: 0.00000103  loss_temp: -0.0396  avg_image_tau: 0.0038  avg_text_tau: 0.0051  time: 1.1292  data: 0.0016  max mem: 22279
Train Epoch: [32]  [1800/2244]  eta: 0:10:18  lr: 0.000012  loss_ita: -0.0310  lr_temp_net: 0.00000103  loss_temp: -0.0426  avg_image_tau: 0.0038  avg_text_tau: 0.0051  time: 1.1278  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1850/2244]  eta: 0:09:05  lr: 0.000012  loss_ita: -0.0312  lr_temp_net: 0.00000103  loss_temp: -0.0422  avg_image_tau: 0.0038  avg_text_tau: 0.0052  time: 1.1132  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1900/2244]  eta: 0:07:54  lr: 0.000012  loss_ita: -0.0293  lr_temp_net: 0.00000103  loss_temp: -0.0449  avg_image_tau: 0.0038  avg_text_tau: 0.0052  time: 1.2870  data: 0.0015  max mem: 22279
Train Epoch: [32]  [1950/2244]  eta: 0:06:43  lr: 0.000012  loss_ita: -0.0312  lr_temp_net: 0.00000103  loss_temp: -0.0413  avg_image_tau: 0.0039  avg_text_tau: 0.0052  time: 1.0726  data: 0.0018  max mem: 22279
Train Epoch: [32]  [2000/2244]  eta: 0:05:33  lr: 0.000012  loss_ita: -0.0296  lr_temp_net: 0.00000103  loss_temp: -0.0397  avg_image_tau: 0.0039  avg_text_tau: 0.0052  time: 1.1089  data: 0.0015  max mem: 22279
Train Epoch: [32]  [2050/2244]  eta: 0:04:24  lr: 0.000012  loss_ita: -0.0305  lr_temp_net: 0.00000103  loss_temp: -0.0398  avg_image_tau: 0.0039  avg_text_tau: 0.0052  time: 1.0923  data: 0.0015  max mem: 22279
Train Epoch: [32]  [2100/2244]  eta: 0:03:15  lr: 0.000012  loss_ita: -0.0302  lr_temp_net: 0.00000103  loss_temp: -0.0437  avg_image_tau: 0.0039  avg_text_tau: 0.0053  time: 1.1286  data: 0.0015  max mem: 22279
Train Epoch: [32]  [2150/2244]  eta: 0:02:06  lr: 0.000012  loss_ita: -0.0320  lr_temp_net: 0.00000103  loss_temp: -0.0375  avg_image_tau: 0.0040  avg_text_tau: 0.0053  time: 1.0893  data: 0.0015  max mem: 22279
Train Epoch: [32]  [2200/2244]  eta: 0:00:59  lr: 0.000012  loss_ita: -0.0288  lr_temp_net: 0.00000103  loss_temp: -0.0407  avg_image_tau: 0.0040  avg_text_tau: 0.0053  time: 1.1060  data: 0.0015  max mem: 22279
Train Epoch: [32]  [2243/2244]  eta: 0:00:01  lr: 0.000012  loss_ita: -0.0376  lr_temp_net: 0.00000103  loss_temp: -0.0442  avg_image_tau: 0.0040  avg_text_tau: 0.0054  time: 1.1946  data: 0.0015  max mem: 22279
Train Epoch: [32] Total time: 0:50:10 (1.3414 s / it)
Averaged stats: lr: 0.0000  loss_ita: -0.0260  lr_temp_net: 0.0000  loss_temp: -0.0395  avg_image_tau: 0.0035  avg_text_tau: 0.0047
image tau mean: 0.0024599749478560226
text tau mean: 0.003347686212539673
Computing features for evaluation...
Evaluation time 0:01:41
Computing features for evaluation...
Evaluation time 0:01:05
Computing features for evaluation...
Evaluation time 0:00:41
Computing features for evaluation...
Evaluation time 0:00:30
coco val: {'txt_r1': 29.28, 'txt_r5': 55.08, 'txt_r10': 65.72, 'txt_r_mean': 50.026666666666664, 'img_r1': 18.740503798480606, 'img_r5': 40.143942423030786, 'img_r10': 51.80327868852459, 'img_r_mean': 36.89590830334533, 'r_mean': 43.461287485006}
coco test: {'txt_r1': 27.58, 'txt_r5': 53.02, 'txt_r10': 65.04, 'txt_r_mean': 48.54666666666666, 'img_r1': 18.248700519792084, 'img_r5': 39.71211515393843, 'img_r10': 51.20351859256297, 'img_r_mean': 36.38811142209783, 'r_mean': 42.467389044382244}
Training time 1 day, 0:05:33
[rank0]:[W325 17:11:18.841706245 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank2]:[W325 17:11:18.557109308 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank6]:[W325 17:11:18.354644113 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank4]:[W325 17:11:19.249804054 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
